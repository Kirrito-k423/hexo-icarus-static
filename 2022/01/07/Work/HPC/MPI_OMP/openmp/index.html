<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>OpenMP - SHAOJIE&#039;S BOOK</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="SHAOJIE&#039;S BOOK"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SHAOJIE&#039;S BOOK"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="çº¿ç¨‹ç»‘å®šOpenMP 4.0 æä¾› OMP_PLACES å’Œ OMP_PROC_BIND ç¯å¢ƒå˜é‡æ¥æŒ‡å®šç¨‹åºä¸­çš„ OpenMP çº¿ç¨‹å¦‚ä½•ç»‘å®šåˆ°å¤„ç†å™¨ã€‚è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡é€šå¸¸ç»“åˆä½¿ç”¨ã€‚OMP_PLACES ç”¨äºæŒ‡å®šçº¿ç¨‹å°†ç»‘å®šåˆ°çš„è®¡ç®—æœºä½ç½®ï¼ˆç¡¬ä»¶çº¿ç¨‹ã€æ ¸å¿ƒæˆ–æ’æ§½ï¼‰ã€‚OMP_PROC_BIND ç”¨äºæŒ‡å®šç»‘å®šç­–ç•¥ï¼ˆçº¿ç¨‹å…³è”æ€§ç­–ç•¥ï¼‰ï¼Œè¿™é¡¹ç­–ç•¥æŒ‡å®šå¦‚ä½•å°†çº¿ç¨‹åˆ†é…åˆ°ä½ç½®ã€‚ é™¤äº† OMP_PLACES å’Œ OMP_P"><meta property="og:type" content="blog"><meta property="og:title" content="OpenMP"><meta property="og:url" content="http://icarus.shaojiemike.top/2022/01/07/Work/HPC/MPI_OMP/openmp/"><meta property="og:site_name" content="SHAOJIE&#039;S BOOK"><meta property="og:description" content="çº¿ç¨‹ç»‘å®šOpenMP 4.0 æä¾› OMP_PLACES å’Œ OMP_PROC_BIND ç¯å¢ƒå˜é‡æ¥æŒ‡å®šç¨‹åºä¸­çš„ OpenMP çº¿ç¨‹å¦‚ä½•ç»‘å®šåˆ°å¤„ç†å™¨ã€‚è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡é€šå¸¸ç»“åˆä½¿ç”¨ã€‚OMP_PLACES ç”¨äºæŒ‡å®šçº¿ç¨‹å°†ç»‘å®šåˆ°çš„è®¡ç®—æœºä½ç½®ï¼ˆç¡¬ä»¶çº¿ç¨‹ã€æ ¸å¿ƒæˆ–æ’æ§½ï¼‰ã€‚OMP_PROC_BIND ç”¨äºæŒ‡å®šç»‘å®šç­–ç•¥ï¼ˆçº¿ç¨‹å…³è”æ€§ç­–ç•¥ï¼‰ï¼Œè¿™é¡¹ç­–ç•¥æŒ‡å®šå¦‚ä½•å°†çº¿ç¨‹åˆ†é…åˆ°ä½ç½®ã€‚ é™¤äº† OMP_PLACES å’Œ OMP_P"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108091250.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108091641.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108092147.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108092508.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108092557.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108092830.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220917130916.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108162521.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108162536.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108162156.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108101831.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/20220108100045.png"><meta property="og:image" content="https://pic.shaojiemike.top/img/0_13220169702p8d.gif"><meta property="article:published_time" content="2022-01-07T16:00:00.000Z"><meta property="article:modified_time" content="2023-12-25T12:12:36.452Z"><meta property="article:author" content="Shaojie Tan"><meta property="article:tag" content="openmp"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://pic.shaojiemike.top/img/20220108091250.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://icarus.shaojiemike.top/2022/01/07/Work/HPC/MPI_OMP/openmp/"},"headline":"OpenMP","image":["https://pic.shaojiemike.top/img/20220108091250.png","https://pic.shaojiemike.top/img/20220108091641.png","https://pic.shaojiemike.top/img/20220108092147.png","https://pic.shaojiemike.top/img/20220108092508.png","https://pic.shaojiemike.top/img/20220108092557.png","https://pic.shaojiemike.top/img/20220108092830.png","https://pic.shaojiemike.top/img/20220917130916.png","https://pic.shaojiemike.top/img/20220108162521.png","https://pic.shaojiemike.top/img/20220108162536.png","https://pic.shaojiemike.top/img/20220108162156.png","https://pic.shaojiemike.top/img/20220108101831.png","https://pic.shaojiemike.top/img/20220108100045.png","https://pic.shaojiemike.top/img/0_13220169702p8d.gif"],"datePublished":"2022-01-07T16:00:00.000Z","dateModified":"2023-12-25T12:12:36.452Z","author":{"@type":"Person","name":"Shaojie Tan"},"publisher":{"@type":"Organization","name":"SHAOJIE'S BOOK","logo":{"@type":"ImageObject","url":"http://icarus.shaojiemike.top/img/logo.svg"}},"description":"çº¿ç¨‹ç»‘å®šOpenMP 4.0 æä¾› OMP_PLACES å’Œ OMP_PROC_BIND ç¯å¢ƒå˜é‡æ¥æŒ‡å®šç¨‹åºä¸­çš„ OpenMP çº¿ç¨‹å¦‚ä½•ç»‘å®šåˆ°å¤„ç†å™¨ã€‚è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡é€šå¸¸ç»“åˆä½¿ç”¨ã€‚OMP_PLACES ç”¨äºæŒ‡å®šçº¿ç¨‹å°†ç»‘å®šåˆ°çš„è®¡ç®—æœºä½ç½®ï¼ˆç¡¬ä»¶çº¿ç¨‹ã€æ ¸å¿ƒæˆ–æ’æ§½ï¼‰ã€‚OMP_PROC_BIND ç”¨äºæŒ‡å®šç»‘å®šç­–ç•¥ï¼ˆçº¿ç¨‹å…³è”æ€§ç­–ç•¥ï¼‰ï¼Œè¿™é¡¹ç­–ç•¥æŒ‡å®šå¦‚ä½•å°†çº¿ç¨‹åˆ†é…åˆ°ä½ç½®ã€‚ é™¤äº† OMP_PLACES å’Œ OMP_P"}</script><link rel="canonical" href="http://icarus.shaojiemike.top/2022/01/07/Work/HPC/MPI_OMP/openmp/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-07T16:00:00.000Z" title="1/7/2022, 4:00:00 PM">2022-01-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-12-25T12:12:36.452Z" title="12/25/2023, 12:12:36 PM">2023-12-25</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">11 minutes read (About 1698 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">OpenMP</h1><div class="content"><h2 id="çº¿ç¨‹ç»‘å®š"><a href="#çº¿ç¨‹ç»‘å®š" class="headerlink" title="çº¿ç¨‹ç»‘å®š"></a>çº¿ç¨‹ç»‘å®š</h2><p>OpenMP 4.0 æä¾› <code>OMP_PLACES</code> å’Œ <code>OMP_PROC_BIND</code> ç¯å¢ƒå˜é‡æ¥æŒ‡å®šç¨‹åºä¸­çš„ OpenMP çº¿ç¨‹å¦‚ä½•ç»‘å®šåˆ°å¤„ç†å™¨ã€‚è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡é€šå¸¸ç»“åˆä½¿ç”¨ã€‚<code>OMP_PLACES</code> ç”¨äºæŒ‡å®šçº¿ç¨‹å°†ç»‘å®šåˆ°çš„è®¡ç®—æœºä½ç½®ï¼ˆç¡¬ä»¶çº¿ç¨‹ã€æ ¸å¿ƒæˆ–æ’æ§½ï¼‰ã€‚<code>OMP_PROC_BIND</code> ç”¨äºæŒ‡å®šç»‘å®šç­–ç•¥ï¼ˆçº¿ç¨‹å…³è”æ€§ç­–ç•¥ï¼‰ï¼Œè¿™é¡¹ç­–ç•¥æŒ‡å®šå¦‚ä½•å°†çº¿ç¨‹åˆ†é…åˆ°ä½ç½®ã€‚</p>
<p>é™¤äº† <code>OMP_PLACES</code> å’Œ <code>OMP_PROC_BIND</code> è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡å¤–ï¼ŒOpenMP 4.0 è¿˜æä¾›å¯åœ¨ parallel æŒ‡ä»¤ä¸­ä½¿ç”¨çš„ <code>proc_bind</code> å­å¥ã€‚<code>proc_bind</code> å­å¥ç”¨äºæŒ‡å®šå¦‚ä½•å°†æ‰§è¡Œå¹¶è¡ŒåŒºåŸŸçš„çº¿ç¨‹ç»„ç»‘å®šåˆ°å¤„ç†å™¨ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://lab.cs.tsinghua.edu.cn/hpc/doc/faq/binding/">SlURM MPI OpenMPç»‘å®šæ–¹æ³•å‚è€ƒæ¸…åçš„æ–‡æ¡£</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">OMP_NUM_THREADS=28 OMP_PROC_BIND=true OMP_PLACES=coresï¼šæ¯ä¸ªçº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ª coreï¼Œä½¿ç”¨é»˜è®¤çš„åˆ†å¸ƒï¼ˆçº¿ç¨‹ n ç»‘å®šåˆ° core nï¼‰ï¼›</span><br><span class="line">OMP_NUM_THREADS=2 OMP_PROC_BIND=true OMP_PLACES=socketsï¼šæ¯ä¸ªçº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ª socketï¼›</span><br><span class="line">OMP_NUM_THREADS=4 OMP_PROC_BIND=close OMP_PLACES=coresï¼šæ¯ä¸ªçº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ª coreï¼Œçº¿ç¨‹åœ¨ socket ä¸Šè¿ç»­åˆ†å¸ƒï¼ˆåˆ†åˆ«ç»‘å®šåˆ° core 0,1,2,3ï¼›</span><br><span class="line">OMP_NUM_THREADS=4 OMP_PROC_BIND=spread OMP_PLACES=coresï¼šæ¯ä¸ªçº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ª coreï¼Œçº¿ç¨‹åœ¨ socket ä¸Šå°½é‡æ•£å¼€åˆ†å¸ƒï¼ˆåˆ†åˆ«ç»‘å®šåˆ° core 0,7,14,21ï¼›</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lscpuç»“åˆhtopè§‚å¯Ÿ</span><br><span class="line">NUMA èŠ‚ç‚¹0 CPUï¼š                 0-15,32-47              </span><br><span class="line">NUMA èŠ‚ç‚¹1 CPUï¼š                 16-31,48-63</span><br></pre></td></tr></table></figure>
<h2 id="ç¼–è¯‘åˆ¶å¯¼æ ¼å¼"><a href="#ç¼–è¯‘åˆ¶å¯¼æ ¼å¼" class="headerlink" title="ç¼–è¯‘åˆ¶å¯¼æ ¼å¼"></a>ç¼–è¯‘åˆ¶å¯¼æ ¼å¼</h2><p><img src="https://pic.shaojiemike.top/img/20220108091250.png"></p>
<p>é™æ€æ‰©å±•</p>
<ul>
<li>æ–‡æœ¬ä»£ç åœ¨ä¸€ä¸ªç¼–è¯‘åˆ¶å¯¼è¯­å¥ä¹‹åï¼Œè¢«å°è£…åˆ°ä¸€ä¸ªç»“æ„å—ä¸­</li>
</ul>
<p>å­¤ç«‹è¯­å¥</p>
<ul>
<li>ä¸€ä¸ªOpenMPçš„ç¼–è¯‘åˆ¶å¯¼è¯­å¥<strong>ä¸ä¾èµ–</strong>äºå…¶å®ƒçš„è¯­å¥</li>
</ul>
<h3 id="parallel"><a href="#parallel" class="headerlink" title="parallel"></a>parallel</h3><p>å¹¶è¡ŒåŸŸä¸­çš„ä»£ç è¢«æ‰€æœ‰çš„çº¿ç¨‹æ‰§è¡Œ<br><img src="https://pic.shaojiemike.top/img/20220108091641.png"></p>
<h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><p>forè¯­å¥æŒ‡å®šç´§éšå®ƒçš„å¾ªç¯è¯­å¥å¿…é¡»ç”±çº¿ç¨‹ç»„å¹¶è¡Œæ‰§è¡Œï¼›</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092147.png"></p>
<h3 id="sections"><a href="#sections" class="headerlink" title="sections"></a>sections</h3><p>sectionsç¼–è¯‘åˆ¶å¯¼è¯­å¥æŒ‡å®šå†…éƒ¨çš„ä»£ç è¢«åˆ’åˆ†ç»™çº¿ç¨‹ç»„ä¸­çš„å„çº¿ç¨‹</p>
<p>ä¸åŒçš„sectionç”±ä¸åŒçš„çº¿ç¨‹æ‰§è¡Œ</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092508.png"><br><img src="https://pic.shaojiemike.top/img/20220108092557.png"></p>
<h3 id="single"><a href="#single" class="headerlink" title="single"></a>single</h3><p>singleç¼–è¯‘åˆ¶å¯¼è¯­å¥æŒ‡å®šå†…éƒ¨ä»£ç åªæœ‰çº¿ç¨‹ç»„ä¸­çš„ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p>
<p>çº¿ç¨‹ç»„ä¸­æ²¡æœ‰æ‰§è¡Œsingleè¯­å¥çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ä»£ç å—çš„ç»“æŸï¼Œä½¿ç”¨nowaitå­å¥é™¤å¤–</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092830.png"></p>
<p><img src="https://pic.shaojiemike.top/img/20220917130916.png"></p>
<p>æ¥è‡ª <a target="_blank" rel="noopener" href="https://ppc.cs.aalto.fi/ch3/nowait/">https://ppc.cs.aalto.fi/ch3/nowait/</a></p>
<h3 id="ç»„åˆparallel-for-parallel-sections-ç¼–è¯‘åˆ¶å¯¼è¯­å¥"><a href="#ç»„åˆparallel-for-parallel-sections-ç¼–è¯‘åˆ¶å¯¼è¯­å¥" class="headerlink" title="ç»„åˆparallel for &#x2F; parallel sections ç¼–è¯‘åˆ¶å¯¼è¯­å¥"></a>ç»„åˆparallel for &#x2F; parallel sections ç¼–è¯‘åˆ¶å¯¼è¯­å¥</h3><ol>
<li>Parallel forç¼–è¯‘åˆ¶å¯¼è¯­å¥è¡¨æ˜ä¸€ä¸ªå¹¶è¡ŒåŸŸåŒ…å«ä¸€ä¸ªç‹¬ç«‹çš„forè¯­å¥</li>
<li>parallel sectionsç¼–è¯‘åˆ¶å¯¼è¯­å¥è¡¨æ˜ä¸€ä¸ªå¹¶è¡ŒåŸŸåŒ…å«å•ç‹¬çš„ä¸€ä¸ªsectionsè¯­å¥</li>
</ol>
<h3 id="åŒæ­¥ç»“æ„"><a href="#åŒæ­¥ç»“æ„" class="headerlink" title="åŒæ­¥ç»“æ„"></a>åŒæ­¥ç»“æ„</h3><ol>
<li>master åˆ¶å¯¼è¯­å¥<ol>
<li>æŒ‡å®šä»£ç æ®µåªæœ‰ä¸»çº¿ç¨‹æ‰§è¡Œ</li>
</ol>
</li>
<li>criticalåˆ¶å¯¼è¯­å¥<ol>
<li>criticalåˆ¶å¯¼è¯­å¥è¡¨æ˜åŸŸä¸­çš„ä»£ç ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹è¢«é˜»å¡åœ¨ä¸´ç•ŒåŒº</li>
<li>è¯­å¥æ ¼å¼ï¼š<code>#pragma omp critical [name] newline</code></li>
</ol>
</li>
<li>barrieråˆ¶å¯¼è¯­å¥<ol>
<li>åŒæ­¥ä¸€ä¸ªçº¿ç¨‹ç»„ä¸­æ‰€æœ‰çš„çº¿ç¨‹,å…ˆåˆ°è¾¾çš„çº¿ç¨‹åœ¨æ­¤é˜»å¡ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹</li>
</ol>
</li>
<li>atomicåˆ¶å¯¼è¯­å¥<ol>
<li>æŒ‡å®šç‰¹å®šçš„å­˜å‚¨å•å…ƒå°†è¢«åŸå­æ›´æ–°</li>
<li><pre><code>#pragma omp atomic
x++;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">5. flushåˆ¶å¯¼è¯­å¥</span><br><span class="line">   1. æ ‡è¯†ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œç”¨ä»¥ç¡®ä¿æ‰€æœ‰çš„çº¿ç¨‹çœ‹åˆ°ä¸€è‡´çš„å­˜å‚¨å™¨è§†å›¾</span><br><span class="line">   2. ![](https://pic.shaojiemike.top/img/20220108093740.png)</span><br><span class="line">6. orderedåˆ¶å¯¼è¯­å¥</span><br><span class="line">   1. ç›¸å¯¹äºcriticalï¼Œå¤šäº†ä¸€ä¸ªé¡ºåº</span><br><span class="line">   2. åªèƒ½å‡ºç°åœ¨foræˆ–è€…parallel forè¯­å¥çš„åŠ¨æ€èŒƒå›´ä¸­</span><br><span class="line">7. threadprivateè¯­å¥ä½¿ä¸€ä¸ªå…¨å±€æ–‡ä»¶ä½œç”¨åŸŸçš„å˜é‡åœ¨å¹¶è¡ŒåŸŸå†…å˜æˆæ¯ä¸ªçº¿ç¨‹ç§æœ‰</span><br><span class="line">   1. æ¯ä¸ªçº¿ç¨‹å¯¹è¯¥å˜é‡å¤åˆ¶ä¸€ä»½ç§æœ‰æ‹·è´</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### critical vs atomic</span><br><span class="line">The fastest way is neither critical nor atomic. Approximately, addition with critical section is 200 times more expensive than simple addition, atomic addition is 25 times more expensive then simple addition.(**maybe no so much expensive**, the atomic operation will have a few cycle overhead (synchronizing a cache line) on the cost of roughly a cycle. A critical section incurs **the cost of a lock**.)</span><br><span class="line"></span><br><span class="line">The fastest option (not always applicable) is to give each thread its own counter and make reduce operation when you need total sum.</span><br><span class="line"></span><br><span class="line">### critical vs ordered</span><br><span class="line">omp critical is for mutual exclusion(äº’æ–¥), omp ordered refers to a specific loop and ensures that the region **executes sequentually in the order of loop iterations**. Therefore omp ordered is stronger than omp critical, but also only makes sense within a loop.</span><br><span class="line"></span><br><span class="line">omp ordered has some other clauses, such as simd to enforce the use of a single SIMD lane only. You can also specify dependencies manually with the depend clause.</span><br><span class="line"></span><br><span class="line">Note: Both omp critical and omp ordered regions have an implicit memory flush at the entry and the exit.</span><br><span class="line"></span><br><span class="line">### ordered example</span><br></pre></td></tr></table></figure>
vector&lt;int&gt; v;
</code></pre>
</li>
</ol>
</li>
</ol>
<p>#pragma omp parallel for ordered schedule(dynamic, anyChunkSizeGreaterThan1)<br>    for (int i &#x3D; 0; i &lt; n; ++i){<br>            â€¦<br>            â€¦<br>            â€¦<br>#pragma omp ordered<br>            v.push_back(i);<br>    }</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">tid  List of     Timeline</span><br><span class="line">     iterations</span><br><span class="line">0    0,1,2       ==o==o==o</span><br><span class="line">1    3,4,5       ==.......o==o==o</span><br><span class="line">2    6,7,8       ==..............o==o==o</span><br></pre></td></tr></table></figure>

<p><code>=</code> shows that the thread is executing code in parallel. <code>o</code> is when the thread is executing the ordered region. <code>.</code> is the thread being idle, waiting for its turn to execute the ordered region. </p>
<p>With <code>schedule(static,1)</code> the following would happen:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tid  List of     Timeline</span><br><span class="line">     iterations</span><br><span class="line">0    0,3,6       ==o==o==o</span><br><span class="line">1    1,4,7       ==.o==o==o</span><br><span class="line">2    2,5,8       ==..o==o==o</span><br></pre></td></tr></table></figure>

<h3 id="è¯­å¥ç»‘å®šä¸è¯­å¥åµŒå¥—è§„åˆ™"><a href="#è¯­å¥ç»‘å®šä¸è¯­å¥åµŒå¥—è§„åˆ™" class="headerlink" title="è¯­å¥ç»‘å®šä¸è¯­å¥åµŒå¥—è§„åˆ™"></a>è¯­å¥ç»‘å®šä¸è¯­å¥åµŒå¥—è§„åˆ™</h3><p><img src="https://pic.shaojiemike.top/img/20220108162521.png"><br><img src="https://pic.shaojiemike.top/img/20220108162536.png"></p>
<h2 id="Clauses-å­å¥"><a href="#Clauses-å­å¥" class="headerlink" title="Clauses å­å¥"></a>Clauses å­å¥</h2><p>è§ <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160">https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160</a><br><img src="https://pic.shaojiemike.top/img/20220108162156.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#pragma omp parallel for collapse(2)</span><br><span class="line">for( int y = y1; y &lt; y2; y++ )</span><br><span class="line">&#123;</span><br><span class="line">	for( int x = x1; x &lt; x2; x++ )</span><br><span class="line">	&#123;</span><br></pre></td></tr></table></figure>
<h3 id="schedule"><a href="#schedule" class="headerlink" title="schedule"></a>schedule</h3><p><img src="https://pic.shaojiemike.top/img/20220108101831.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">------------------------------------------------</span><br><span class="line">| static | static | dynamic | dynamic | guided |</span><br><span class="line">|    1   |    5   |    1    |    5    |        |</span><br><span class="line">------------------------------------------------</span><br><span class="line">|    0   |    0   |    0    |    2    |    1   |</span><br><span class="line">|    1   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    2   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    3   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    0   |    0   |    2    |    2    |    1   |</span><br><span class="line">|    1   |    1   |    2    |    3    |    3   |</span><br><span class="line">|    2   |    1   |    2    |    3    |    3   |</span><br><span class="line">|    3   |    1   |    0    |    3    |    3   |</span><br><span class="line">|    0   |    1   |    0    |    3    |    3   |</span><br><span class="line">|    1   |    1   |    0    |    3    |    2   |</span><br><span class="line">|    2   |    2   |    1    |    0    |    2   |</span><br><span class="line">|    3   |    2   |    1    |    0    |    2   |</span><br><span class="line">|    0   |    2   |    1    |    0    |    3   |</span><br><span class="line">|    1   |    2   |    2    |    0    |    3   |</span><br><span class="line">|    2   |    2   |    2    |    0    |    0   |</span><br><span class="line">|    3   |    3   |    2    |    1    |    0   |</span><br><span class="line">|    0   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    1   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    2   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    3   |    3   |    0    |    1    |    3   |</span><br><span class="line">------------------------------------------------</span><br></pre></td></tr></table></figure>
<h3 id="private-vs-firstprivate-vs-lastprivate"><a href="#private-vs-firstprivate-vs-lastprivate" class="headerlink" title="private vs firstprivate vs lastprivate"></a>private vs firstprivate vs lastprivate</h3><p> <code>private</code> variables are not initialised, i.e. they start with random values like any other local automatic variable</p>
<p> <code>firstprivate</code> initial the value as the before value.</p>
<p> <code>lastprivate</code> save the value to the after region. è¿™ä¸ªlastçš„æ„æ€ä¸æ˜¯å®é™…æœ€åè¿è¡Œçš„ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œæ˜¯è°ƒåº¦å‘å°„é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªçº¿ç¨‹ã€‚ä»å¦ä¸€ä¸ªè§’åº¦ä¸Šè¯´ï¼Œå¦‚æœä½ ä¿å­˜çš„å€¼æ¥è‡ªéšæœºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¹Ÿæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚<br> firstprivate and lastprivate are just <strong>special cases</strong> of private</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#pragma omp parallel</span><br><span class="line">&#123;</span><br><span class="line">   #pragma omp for lastprivate(i)</span><br><span class="line">      for (i=0; i&lt;n-1; i++)</span><br><span class="line">         a[i] = b[i] + b[i+1];</span><br><span class="line">&#125;</span><br><span class="line">a[i]=b[i];</span><br></pre></td></tr></table></figure>
<h3 id="private-vs-threadprivate"><a href="#private-vs-threadprivate" class="headerlink" title="private vs threadprivate"></a>private vs threadprivate</h3><p><img src="https://pic.shaojiemike.top/img/20220108100045.png"></p>
<p>A <code>private</code> variable is local to a region and will most of the time be placed on the <code>stack</code>. The lifetime of the variableâ€™s privacy is <code>the duration defined of the data scoping clause</code>. Every thread (including the master thread) makes a private <code>copy of the original variable</code> (the new variable is no longer storage-associated with the original variable).</p>
<p>A <code>threadprivate</code> variable on the other hand will be most likely placed in the <code>heap</code> or in the thread local storage (that can be seen as a global memory local to a thread). A threadprivate variable <code>persist across regions</code> (depending on some restrictions). <code>The master thread uses the original variable</code>, all other threads make a private copy of the original variable (the master variable is still storage-associated with the original variable).</p>
<h2 id="task-æŒ‡ä»¤"><a href="#task-æŒ‡ä»¤" class="headerlink" title="task æŒ‡ä»¤"></a>task æŒ‡ä»¤</h2><p>å¯ä»¥æŒ‡å®šæŸä¸€taskä»»åŠ¡åœ¨æŒ‡å®šç¬¬å‡ ä¸ªthreadè¿è¡Œå—ï¼Ÿ</p>
<h2 id="section-å‘½ä»¤-ä¸-for-å‘½ä»¤çš„åŒºåˆ«"><a href="#section-å‘½ä»¤-ä¸-for-å‘½ä»¤çš„åŒºåˆ«" class="headerlink" title="section å‘½ä»¤ ä¸ for å‘½ä»¤çš„åŒºåˆ«"></a>section å‘½ä»¤ ä¸ for å‘½ä»¤çš„åŒºåˆ«</h2><p>ç®€å•ç†è§£sectionså…¶å®æ˜¯forçš„å±•å¼€å½¢å¼ï¼Œé€‚åˆäºå°‘é‡çš„â€œä»»åŠ¡â€ï¼Œå¹¶ä¸”é€‚åˆäºæ²¡æœ‰è¿­ä»£å…³ç³»çš„â€œä»»åŠ¡â€ã€‚æ¯ä¸€ä¸ªsectionè¢«ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œã€‚</p>
<h2 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">omp_get_thread_num() //è·å–çº¿ç¨‹çš„numï¼Œå³IDã€‚åœ¨å¹¶è¡ŒåŒºåŸŸå¤–ï¼Œè·å–çš„æ˜¯masterçº¿ç¨‹çš„IDï¼Œå³ä¸º0ã€‚</span><br><span class="line">omp_get_num_threads/omp_set_num_threads()  //è®¾ç½®/è·å–çº¿ç¨‹æ•°é‡ï¼Œç”¨äºè¦†ç›–OMP_NUM_THREADSç¯å¢ƒå˜é‡çš„è®¾ç½®ã€‚omp_set_num_threadsåœ¨ä¸²è¡ŒåŒºåŸŸè°ƒç”¨æ‰ä¼šæœ‰æ•ˆï¼Œomp_get_num_threadsè·å–å½“å‰çº¿ç¨‹ç»„çš„çº¿ç¨‹æ•°é‡ï¼Œä¸€èˆ¬åœ¨å¹¶è¡ŒåŒºåŸŸè°ƒç”¨ï¼Œåœ¨ä¸²è¡ŒåŒºåŸŸè°ƒç”¨è¿”å›ä¸º1ã€‚</span><br><span class="line">omp_get_max_threads() //è¿”å›OpenMPå½“å‰ç¯å¢ƒä¸‹èƒ½åˆ›å»ºçº¿ç¨‹çš„æœ€å¤§æ•°é‡ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">OMP_SCHEDULEï¼šåªèƒ½ç”¨åˆ°for,parallel forä¸­ã€‚å®ƒçš„å€¼å°±æ˜¯å¤„ç†å™¨ä¸­å¾ªç¯çš„æ¬¡æ•°</span><br><span class="line">OMP_NUM_THREADSï¼šå®šä¹‰æ‰§è¡Œä¸­æœ€å¤§çš„çº¿ç¨‹æ•°</span><br><span class="line">OMP_DYNAMICï¼šé€šè¿‡è®¾å®šå˜é‡å€¼TRUEæˆ–FALSE,æ¥ç¡®å®šæ˜¯å¦åŠ¨æ€è®¾å®šå¹¶è¡ŒåŸŸæ‰§è¡Œçš„çº¿ç¨‹æ•°</span><br><span class="line">OMP_NESTEDï¼šç¡®å®šæ˜¯å¦å¯ä»¥å¹¶è¡ŒåµŒå¥—</span><br></pre></td></tr></table></figure>
<h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#include &lt;omp.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, _TCHAR* argv[])  </span><br><span class="line">&#123;</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	omp_set_num_threads(5);</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line"> </span><br><span class="line">#pragma omp parallel num_threads(5)</span><br><span class="line">	&#123;</span><br><span class="line">		// omp_set_num_threads(6);	// Do not call it in parallel region</span><br><span class="line">		printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	</span><br><span class="line">	omp_set_num_threads(6);</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line"> </span><br><span class="line">	return 0;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.shaojiemike.top/img/0_13220169702p8d.gif"></p>
<h2 id="OpenMPå’Œpthreadæ˜¯å¸¸è§çš„æ¨¡å‹"><a href="#OpenMPå’Œpthreadæ˜¯å¸¸è§çš„æ¨¡å‹" class="headerlink" title="OpenMPå’Œpthreadæ˜¯å¸¸è§çš„æ¨¡å‹"></a>OpenMPå’Œpthreadæ˜¯å¸¸è§çš„æ¨¡å‹</h2><p>â™¦OpenMPä¸ºå¾ªç¯çº§å¹¶è¡Œæä¾›äº†æ–¹ä¾¿çš„åŠŸèƒ½ã€‚çº¿ç¨‹ç”±ç¼–è¯‘å™¨æ ¹æ®ç”¨æˆ·æŒ‡ä»¤åˆ›å»ºå’Œç®¡ç†ã€‚</p>
<p>â™¦pthreadæä¾›äº†æ›´å¤æ‚ã€æ›´åŠ¨æ€çš„æ–¹æ³•ã€‚çº¿ç¨‹ç”±ç”¨æˆ·æ˜¾å¼åˆ›å»ºå’Œç®¡ç†ã€‚</p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><p>å¯¹å­å¥å’Œåˆ¶å¯¼çš„å…³ç³»ä¸æ¸…æ¥š</p>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/gengshenghong/article/details/7004594">https://blog.csdn.net/gengshenghong/article/details/7004594</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160">https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>OpenMP</p><p><a href="http://icarus.shaojiemike.top/2022/01/07/Work/HPC/MPI_OMP/openmp/">http://icarus.shaojiemike.top/2022/01/07/Work/HPC/MPI_OMP/openmp/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Shaojie Tan</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-01-07</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-12-25</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/openmp/">openmp</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/01/23/Work/Architecture/GPU/ampere/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Ampere &amp; Hopper &amp; Pascal</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/12/20/Work/software/linux-apps/VNC/"><span class="level-item">VNC</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="Shaojie Tan"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Shaojie Tan</p><p class="is-size-6 is-block">ğ˜Šğ˜°ğ˜®ğ˜±ğ˜¶ğ˜µğ˜¦ğ˜³ ğ˜ˆğ˜³ğ˜¤ğ˜©ğ˜ªğ˜µğ˜¦ğ˜¤ğ˜µğ˜¶ğ˜³ğ˜¦ &amp; ğ˜ğ˜—ğ˜Š</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Anhui, Hefei, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">372</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">30</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">482</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Kirrito-k423" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Kirrito-k423"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithms/"><span class="level-start"><span class="level-item">Algorithms</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/Architecture/"><span class="level-start"><span class="level-item">Architecture</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile" href="/categories/Artificial-Intelligence/"><span class="level-start"><span class="level-item">Artificial Intelligence</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/Databases/"><span class="level-start"><span class="level-item">Databases</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/HPC/"><span class="level-start"><span class="level-item">HPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math/"><span class="level-start"><span class="level-item">Math</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/Operating-system/"><span class="level-start"><span class="level-item">Operating system</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Overview/"><span class="level-start"><span class="level-item">Overview</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/Software/"><span class="level-start"><span class="level-item">Software</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tips/"><span class="level-start"><span class="level-item">Tips</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Treasure/"><span class="level-start"><span class="level-item">Treasure</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tutorials/"><span class="level-start"><span class="level-item">Tutorials</span></span><span class="level-end"><span class="level-item tag">118</span></span></a></li><li><a class="level is-mobile" href="/categories/Values/"><span class="level-start"><span class="level-item">Values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/architecture/"><span class="level-start"><span class="level-item">architecture</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/diary/"><span class="level-start"><span class="level-item">diary</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/english/"><span class="level-start"><span class="level-item">english</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/hardware/"><span class="level-start"><span class="level-item">hardware</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/math/"><span class="level-start"><span class="level-item">math</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/network/"><span class="level-start"><span class="level-item">network</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/operating-system/"><span class="level-start"><span class="level-item">operating system</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/security/"><span class="level-start"><span class="level-item">security</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/software/"><span class="level-start"><span class="level-item">software</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/thinking/"><span class="level-start"><span class="level-item">thinking</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/thinking/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/tips/"><span class="level-start"><span class="level-item">tips</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/toLearn/"><span class="level-start"><span class="level-item">toLearn</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile" href="/categories/values/"><span class="level-start"><span class="level-item">values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://ibug.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ibugs</span></span><span class="level-right"><span class="level-item tag">ibug.io</span></span></a></li><li><a class="level is-mobile" href="https://jia.je/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">jiegec</span></span><span class="level-right"><span class="level-item tag">jia.je</span></span></a></li><li><a class="level is-mobile" href="https://leimao.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">leimao</span></span><span class="level-right"><span class="level-item tag">leimao.github.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-20T10:32:37.000Z">2023-12-20</time></p><p class="title"><a href="/2023/12/20/Work/Artificial%20Intelligence/AIHardware/">AI Hardware &amp; Accelerators</a></p><p class="categories"><a href="/categories/Artificial-Intelligence/">Artificial Intelligence</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-20T02:19:24.000Z">2023-12-20</time></p><p class="title"><a href="/2023/12/20/Work/Artificial%20Intelligence/Model/CV/Idea2StableDiffusion/">Idea to StableDiffusion</a></p><p class="categories"><a href="/categories/Artificial-Intelligence/">Artificial Intelligence</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-19T02:59:59.000Z">2023-12-19</time></p><p class="title"><a href="/2023/12/19/Work/math/TuringMachinePversusNPproblem/">Turing Machine &amp; P versus NP problem</a></p><p class="categories"><a href="/categories/Math/">Math</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-18T20:59:04.000Z">2023-12-18</time></p><p class="title"><a href="/2023/12/18/Work/Artificial%20Intelligence/Model/AIModelDesignEffectiveness/">AI Model Design Effectiveness</a></p><p class="categories"><a href="/categories/Artificial-Intelligence/">Artificial Intelligence</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-18T08:47:31.000Z">2023-12-18</time></p><p class="title"><a href="/2023/12/18/Work/Artificial%20Intelligence/Model/CV/DeployStableDiffusionTOA100/">Deploy Stable Diffusion to A100</a></p><p class="categories"><a href="/categories/Artificial-Intelligence/">Artificial Intelligence</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">233</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">67</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/"><span class="level-start"><span class="level-item">2021</span></span><span class="level-end"><span class="level-item tag">72</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/5G/"><span class="tag">5G</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/64bits-vs-32bits/"><span class="tag">64bits vs 32bits</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMAT/"><span class="tag">AMAT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMD/"><span class="tag">AMD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ASPLOS/"><span class="tag">ASPLOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ATI/"><span class="tag">ATI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AVX/"><span class="tag">AVX</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Alpha/"><span class="tag">Alpha</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Analysis/"><span class="tag">Analysis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apt/"><span class="tag">Apt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Assembly/"><span class="tag">Assembly</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BFS/"><span class="tag">BFS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BHive/"><span class="tag">BHive</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BT/"><span class="tag">BT</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BTL/"><span class="tag">BTL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Baka-Mitai/"><span class="tag">Baka Mitai</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bash/"><span class="tag">Bash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Big-Endian/"><span class="tag">Big-Endian</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a><p class="is-size-7"><span>&copy; 2023 Shaojie Tan</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>