<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>Category: Tutorials - SHAOJIE&#039;S BOOK</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="SHAOJIE&#039;S BOOK"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SHAOJIE&#039;S BOOK"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="SHAOJIE&#039;S BOOK"><meta property="og:url" content="http://icarus.shaojiemike.top/"><meta property="og:site_name" content="SHAOJIE&#039;S BOOK"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://icarus.shaojiemike.top/img/og_image.png"><meta property="article:author" content="Shaojie Tan"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://icarus.shaojiemike.top/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://icarus.shaojiemike.top"},"headline":"SHAOJIE'S BOOK","image":["http://icarus.shaojiemike.top/img/og_image.png"],"author":{"@type":"Person","name":"Shaojie Tan"},"publisher":{"@type":"Organization","name":"SHAOJIE'S BOOK","logo":{"@type":"ImageObject","url":"http://icarus.shaojiemike.top/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">Categories</a></li><li class="is-active"><a href="#" aria-current="page">Tutorials</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-06T09:55:27.000Z" title="3/6/2022, 9:55:27 AM">2022-03-06</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.962Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">6 minutes read (About 881 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/06/Work/Programming/1-env/terminal/powershell/">Powershell</a></p><div class="content"><article class="message is-info">
        <div class="message-header"><p><i class="fa-solid fa-clipboard mr-2"></i>导言</p>
</div>
        <div class="message-body">
            <p>在 <a target="_blank" rel="noopener" href="https://github.com/microsoft/terminal/">Windows Terminal</a> 里使用， 有些踩坑经验[^1]</p>

        </div>
    </article></div><a class="article-more button is-small is-size-7" href="/2022/03/06/Work/Programming/1-env/terminal/powershell/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-02-22T10:35:16.000Z" title="2/22/2022, 10:35:16 AM">2022-02-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.970Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">7 minutes read (About 995 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/22/Work/software/manager/pip/">Pip</a></p><div class="content"><h2 id="发布自己的pip包"><a href="#发布自己的pip包" class="headerlink" title="发布自己的pip包"></a>发布自己的pip包</h2><p>一、注册自己的 PyPi 帐号</p>
<p>也可以是自己搭的 PyPi私服仓库的账号</p>
<p>二、依据自己的项目目录，创建setup.py</p>
<p>如下图所示，agent_cli是我整体的项目，我想要将pip-test目录下的代码打包上传到Pypi仓库中；</p>
<p>在pip-test的同级目录，创建setup.py文件</p>
<p><img src="https://img2020.cnblogs.com/blog/1745584/202007/1745584-20200715180532904-686172821.png"></p>
<p>三、 编写自己的setup.py文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> setup, find_packages</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    name=<span class="string">&#x27;tsjPython&#x27;</span>,  <span class="comment"># 打包后的包文件名</span></span><br><span class="line">    version=<span class="string">&#x27;0.1&#x27;</span>,  <span class="comment"># 版本号</span></span><br><span class="line">    keywords=(<span class="string">&quot;tsj&quot;</span>),    <span class="comment"># 关键字</span></span><br><span class="line">    description=<span class="string">&#x27;personal code for tsj&#x27;</span>,  <span class="comment"># 说明</span></span><br><span class="line">    long_description=<span class="string">&quot;none&quot;</span>,  <span class="comment"># 详细说明</span></span><br><span class="line">    license=<span class="string">&quot;MIT Licence&quot;</span>,  <span class="comment"># 许可</span></span><br><span class="line">    url=<span class="string">&#x27;http://home.ustc.edu.cn/~shaojiemike&#x27;</span>,</span><br><span class="line">    author=<span class="string">&#x27;Shaojie Tan&#x27;</span>,</span><br><span class="line">    author_email=<span class="string">&#x27;shaojiemike@mail.ustc.edu.cn&#x27;</span>,</span><br><span class="line">    <span class="comment"># packages=find_packages(),     #这个参数是导入目录下的所有__init__.py包</span></span><br><span class="line">    include_package_data=<span class="literal">True</span>,</span><br><span class="line">    platforms=<span class="string">&quot;any&quot;</span>,</span><br><span class="line">    install_requires=[<span class="string">&#x27;termcolor&#x27;</span>,</span><br><span class="line">                      <span class="string">&#x27;plotille&#x27;</span>],    <span class="comment"># 引用到的第三方库</span></span><br><span class="line">    <span class="comment"># py_modules=[&#x27;pip-test.DoRequest&#x27;, &#x27;pip-test.GetParams&#x27;, &#x27;pip-test.ServiceRequest&#x27;,</span></span><br><span class="line">    <span class="comment">#             &#x27;pip-test.ts.constants&#x27;, &#x27;pip-test.ac.Agent2C&#x27;,</span></span><br><span class="line">    <span class="comment">#             &#x27;pip-test.ts.ttypes&#x27;, &#x27;pip-test.ac.constants&#x27;,</span></span><br><span class="line">    <span class="comment">#             &#x27;pip-test.__init__&#x27;],  # 你要打包的文件，这里用下面这个参数代替</span></span><br><span class="line">    packages=[<span class="string">&#x27;tsjPython&#x27;</span>]  <span class="comment"># 这个参数是导入目录下的所有__init__.py包</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>四、打包自己的项目</p>
<p>执行下述两条命令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python setup.py build  　　<span class="comment">#执行此命令后，会生成上面图片中build的目录，目录层级是  build/lib/pip-test,  pip-test目录下就是你打包文件解压后的结果，可以在此查看打包的代码是否完整</span></span><br><span class="line"></span><br><span class="line">python setup.py sdist　　  <span class="comment"># 执行此命令后，就会在dist目录下生成压缩包文件 .tar.gz</span></span><br></pre></td></tr></table></figure>

<p>五、上传到PyPi服务器</p>
<p>在上传前，要建一个文件，<code>$HOME/.pypirc</code>，<code>$HOME</code>目录在linux或者mac系统下就是~&#x2F;目录。在这里建一个 <code>.pypirc</code>文件。里边的内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[distutils]</span><br><span class="line">index-servers = pypi</span><br><span class="line"> </span><br><span class="line">[pypi]</span><br><span class="line">username:你的PyPi用户名</span><br><span class="line">password:你的PyPi密码</span><br></pre></td></tr></table></figure>

<p>或者使用token.</p>
<p>注册好之后，生成一个 token：<a target="_blank" rel="noopener" href="https://pypi.org/manage/account/#api-tokens%E3%80%82%E7%94%B1%E4%BA%8E%E6%88%91%E4%BB%AC%E6%98%AF%E8%A6%81%E4%B8%8A%E4%BC%A0%E6%96%B0%E9%A1%B9%E7%9B%AE%EF%BC%8C%E6%89%80%E4%BB%A5%E4%B8%8D%E8%A6%81%E9%99%90%E5%88%B6">https://pypi.org/manage/account/#api-tokens。由于我们是要上传新项目，所以不要限制</a> scope 到特定的项目。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[pypi]</span><br><span class="line">username = __token__</span><br><span class="line">password = &lt;换成你刚刚复制下来的 token, 包括 `pypi-` 前缀&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>提前安装 <code>py -m pip install --upgrade twine</code></p>
<p>执行此命令： <code>twine upload dist/XXXXX-0.1.0.tar.gz</code>   上传你刚刚打包好的压缩包</p>
<p>六、安装使用</p>
<p>使用 <code>pip install XXX</code>   就可以轻松使用</p>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requests.exceptions.ProxyError: HTTPSConnectionPool(host=&#x27;upload.pypi.org&#x27;, port=443): Max retries exceeded with url: /legacy/ (Caused by ProxyError(&#x27;Cannot connect to proxy.&#x27;, OSError(0, &#x27;Error&#x27;)))</span><br></pre></td></tr></table></figure>

<p>不要挂代理</p>
<h3 id="开发测试包"><a href="#开发测试包" class="headerlink" title="开发测试包"></a>开发测试包</h3><p>如果为了测试而上传代码，会占用版号。</p>
<p>可以通过先安装在本地来实现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install packageName</span><br><span class="line">pip uninstall packageName</span><br></pre></td></tr></table></figure>
<p>使用 setup.py 安装的包会被复制到当前环境的 site-packages 目录下，这意味着，一旦我们修改了包的源代码，就需要重新安装它。</p>
<p>这常常是集中开发过程中的一个问题，因为很容易忘记需要再次执行安装，这就是为什么 setuptools 提供了一个额外的 develop 命令的重要原因。</p>
<p><code>develop</code> 命令的完整格式为<code>Python setup.py develop</code>，该命令允许我们在开发模式下安装包，它会在部署目录（site-packages）时创建一个指向项目源代码的特殊链接，而不是将整个包复制过去，从而实现<strong>在编辑包的源代码之后无需再重新安装</strong>，并且它在 <code>sys.path</code> 中可用，就像正常安装一样。</p>
<p>pip 也支持用这种模式来安装包，这个安装选项叫作可编辑模式，可以使用 install 命令的 -<code>e</code> 参数来启用，代码格式如下：<br><code>pip install -e 包路径</code></p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'>https://www.cnblogs.com/weisunblog/p/13307174.html</div>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-07T16:00:00.000Z" title="1/7/2022, 4:00:00 PM">2022-01-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.946Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">11 minutes read (About 1698 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/07/Work/HPC/MPI_OMP/openmp/">OpenMP</a></p><div class="content"><h2 id="线程绑定"><a href="#线程绑定" class="headerlink" title="线程绑定"></a>线程绑定</h2><p>OpenMP 4.0 提供 <code>OMP_PLACES</code> 和 <code>OMP_PROC_BIND</code> 环境变量来指定程序中的 OpenMP 线程如何绑定到处理器。这两个环境变量通常结合使用。<code>OMP_PLACES</code> 用于指定线程将绑定到的计算机位置（硬件线程、核心或插槽）。<code>OMP_PROC_BIND</code> 用于指定绑定策略（线程关联性策略），这项策略指定如何将线程分配到位置。</p>
<p>除了 <code>OMP_PLACES</code> 和 <code>OMP_PROC_BIND</code> 这两个环境变量外，OpenMP 4.0 还提供可在 parallel 指令中使用的 <code>proc_bind</code> 子句。<code>proc_bind</code> 子句用于指定如何将执行并行区域的线程组绑定到处理器。</p>
<p><a target="_blank" rel="noopener" href="https://lab.cs.tsinghua.edu.cn/hpc/doc/faq/binding/">SlURM MPI OpenMP绑定方法参考清华的文档</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">OMP_NUM_THREADS=28 OMP_PROC_BIND=true OMP_PLACES=cores：每个线程绑定到一个 core，使用默认的分布（线程 n 绑定到 core n）；</span><br><span class="line">OMP_NUM_THREADS=2 OMP_PROC_BIND=true OMP_PLACES=sockets：每个线程绑定到一个 socket；</span><br><span class="line">OMP_NUM_THREADS=4 OMP_PROC_BIND=close OMP_PLACES=cores：每个线程绑定到一个 core，线程在 socket 上连续分布（分别绑定到 core 0,1,2,3；</span><br><span class="line">OMP_NUM_THREADS=4 OMP_PROC_BIND=spread OMP_PLACES=cores：每个线程绑定到一个 core，线程在 socket 上尽量散开分布（分别绑定到 core 0,7,14,21；</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lscpu结合htop观察</span><br><span class="line">NUMA 节点0 CPU：                 0-15,32-47              </span><br><span class="line">NUMA 节点1 CPU：                 16-31,48-63</span><br></pre></td></tr></table></figure>
<h2 id="编译制导格式"><a href="#编译制导格式" class="headerlink" title="编译制导格式"></a>编译制导格式</h2><p><img src="https://pic.shaojiemike.top/img/20220108091250.png"></p>
<p>静态扩展</p>
<ul>
<li>文本代码在一个编译制导语句之后，被封装到一个结构块中</li>
</ul>
<p>孤立语句</p>
<ul>
<li>一个OpenMP的编译制导语句<strong>不依赖</strong>于其它的语句</li>
</ul>
<h3 id="parallel"><a href="#parallel" class="headerlink" title="parallel"></a>parallel</h3><p>并行域中的代码被所有的线程执行<br><img src="https://pic.shaojiemike.top/img/20220108091641.png"></p>
<h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><p>for语句指定紧随它的循环语句必须由线程组并行执行；</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092147.png"></p>
<h3 id="sections"><a href="#sections" class="headerlink" title="sections"></a>sections</h3><p>sections编译制导语句指定内部的代码被划分给线程组中的各线程</p>
<p>不同的section由不同的线程执行</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092508.png"><br><img src="https://pic.shaojiemike.top/img/20220108092557.png"></p>
<h3 id="single"><a href="#single" class="headerlink" title="single"></a>single</h3><p>single编译制导语句指定内部代码只有线程组中的一个线程执行。</p>
<p>线程组中没有执行single语句的线程会一直等待代码块的结束，使用nowait子句除外</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092830.png"></p>
<p><img src="https://pic.shaojiemike.top/img/20220917130916.png"></p>
<p>来自 <a target="_blank" rel="noopener" href="https://ppc.cs.aalto.fi/ch3/nowait/">https://ppc.cs.aalto.fi/ch3/nowait/</a></p>
<h3 id="组合parallel-for-parallel-sections-编译制导语句"><a href="#组合parallel-for-parallel-sections-编译制导语句" class="headerlink" title="组合parallel for &#x2F; parallel sections 编译制导语句"></a>组合parallel for &#x2F; parallel sections 编译制导语句</h3><ol>
<li>Parallel for编译制导语句表明一个并行域包含一个独立的for语句</li>
<li>parallel sections编译制导语句表明一个并行域包含单独的一个sections语句</li>
</ol>
<h3 id="同步结构"><a href="#同步结构" class="headerlink" title="同步结构"></a>同步结构</h3><ol>
<li>master 制导语句<ol>
<li>指定代码段只有主线程执行</li>
</ol>
</li>
<li>critical制导语句<ol>
<li>critical制导语句表明域中的代码一次只能执行一个线程，其他线程被阻塞在临界区</li>
<li>语句格式：<code>#pragma omp critical [name] newline</code></li>
</ol>
</li>
<li>barrier制导语句<ol>
<li>同步一个线程组中所有的线程,先到达的线程在此阻塞，等待其他线程</li>
</ol>
</li>
<li>atomic制导语句<ol>
<li>指定特定的存储单元将被原子更新</li>
<li><pre><code>#pragma omp atomic
x++;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">5. flush制导语句</span><br><span class="line">   1. 标识一个同步点，用以确保所有的线程看到一致的存储器视图</span><br><span class="line">   2. ![](https://pic.shaojiemike.top/img/20220108093740.png)</span><br><span class="line">6. ordered制导语句</span><br><span class="line">   1. 相对于critical，多了一个顺序</span><br><span class="line">   2. 只能出现在for或者parallel for语句的动态范围中</span><br><span class="line">7. threadprivate语句使一个全局文件作用域的变量在并行域内变成每个线程私有</span><br><span class="line">   1. 每个线程对该变量复制一份私有拷贝</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### critical vs atomic</span><br><span class="line">The fastest way is neither critical nor atomic. Approximately, addition with critical section is 200 times more expensive than simple addition, atomic addition is 25 times more expensive then simple addition.(**maybe no so much expensive**, the atomic operation will have a few cycle overhead (synchronizing a cache line) on the cost of roughly a cycle. A critical section incurs **the cost of a lock**.)</span><br><span class="line"></span><br><span class="line">The fastest option (not always applicable) is to give each thread its own counter and make reduce operation when you need total sum.</span><br><span class="line"></span><br><span class="line">### critical vs ordered</span><br><span class="line">omp critical is for mutual exclusion(互斥), omp ordered refers to a specific loop and ensures that the region **executes sequentually in the order of loop iterations**. Therefore omp ordered is stronger than omp critical, but also only makes sense within a loop.</span><br><span class="line"></span><br><span class="line">omp ordered has some other clauses, such as simd to enforce the use of a single SIMD lane only. You can also specify dependencies manually with the depend clause.</span><br><span class="line"></span><br><span class="line">Note: Both omp critical and omp ordered regions have an implicit memory flush at the entry and the exit.</span><br><span class="line"></span><br><span class="line">### ordered example</span><br></pre></td></tr></table></figure>
vector&lt;int&gt; v;
</code></pre>
</li>
</ol>
</li>
</ol>
<p>#pragma omp parallel for ordered schedule(dynamic, anyChunkSizeGreaterThan1)<br>    for (int i &#x3D; 0; i &lt; n; ++i){<br>            …<br>            …<br>            …<br>#pragma omp ordered<br>            v.push_back(i);<br>    }</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">tid  List of     Timeline</span><br><span class="line">     iterations</span><br><span class="line">0    0,1,2       ==o==o==o</span><br><span class="line">1    3,4,5       ==.......o==o==o</span><br><span class="line">2    6,7,8       ==..............o==o==o</span><br></pre></td></tr></table></figure>

<p><code>=</code> shows that the thread is executing code in parallel. <code>o</code> is when the thread is executing the ordered region. <code>.</code> is the thread being idle, waiting for its turn to execute the ordered region. </p>
<p>With <code>schedule(static,1)</code> the following would happen:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tid  List of     Timeline</span><br><span class="line">     iterations</span><br><span class="line">0    0,3,6       ==o==o==o</span><br><span class="line">1    1,4,7       ==.o==o==o</span><br><span class="line">2    2,5,8       ==..o==o==o</span><br></pre></td></tr></table></figure>

<h3 id="语句绑定与语句嵌套规则"><a href="#语句绑定与语句嵌套规则" class="headerlink" title="语句绑定与语句嵌套规则"></a>语句绑定与语句嵌套规则</h3><p><img src="https://pic.shaojiemike.top/img/20220108162521.png"><br><img src="https://pic.shaojiemike.top/img/20220108162536.png"></p>
<h2 id="Clauses-子句"><a href="#Clauses-子句" class="headerlink" title="Clauses 子句"></a>Clauses 子句</h2><p>见 <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160">https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160</a><br><img src="https://pic.shaojiemike.top/img/20220108162156.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#pragma omp parallel for collapse(2)</span><br><span class="line">for( int y = y1; y &lt; y2; y++ )</span><br><span class="line">&#123;</span><br><span class="line">	for( int x = x1; x &lt; x2; x++ )</span><br><span class="line">	&#123;</span><br></pre></td></tr></table></figure>
<h3 id="schedule"><a href="#schedule" class="headerlink" title="schedule"></a>schedule</h3><p><img src="https://pic.shaojiemike.top/img/20220108101831.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">------------------------------------------------</span><br><span class="line">| static | static | dynamic | dynamic | guided |</span><br><span class="line">|    1   |    5   |    1    |    5    |        |</span><br><span class="line">------------------------------------------------</span><br><span class="line">|    0   |    0   |    0    |    2    |    1   |</span><br><span class="line">|    1   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    2   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    3   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    0   |    0   |    2    |    2    |    1   |</span><br><span class="line">|    1   |    1   |    2    |    3    |    3   |</span><br><span class="line">|    2   |    1   |    2    |    3    |    3   |</span><br><span class="line">|    3   |    1   |    0    |    3    |    3   |</span><br><span class="line">|    0   |    1   |    0    |    3    |    3   |</span><br><span class="line">|    1   |    1   |    0    |    3    |    2   |</span><br><span class="line">|    2   |    2   |    1    |    0    |    2   |</span><br><span class="line">|    3   |    2   |    1    |    0    |    2   |</span><br><span class="line">|    0   |    2   |    1    |    0    |    3   |</span><br><span class="line">|    1   |    2   |    2    |    0    |    3   |</span><br><span class="line">|    2   |    2   |    2    |    0    |    0   |</span><br><span class="line">|    3   |    3   |    2    |    1    |    0   |</span><br><span class="line">|    0   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    1   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    2   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    3   |    3   |    0    |    1    |    3   |</span><br><span class="line">------------------------------------------------</span><br></pre></td></tr></table></figure>
<h3 id="private-vs-firstprivate-vs-lastprivate"><a href="#private-vs-firstprivate-vs-lastprivate" class="headerlink" title="private vs firstprivate vs lastprivate"></a>private vs firstprivate vs lastprivate</h3><p> <code>private</code> variables are not initialised, i.e. they start with random values like any other local automatic variable</p>
<p> <code>firstprivate</code> initial the value as the before value.</p>
<p> <code>lastprivate</code> save the value to the after region. 这个last的意思不是实际最后运行的一个线程，而是调度发射队列的最后一个线程。从另一个角度上说，如果你保存的值来自随机一个线程，这也是没有意义的。<br> firstprivate and lastprivate are just <strong>special cases</strong> of private</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#pragma omp parallel</span><br><span class="line">&#123;</span><br><span class="line">   #pragma omp for lastprivate(i)</span><br><span class="line">      for (i=0; i&lt;n-1; i++)</span><br><span class="line">         a[i] = b[i] + b[i+1];</span><br><span class="line">&#125;</span><br><span class="line">a[i]=b[i];</span><br></pre></td></tr></table></figure>
<h3 id="private-vs-threadprivate"><a href="#private-vs-threadprivate" class="headerlink" title="private vs threadprivate"></a>private vs threadprivate</h3><p><img src="https://pic.shaojiemike.top/img/20220108100045.png"></p>
<p>A <code>private</code> variable is local to a region and will most of the time be placed on the <code>stack</code>. The lifetime of the variable’s privacy is <code>the duration defined of the data scoping clause</code>. Every thread (including the master thread) makes a private <code>copy of the original variable</code> (the new variable is no longer storage-associated with the original variable).</p>
<p>A <code>threadprivate</code> variable on the other hand will be most likely placed in the <code>heap</code> or in the thread local storage (that can be seen as a global memory local to a thread). A threadprivate variable <code>persist across regions</code> (depending on some restrictions). <code>The master thread uses the original variable</code>, all other threads make a private copy of the original variable (the master variable is still storage-associated with the original variable).</p>
<h2 id="task-指令"><a href="#task-指令" class="headerlink" title="task 指令"></a>task 指令</h2><p>可以指定某一task任务在指定第几个thread运行吗？</p>
<h2 id="section-命令-与-for-命令的区别"><a href="#section-命令-与-for-命令的区别" class="headerlink" title="section 命令 与 for 命令的区别"></a>section 命令 与 for 命令的区别</h2><p>简单理解sections其实是for的展开形式，适合于少量的“任务”，并且适合于没有迭代关系的“任务”。每一个section被一个线程去执行。</p>
<h2 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">omp_get_thread_num() //获取线程的num，即ID。在并行区域外，获取的是master线程的ID，即为0。</span><br><span class="line">omp_get_num_threads/omp_set_num_threads()  //设置/获取线程数量，用于覆盖OMP_NUM_THREADS环境变量的设置。omp_set_num_threads在串行区域调用才会有效，omp_get_num_threads获取当前线程组的线程数量，一般在并行区域调用，在串行区域调用返回为1。</span><br><span class="line">omp_get_max_threads() //返回OpenMP当前环境下能创建线程的最大数量。</span><br></pre></td></tr></table></figure>

<h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">OMP_SCHEDULE：只能用到for,parallel for中。它的值就是处理器中循环的次数</span><br><span class="line">OMP_NUM_THREADS：定义执行中最大的线程数</span><br><span class="line">OMP_DYNAMIC：通过设定变量值TRUE或FALSE,来确定是否动态设定并行域执行的线程数</span><br><span class="line">OMP_NESTED：确定是否可以并行嵌套</span><br></pre></td></tr></table></figure>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#include &lt;omp.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, _TCHAR* argv[])  </span><br><span class="line">&#123;</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	omp_set_num_threads(5);</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line"> </span><br><span class="line">#pragma omp parallel num_threads(5)</span><br><span class="line">	&#123;</span><br><span class="line">		// omp_set_num_threads(6);	// Do not call it in parallel region</span><br><span class="line">		printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	</span><br><span class="line">	omp_set_num_threads(6);</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line"> </span><br><span class="line">	return 0;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.shaojiemike.top/img/0_13220169702p8d.gif"></p>
<h2 id="OpenMP和pthread是常见的模型"><a href="#OpenMP和pthread是常见的模型" class="headerlink" title="OpenMP和pthread是常见的模型"></a>OpenMP和pthread是常见的模型</h2><p>♦OpenMP为循环级并行提供了方便的功能。线程由编译器根据用户指令创建和管理。</p>
<p>♦pthread提供了更复杂、更动态的方法。线程由用户显式创建和管理。</p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><p>对子句和制导的关系不清楚</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/gengshenghong/article/details/7004594">https://blog.csdn.net/gengshenghong/article/details/7004594</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160">https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-12-20T03:30:29.000Z" title="12/20/2021, 3:30:29 AM">2021-12-20</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.966Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">a minute read (About 145 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/12/20/Work/software/linux-apps/VNC/">VNC</a></p><div class="content"><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># shaojiemike @ node5 in ~ [11:26:56]</span><br><span class="line">$ vncserver -list</span><br><span class="line"></span><br><span class="line">TigerVNC server sessions:</span><br><span class="line"></span><br><span class="line">X DISPLAY #     RFB PORT #      PROCESS ID</span><br><span class="line">:1              5901            148718 (stale)</span><br><span class="line"></span><br><span class="line"># shaojiemike @ node5 in ~ [11:29:39]</span><br><span class="line">$ vncpasswd</span><br><span class="line">Password:</span><br><span class="line"></span><br><span class="line"># shaojiemike @ node5 in ~ [11:34:08]</span><br><span class="line">$ vncserver -kill :1</span><br><span class="line">Killing Xtigervnc process ID 148718... which was already dead</span><br><span class="line">Cleaning stale pidfile &#x27;/home/shaojiemike/.vnc/node5:1.pid&#x27;!</span><br><span class="line"></span><br><span class="line"># shaojiemike @ node5 in ~ [11:36:15]</span><br><span class="line">$ vncserver</span><br><span class="line"></span><br><span class="line">New &#x27;node5:2 (shaojiemike)&#x27; desktop at :2 on machine node5</span><br><span class="line"></span><br><span class="line">Starting applications specified in /etc/X11/Xvnc-session</span><br><span class="line">Log file is /home/shaojiemike/.vnc/node5:2.log</span><br><span class="line"></span><br><span class="line">Use xtigervncviewer -SecurityTypes VncAuth -passwd /home/shaojiemike/.vnc/passwd :2 to connect to the VNC server.</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.shaojiemike.top/img/20211220113457.png"></p>
<h2 id="客户端转发"><a href="#客户端转发" class="headerlink" title="客户端转发"></a>客户端转发</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 5901:127.0.0.1:5901 -N -f -l shaojiemike node5.xydustc.me</span><br></pre></td></tr></table></figure>

<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'></div>
无

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-10-26T01:03:53.000Z" title="10/26/2021, 1:03:53 AM">2021-10-26</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.842Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">a few seconds read (About 57 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/10/26/OutOfWork/4-devices/Bios/">Bios</a></p><div class="content"><h2 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h2><p><img src="https://pic.shaojiemike.top/img/20211026090426.png"><br><img src="https://pic.shaojiemike.top/img/20211026091331.png"></p>
<h3 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h3><p><img src="https://pic.shaojiemike.top/img/20211026091601.png"></p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'></div>
无

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-10-20T16:00:00.000Z" title="10/20/2021, 4:00:00 PM">2021-10-20</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.950Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">4 minutes read (About 563 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/10/20/Work/HPC/llvm-mca/LLVM-mca3/">LLVM Mca : huawei HiSilicon&#039;s TSV110 work</a></p><div class="content"><h2 id="几个对比图"><a href="#几个对比图" class="headerlink" title="几个对比图"></a>几个对比图</h2><p><img src="https://pic.shaojiemike.top/img/20210918160557.png"></p>
<p>x轴的含义是改变port值的意思，比如<code>tsv110alu2</code>是在<code>tsv110</code>的基础上将alu的值改成2</p>
<h2 id="相关的-git-commit"><a href="#相关的-git-commit" class="headerlink" title="相关的 git commit"></a>相关的 git commit</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">commit c9ca3a3c66a493d72cf7afc7ee975e2de399f2e5</span><br><span class="line">Author: Elvina Yakubova &lt;elvina.yakubova@huawei.com&gt;</span><br><span class="line">Date:   Sat Nov 7 01:50:43 2020 +0300</span><br><span class="line"></span><br><span class="line">    [AArch64] Add driver tests for HiSilicon&#x27;s TSV110</span><br><span class="line"></span><br><span class="line">commit 93b99728b1676d23ab5dabc606344230d25e7f4b</span><br><span class="line">Author: Elvina Yakubova &lt;elvina.yakubova@huawei.com&gt;</span><br><span class="line">Date:   Sat Nov 7 01:22:35 2020 +0300</span><br><span class="line"></span><br><span class="line">    [AArch64] Add pipeline model for HiSilicon&#x27;s TSV110</span><br><span class="line"></span><br><span class="line">    This patch adds the scheduling and cost model for TSV110.</span><br><span class="line"></span><br><span class="line">    Reviewed by: SjoerdMeijer, bryanpkc</span><br><span class="line"></span><br><span class="line">    Differential Revision: https://reviews.llvm.org/D89972</span><br><span class="line"></span><br><span class="line">commit 123553921f86ac0fad7b742740aa45e8d380be02</span><br><span class="line">Author: Bryan Chan &lt;bryan.chan@huawei.com&gt;</span><br><span class="line">Date:   Fri Nov 9 19:32:08 2018 +0000</span><br><span class="line"></span><br><span class="line">    [AArch64] Support HiSilicon&#x27;s TSV110 processor</span><br><span class="line"></span><br><span class="line">    Reviewers: t.p.northover, SjoerdMeijer, kristof.beyls</span><br><span class="line"></span><br><span class="line">    Reviewed By: kristof.beyls</span><br><span class="line"></span><br><span class="line">    Subscribers: olista01, javed.absar, kristof.beyls, kristina, llvm-commits</span><br><span class="line"></span><br><span class="line">    Differential Revision: https://reviews.llvm.org/D53908</span><br><span class="line"></span><br><span class="line">    llvm-svn: 346546	</span><br></pre></td></tr></table></figure>
<p>只有3个，感觉和2个功能很相关。</p>
<h2 id="最近-Driver-commit"><a href="#最近-Driver-commit" class="headerlink" title="最近 Driver commit"></a>最近 Driver commit</h2><p><a target="_blank" rel="noopener" href="https://shaojiemike.notion.site/Huawei-work-on-llvm-mca-recur-e338f3133a10416ebdaa596e27e5c5b7">类似的llvm check的设置</a></p>
<h2 id="复现上面的图"><a href="#复现上面的图" class="headerlink" title="复现上面的图"></a>复现上面的图</h2><h3 id="要改的地方"><a href="#要改的地方" class="headerlink" title="要改的地方"></a>要改的地方</h3><p>应该每次都要重新编译安装<br><img src="https://pic.shaojiemike.top/img/20210923203642.png"></p>
<h3 id="测试的汇编代码"><a href="#测试的汇编代码" class="headerlink" title="测试的汇编代码"></a>测试的汇编代码</h3><ol>
<li>判断<code>llvm/test/MC/AArch64</code>下的汇编能用吗?选个最大的，neon 不支持， armv8.2也并不支持。感觉有特别要求<img src="https://pic.shaojiemike.top/img/20211021152612.png"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat neon-diagnostics.s|llvm-mca -timeline -show-encoding -all-stats -all-views</span><br></pre></td></tr></table></figure></li>
<li>选择osaca的benchmark里的add.c</li>
</ol>
<h2 id="AArch64SchedTSV110-td"><a href="#AArch64SchedTSV110-td" class="headerlink" title="AArch64SchedTSV110.td"></a>AArch64SchedTSV110.td</h2><p>locate at llvm&#x2F;lib&#x2F;Target&#x2F;AArch64&#x2F;AArch64SchedTSV110.td</p>
<h3 id="td-file"><a href="#td-file" class="headerlink" title="td file"></a>td file</h3><p>tablegen(LLVM class) definitions</p>
<h3 id="部分指令解释"><a href="#部分指令解释" class="headerlink" title="部分指令解释"></a>部分指令解释</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def : InstRW&lt;[TSV110Wr_2cyc_1MDU],   (instregex <span class="string">&quot;^(AND|BIC|EON|EOR|ORN|ORR)[WX]rs$&quot;</span>)&gt;;</span><br></pre></td></tr></table></figure>
<p>BIC (bit clear) EON (Exclusive OR) ORR (OR operations on the values in Rn and Operand2)</p>
<p>InstRW的定义</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Map a set of opcodes to a list of SchedReadWrite types. This allows</span></span><br><span class="line"><span class="comment">// the subtarget to easily override specific operations.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// SchedModel ties this opcode mapping to a processor.</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">InstRW</span>&lt;list&lt;SchedReadWrite&gt; rw, dag instrlist&gt; &#123;</span><br><span class="line">  list&lt;SchedReadWrite&gt; OperandReadWrites = rw;</span><br><span class="line">  dag Instrs = instrlist;</span><br><span class="line">  SchedMachineModel SchedModel = ?;</span><br><span class="line">  <span class="comment">// Allow a subtarget to mark some instructions as unsupported.</span></span><br><span class="line">  bit Unsupported = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TSV110Wr_2cyc_1MDU的定义</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def TSV110Wr_2cyc_1MDU   : SchedWriteRes&lt;[TSV110UnitMDU]&gt;   &#123; let Latency = <span class="number">2</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SchedWriteRes</span>&lt;list&lt;ProcResourceKind&gt; resources&gt; : SchedWrite,</span><br><span class="line">  ProcWriteResources&lt;resources&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义TSV110上可用的每种处理器资源和数量，</span></span><br><span class="line"><span class="comment">//它有8条pipeline管道，每个管道都有自己的队列，微操作在那里等待</span></span><br><span class="line"><span class="comment">//它们的operands和issue将无序地发送到八个执行管道之一。</span></span><br><span class="line">def TSV110UnitMDU  : ProcResource&lt;<span class="number">1</span>&gt;; <span class="comment">// Multi-Cycle</span></span><br></pre></td></tr></table></figure>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'></div>
无

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-10-09T16:00:00.000Z" title="10/9/2021, 4:00:00 PM">2021-10-09</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.950Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">28 minutes read (About 4164 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/10/09/Work/HPC/llvm-mca/LLVM-mca4/">LLVM Mca ：with BHive (2019)</a></p><div class="content"><h2 id="BHive"><a href="#BHive" class="headerlink" title="BHive"></a>BHive</h2><p>一种新的profiler，可以profile没有用户干预的内存访问的基本块。</p>
<p>基于这种profiler创建了BHive,来验证llvm-mca等模型。</p>
<p>BHive是用来评价llvm-mca这些模型的，实验基于各种收集来的<strong>一个基本块</strong>各种评价</p>
<h2 id="I-INTRODUCTION"><a href="#I-INTRODUCTION" class="headerlink" title="I. INTRODUCTION"></a>I. INTRODUCTION</h2><h3 id="Automatically-Profiling-Basic-Blocks"><a href="#Automatically-Profiling-Basic-Blocks" class="headerlink" title="Automatically Profiling Basic Blocks"></a>Automatically Profiling Basic Blocks</h3><p>困难在于现有的 没有考虑 memory crash ??? .默认命中L1 cache</p>
<p>A <strong>key technical challenge</strong> with collecting a large basic block dataset is that there is no existing approach to profile an arbitrary basic block that has been removed from its program<br>context.</p>
<p>(没懂？那为什么要removed from its program<br>context) 因为要把常用的应用拆成小例子来评判，这些模型的准确性。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>运用隐含狄利克雷分布LDA,基于cpu资源的利用率，来cluster benchmark suite里的基本块</p>
<p>通过对各种类型最基本的代码块来进行profile，从而形成针对各种performance model的数据库。</p>
<p>现在已经有超过30万的基本块分析，来源于各种方向的应用，包括数值计算OpenBLAS,数据库SQLite,机器学习TensorFlow，密码学OpenSSL。</p>
<p>这么多的数据产生了一个用于评估performance model的新benchmark。</p>
<p>作者说<strong>performance modeling 研究的未来在于与其他先进技术的大规模定量比较</strong></p>
<h3 id="内存访问的处理"><a href="#内存访问的处理" class="headerlink" title="内存访问的处理"></a>内存访问的处理</h3><p>通过把虚拟页面映射到<strong>单个</strong>物理页面，来合法内存访问同时避免cache miss</p>
<h2 id="II-背景"><a href="#II-背景" class="headerlink" title="II. 背景"></a>II. 背景</h2><h3 id="Existing-Performance-Models"><a href="#Existing-Performance-Models" class="headerlink" title="Existing Performance Models"></a>Existing Performance Models</h3><p>有两种model</p>
<ol>
<li>产生可以详细描述指令何时发射和退休的可解释执行路径的微架构模拟器，附带吞吐量预测。</li>
<li>每条指令都有延迟、吞吐量查找表，相当于一个被寄存器分配器使用的额外开销估计器</li>
</ol>
<p>各种model, 写到另一篇里了</p>
<ol>
<li>IACA</li>
<li>llvm-mca</li>
<li>OSACA</li>
<li>Ithemal</li>
</ol>
<h3 id="Machine-Code-Profilers"><a href="#Machine-Code-Profilers" class="headerlink" title="Machine Code Profilers"></a>Machine Code Profilers</h3><ol>
<li>通过 Agner Fog’s script 测量真实的，有周期，cache miss 等等。<a target="_blank" rel="noopener" href="https://www.agner.org/optimize/testp.zip">https://www.agner.org/optimize/testp.zip</a></li>
<li>nanoBench也是。<a target="_blank" rel="noopener" href="https://github.com/andreas-abel/nanoBench">https://github.com/andreas-abel/nanoBench</a> 可以指定processor?和 kernel模式。</li>
<li><strong>Unrolling</strong><ol>
<li>测量吞吐量的基本方法就是展开一个基本块的代码多次，然后测重复多次的代码。把展开的基本块latency除以<code>unroll factor</code>(典型值是100)</li>
<li>目的：<ol>
<li>边缘化前几次warm up的latency值的影响。</li>
<li>减少收起数据的开销影响</li>
</ol>
</li>
<li><code>unroll factor</code>就是循环展开次数。</li>
</ol>
</li>
<li><strong>局限性</strong>是，必须人工给代码块，不能自动profile一堆任意的基本块来系统性验证。???</li>
</ol>
<h2 id="III-PROFILING-ARBITRARY-BASIC-BLOCKS"><a href="#III-PROFILING-ARBITRARY-BASIC-BLOCKS" class="headerlink" title="III.  PROFILING ARBITRARY BASIC BLOCKS"></a>III.  PROFILING ARBITRARY BASIC BLOCKS</h2><p>目标是在<strong>不需要手动干预</strong>的情况下分析任意基本块，以便测量的<strong>吞吐量</strong>与性能模型通常假定的<strong>定义和不变量</strong>相对应。关键的挑战是使这些基本块能够在不崩溃的情况下<strong>访问任意内存地址</strong>。</p>
<p>由于基本块只是正常程序的一部分，导致根本不能单独正常运行。BHive做的事情就是，让他正常运行。</p>
<h3 id="Handling-Arbitrary-Memory-Accesses"><a href="#Handling-Arbitrary-Memory-Accesses" class="headerlink" title="Handling Arbitrary Memory Accesses"></a>Handling Arbitrary Memory Accesses</h3><p><img src="https://pic.shaojiemike.top/img/20211007210352.png"><br>这个代码块只有执行代码分配在<code>0x4110a</code>时，才能正常运行</p>
<ol>
<li>Remapping Virtual Pages.<ol>
<li>一个基本块的所有虚拟内存页重新映射到一个物理页上，所以全部数据访问都命中L1。这样就可以执行97%的基本块。</li>
<li>步骤<ol>
<li>把原本虚拟页全部unmap<ol>
<li>这会导致除了包含基本块指令的页之外的全部的连续的内存访问出问题？？？</li>
<li>在子进程里运行展开的基本块指令。<ol>
<li>这时对每个unmap的虚拟页的访问都会出错，但是主进程一种监视着。一旦中断就重新映射出错地址，然后重新开始跑。</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>Memory Initialization<ol>
<li>初始化一个中等大小0x12345600的物理页，允许都虚拟页都映射</li>
</ol>
</li>
<li>Virtual page aliasing<ol>
<li>因为不同的虚拟页映射在同一个物理页的同一项导致memory dependences，要等待</li>
<li><strong>剔除</strong>6.28%的基本块</li>
<li>可以通过增大物理页，来减小发生的概率。</li>
</ol>
</li>
</ol>
<h3 id="Overall-Profiling-Workflow"><a href="#Overall-Profiling-Workflow" class="headerlink" title="Overall Profiling Workflow"></a>Overall Profiling Workflow</h3><p>通过重复运行基本块来计算吞吐量</p>
<ol>
<li>Raw Measurement<ol>
<li>先从基本块里，产生不会memory crash的可执行部分。</li>
<li>unroll factor的选取。It uses 100 and 200 as the unroll factors for basic blocks <strong>smaller than 100 bytes</strong>; 50 and 100 for basic blocks <strong>between 100 bytes and 200 bytes</strong>; and finally 16 and 32 for basic blocks <strong>larger than 200 bytes</strong></li>
</ol>
</li>
<li>Filtering<ol>
<li>筛选执行代码满足理想化模型的执行结果，比如命中L1cache</li>
<li>L1 Cache Misses<ol>
<li>工具可以用硬件计数器监控指令和数据cache misses。拒绝所有cache miss的情况。</li>
</ol>
</li>
<li>Unaligned Loads<ol>
<li>不连续的访存会很慢，解决方法就是去除所有有不连续的访存的。大约删除了0.18%的基本块</li>
</ol>
</li>
<li>Subnormal Floating Point<ol>
<li>一些特殊的浮点数计算会比正常的浮点数计算慢20倍，去除了与MXCSR寄存器有关的0.1%的基本块。</li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/8341395/what-is-a-subnormal-floating-point-number">https://stackoverflow.com/questions/8341395/what-is-a-subnormal-floating-point-number</a></li>
</ol>
</li>
<li>Context Switches<ol>
<li>上下文切换(英语：context switch)，又称环境切换，电脑术语，是一个存储和重建CPU的状态 (内文)，因此令多个进程(process)可以分享单一CPU资源的计算过程。要切换CPU上的进程时，必需先行存储目前进程的状态，再将欲运行的进程之状态读回CPU中。</li>
</ol>
</li>
<li>可接受的评估公式 10%的误差？？？</li>
</ol>
</li>
<li>Throughput Calculation<ol>
<li>如果通过了基本块的筛选，用有记录的最小延迟计算吞吐量<img src="https://pic.shaojiemike.top/img/20210920154432.png"></li>
</ol>
</li>
<li>Environment Variance<ol>
<li>由于环境的影响，导致结果有个稳定的偏移。至少执行5次，展开16次的基本块。取最小的5次作为结果。</li>
</ol>
</li>
</ol>
<h3 id="Portability-to-Other-Architectures"><a href="#Portability-to-Other-Architectures" class="headerlink" title="Portability to Other Architectures"></a>Portability to Other Architectures</h3><p>只要架构满足以下几点要求</p>
<ol>
<li>有将多个虚拟页面映射到几个物理页面的API。map<br>multiple virtual pages to a few physical pages <ol>
<li><strong>without</strong> incurring a performance <strong>penalty</strong> due to unnecessary cache invalidation. We therefore require that the target processor has a **physically tagged data cache(VIPT)**？？？</li>
<li>we additionally require that the page size is small enough so the indexing bits are<br>not affected by address translation.</li>
</ol>
</li>
<li>detecting cache misses, </li>
<li>and detecting or disabling floating-point underflow.</li>
</ol>
<h2 id="IV-BASIC-BLOCK-DATASET"><a href="#IV-BASIC-BLOCK-DATASET" class="headerlink" title="IV. BASIC BLOCK DATASET"></a>IV. BASIC BLOCK DATASET</h2><p><img src="https://pic.shaojiemike.top/img/20210921190750.png"></p>
<p>应用的选择</p>
<ol>
<li>尽可能还原现实生活的各个方面，</li>
<li>而且是用户的典型用法。</li>
<li>Clang&#x2F;LLVM (compiler), Redis (inmemory database), SQLite (database), and Gzip 是用高级语言C或者C++编写的，算法和数据结构有复杂的设计。</li>
<li>OpenSSL (cryptography), OpenBLAS , Eigen (scientific computing),TensorFlow (machine learning) 代表的是核心循环是手动汇编优化过的高性能库。<ol>
<li>其中Embree是 用Intel ispc (a data-parallel language)编写的。</li>
</ol>
</li>
</ol>
<p>We compiled all applications with the <strong>highest optimization</strong> settings defined by their build systems. 如果可以用上了AVX2。</p>
<p>使用DynamoRIO动态分析来提炼基本块。可以实现在运行时记录每个运行的基本块。我们采用动态分析，而不是静态反汇编。因为静态反汇编无法区别padding bytes from instructions。???</p>
<p>应用的例子除了FFmpeg and Gzip都是选择的官方的benchmark。<br>Eigen 采用的是 two sparse linear algebra workloads: sparse matrix-matrix multiplication (SpMM) and sparse matrix-vector multiplication (SpMV).</p>
<h2 id="V-BASIC-BLOCK-CLUSTERING"><a href="#V-BASIC-BLOCK-CLUSTERING" class="headerlink" title="V. BASIC BLOCK CLUSTERING"></a>V. BASIC BLOCK CLUSTERING</h2><p>一些基本块比其他的更难建模，???(建什么模，VI-B说明了什么)有内存依赖的基本块预测错误率更高。</p>
<p>采用了一种技术???(是应用在提取上) 基于处理器的使用聚类基本块。<br>这个技术有助于性能模型的设计和使用者<strong>更细粒度了解</strong>performance model,让他们能集中以后新添加的资源在有困难的那一类基本块。</p>
<ol>
<li>Methodology<ol>
<li>具体方法<ol>
<li>找到每个基本块的硬件使用率的表示 port-mapping representation</li>
<li>根据其聚类</li>
</ol>
</li>
<li>对每条指令结合port使用<ol>
<li>运用 Abel and Reineke A. Abel and J. Reineke, “uops.info: Characterizing latency, throughput, and port usage of instructions on intel microarchitectures,” in ASPLOS, 2019的结果 ???</li>
<li>例如???<ol>
<li><code>xor %rax, %rbx</code> in Haswell is <code>&#123;p0156 → 1&#125;</code></li>
</ol>
</li>
</ol>
</li>
<li>使用<strong>Latent Dirichlet Allocation</strong> (LDA)来构建topic model 模型(python 训练模型)<ol>
<li>在语言处理上的应用是基于统计词频</li>
<li>在实际运用的时候，微指令操作会根据使用的port而有小不同。<ol>
<li>topics是分类的类别,6类</li>
<li>documents是基本块</li>
<li>α &#x3D; 1&#x2F;6 and β &#x3D; 1&#x2F;13.</li>
</ol>
</li>
<li>为了推断每个微指令操作所属的类别，我们使用了SciKit Learn transform对于LDA的随机变化推断的默认实现</li>
<li>计算每个基本块的最有可能的类别作为其分类结果</li>
</ol>
</li>
</ol>
</li>
<li>Results<ol>
<li>LDA将结果聚类后，根据基本块的内容，手动进行注名以及说明<img src="https://pic.shaojiemike.top/img/20211009165208.png"></li>
<li>example<img src="https://pic.shaojiemike.top/img/20211009165630.png"></li>
<li>根据运行时频率确定其权重， 基于sample-based profiler??? (A portable sampling-based profiler for java virtual machines,)确定。</li>
<li>高性能的库如预期一样，向量化的基本块占比较多。</li>
<li>其余的无向量化的较多。OpenSSL and Gzip有许多位操作的。</li>
</ol>
</li>
<li>Case Study on Data-Center Applications<ol>
<li>目的：作为测试例子，看这个聚类方法能不能找得到隐藏的热点、工作负载</li>
<li>Methodology<ol>
<li>第一步：首先将其基本块分成之前的几类，还是使用LDA</li>
<li>第二步：分类结果标注</li>
<li>第三步：比较聚类结果的perplexity值???</li>
<li>？？？有没有结合google的应用<img src="https://pic.shaojiemike.top/img/20211009173926.png"></li>
</ol>
</li>
<li>Results<ol>
<li>添加新应用后，该值只是略微增长。说明模型的代表性好。???</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="VI-PERFORMANCE-MODEL-EVALUATION"><a href="#VI-PERFORMANCE-MODEL-EVALUATION" class="headerlink" title="VI. PERFORMANCE MODEL EVALUATION"></a>VI. PERFORMANCE MODEL EVALUATION</h2><p>在3种Intel架构上验证4种已有的性能模型</p>
<ol>
<li>Methodology<ol>
<li>说明各个测试软件的版本。</li>
<li>Dataset<ol>
<li>basic block dataset discussed in Section IV</li>
</ol>
</li>
<li>Platform<ol>
<li>balabala 3种架构的 Intel cpus</li>
</ol>
</li>
<li>Evaluation Metrics<ol>
<li>测量吞吐量t和预测吞吐量t’$$err(t,t’)&#x3D;|\frac{t-t’}{t}|$$</li>
<li>不以预测精度，而是以预测结果的相对关系为评分标准。</li>
</ol>
</li>
<li>额外能评估每个模型如何保持基本块吞吐量的顺序。使用Kendall’s tau系数(越大效果越好)，而不是相对误差。测量的原因是使用者可能关心的不是绝对的数值精度，而是相对关系的准确率。比如优化软件的时候关心的不是具体耗时，而是哪个优化策略耗时更短。</li>
</ol>
</li>
<li>Results<ol>
<li><img src="https://pic.shaojiemike.top/img/20211010154102.png"></li>
<li><strong>IACA</strong> 第二好的，在向量化类模拟的最好</li>
<li><strong>llvm-mca</strong> 最差的，尤其是和loads有关时。</li>
<li><strong>Ithemal</strong>  除了向量基本块都是最好的。在memory dependence (Ld&#x2F;St)尤其好，但是向量基本块不好，可能与训练集没有向量基本块有关。</li>
<li><strong>OSACA</strong> 第三。由于还在开发中，使用还遇到5个bug。在遇到一些不认识的指令的时候，会直接按照nops空指令处理。</li>
</ol>
</li>
<li>Examples of Modeling Bugs<img src="https://pic.shaojiemike.top/img/20211010155758.png"><ol>
<li>最后一个例子是由于模型<strong>错误调度微指令</strong>导致的</li>
<li>Modeling bug due to unsigned division<ol>
<li>例子是 a 64-bit by 32-bit unsigned division.<img src="https://pic.shaojiemike.top/img/20211010162409.png"><img src="https://pic.shaojiemike.top/img/20211010163913.png"><img src="https://pic.shaojiemike.top/img/20211010164039.png"><img src="https://pic.shaojiemike.top/img/20211010164455.png"></li>
<li>???<img src="https://pic.shaojiemike.top/img/20211010164745.png"></li>
</ol>
</li>
<li>Modeling bug due to zero-idioms<ol>
<li><img src="https://pic.shaojiemike.top/img/20211010165301.png"></li>
<li>对这种结果固定的特殊指令的快速处理。</li>
</ol>
</li>
<li>Modeling bug due to mis-scheduling<ol>
<li>对于数据依赖，上下指令的寄存器有写后读。</li>
<li>Ithemal’s and OSACA忽略了该依赖</li>
<li><img src="https://pic.shaojiemike.top/img/20211010170051.png"></li>
<li>llvm-mca 没有注意到(%rcx)是memory，没有依赖可以提前发射。</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="CONCLUSION"><a href="#CONCLUSION" class="headerlink" title="CONCLUSION"></a>CONCLUSION</h2><p>现有的静态分析器对<strong>内存依赖</strong>和<strong>向量化块</strong>的建模还有困难。</p>
<h2 id="github代码说明"><a href="#github代码说明" class="headerlink" title="github代码说明"></a>github代码说明</h2><ol>
<li><code>benchmark/sources</code>下是各种软件的各个部分的16进制基本代码块和其出现概率，用csv格式(逗号分隔值 (Comma-separated values))存储</li>
<li><code>benchmark/throughput</code>是在各种架构下的各基本块的测量吞吐量，单位cycles per hundred-iterations.<br><img src="https://pic.shaojiemike.top/img/20210920151028.png"><img src="https://pic.shaojiemike.top/img/20210920154432.png"></li>
<li><code>benchmark/disasm</code>可以把16进制代码通过<code>nasm</code>变成汇编，<img src="https://pic.shaojiemike.top/img/20210920151258.png"></li>
<li><code>timing-harness</code><img src="https://pic.shaojiemike.top/img/20210920153113.png"><br><img src="https://pic.shaojiemike.top/img/20210921143255.png"><br>吞吐量的计算(猜的)Skylake microarchitecture$$\frac{6632-1030}{2333-100}*100&#x3D;250.8 (cyc&#x2F;hundred\ iters)$$</li>
</ol>
<h2 id="BHive-被质疑的局限性"><a href="#BHive-被质疑的局限性" class="headerlink" title="BHive 被质疑的局限性"></a>BHive 被质疑的局限性</h2><p>uops 的文章， Accurate Throughput Prediction of Basic Blocks on Recent Intel Microarchitectures</p>
<p>4.2 Extending BHive</p>
<h2 id="BHive-运行逻辑"><a href="#BHive-运行逻辑" class="headerlink" title="BHive 运行逻辑"></a>BHive 运行逻辑</h2><ol>
<li>读入16进制代码和循环次数</li>
<li><code>hhex2bin</code>转换为二进制</li>
<li><code>create_shm_fd</code><img src="https://pic.shaojiemike.top/img/20210922150852.png"><img src="https://pic.shaojiemike.top/img/20210922151143.png"><ol>
<li><p><code>shm_open, shm_unlink</code>creates and opens a new, or opens or unlink an existing, POSIX shared memory object. <code>O_RDWR</code> Open the object for read-write access.<code>O_CREAT</code>  the shared memory object if it does not exist. <code>777</code>是类似文件读写执行组权限的东西 On success, shm_open() <code>returns</code> a file descriptor (a nonnegative integer)</p>
</li>
<li><p><code>POSIX</code>可移植操作系统接口The Portable Operating System Interface 是IEEE为要在各种UNIX操作系统上运行软件，而定义API的一系列互相关联的标准的总称。</p>
</li>
<li><p><code>ftruncate</code> — truncate截短 a file to a specified length</p>
</li>
<li><p>#define SIZE_OF_HARNESS_MEM (4096 * 3)</p>
</li>
</ol>
</li>
<li><code>measure</code>开始测量<ol>
<li>int fds[2] ???</li>
<li><code>pipe</code>用于创建pipe,用来<strong>进程间</strong>通信的<strong>单向</strong>数据通路，传入变量用来返回引用自pipe末端的文件描述符file descriptors。<strong>第一个</strong>指向the read end of the pipe，<strong>第二个</strong>指向the write end of the pipe</li>
<li><code>mmap(void *addr, size_t length, int prot, int flags,int fd, off_t offset); munmap(void *addr, size_t length);</code>- map or unmap files or devices into memory 在调用进程的虚拟地址空间里create a new mapping.</li>
<li>fork()产生子进程<ol>
<li>fork()原理详解<ol>
<li>复制之前的一模一样。</li>
<li>fork() returns a zero to the newly created child process.</li>
<li>fork() returns a positive value, the process ID of the child process, to the parent.</li>
</ol>
</li>
<li>父进程<ol>
<li>#define OFFSET_TO_COUNTERS 32</li>
<li>为什么声明一个偏移地址指针???<ol>
<li>struct pmc_counters 由5个uint64_t组成。 uint64 will always take 8 bytes。一个结构体40bytes</li>
</ol>
</li>
<li><code>attach_to_child(pid, fds[1]);</code> pid是子进程pid<ol>
<li><code>ptrace(enum __ptrace_request request, pid_t pid,void *addr, void *data)</code> - process trace 提供一种进程tracer跟踪控制另一个进程tracee的方法，可以修改被控制者的memory and registers.<ol>
<li><code>PTRACE_SEIZE</code> Attach to the process specified in pid, making it a tracee of the calling process.  Unlike PTRACE_ATTACH, PTRACE_SEIZE does <strong>not</strong> stop the process</li>
</ol>
</li>
<li>子进程从fds[0]里读到x里，父进程把x的值写入 fds[1] ???</li>
</ol>
</li>
<li>check Performance Monitoring Counters (PMCs) supports<ol>
<li><code>rdpmc_open_attr</code> initialize a raw ring 3 ReaDable PerforMance Counter</li>
</ol>
</li>
<li>last_failing_inst 和 mapping_done</li>
<li>To kill child<ol>
<li>#define MAX_FAULTS 1024 # 子进程产生的错误需要解决？</li>
<li><code>wait</code>挂起当前线程，直到有一个children结束，返回其PID</li>
<li><code>WIFEXITED</code>Wait_IF_EXITED 判断是否正常结束<img src="https://pic.shaojiemike.top/img/20210922185030.png"></li>
<li>如果错误打印出错信号(eg.11)指令指针寄存器RIP,指针寄存器RSP<img src="https://pic.shaojiemike.top/img/20210922190632.png"><img src="https://pic.shaojiemike.top/img/20210922191039.png"><img src="https://pic.shaojiemike.top/img/20210922191252.png"></li>
<li>函数是用汇编写的就离谱<img src="https://pic.shaojiemike.top/img/20210922191507.png"><img src="https://pic.shaojiemike.top/img/20210922193149.png"><img src="https://pic.shaojiemike.top/img/20210922192559.png"><img src="https://pic.shaojiemike.top/img/20210922191801.png"><img src="https://pic.shaojiemike.top/img/20210922191931.png">what is aux mem?</li>
<li>修改出错地方的寄存器，重新运行<code>PTRACE_CONT</code> Restart the stopped tracee process</li>
<li>最多执行MAX_FAULTS次</li>
</ol>
</li>
<li>最后父进程杀死子进程</li>
</ol>
</li>
<li>子进程<ol>
<li>父进程测试是否支持PMCs,子进程使用<img src="https://pic.shaojiemike.top/img/20210922194738.png"><img src="https://pic.shaojiemike.top/img/20210922195030.png"></li>
<li>harness.c ：277</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/from-zero/p/13750852.html">https://www.cnblogs.com/from-zero/p/13750852.html</a></p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><ol>
<li>time 怎么算的the latency of the basic block？为什么打印15个呢？</li>
<li>还有中间的错误是怎么回事?</li>
<li>论文里的误差怎么算的？<ol>
<li>BHive整合了几个软件（整合了什么呢），应该是真实测量了得出真实吞吐量？还是也是模拟的？</li>
<li>和uops比怎么样</li>
</ol>
</li>
<li>哪个数据是准确的，是BHive模拟的，还是真实测量的。<ol>
<li>通过 Agner Fog’s script 测量真实的，有周期，cache miss 等等。<a target="_blank" rel="noopener" href="https://www.agner.org/optimize/testp.zip">https://www.agner.org/optimize/testp.zip</a></li>
<li>nanoBench也是。<a target="_blank" rel="noopener" href="https://github.com/andreas-abel/nanoBench">https://github.com/andreas-abel/nanoBench</a> 可以指定processor?和 kernel模式。</li>
<li>局限性是，必须人工给代码块，不能自动profile一堆任意的基本块来系统性验证。???</li>
</ol>
</li>
<li>BHvie的代码实现，移植到鲲鹏，然后根据PMU调准。</li>
</ol>
<p>问题是x86的二进制或者汇编不能变成aarm64的二进制或者汇编。</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a target="_blank" rel="noopener" href="https://github.com/ithemal/bhive">https://github.com/ithemal/bhive</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-09-15T02:29:03.000Z" title="9/15/2021, 2:29:03 AM">2021-09-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.950Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">6 minutes read (About 895 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/09/15/Work/HPC/llvm-mca/LLVM-mca2/">LLVM-MCA: Install&amp;RunTests</a></p><div class="content"><h2 id="github"><a href="#github" class="headerlink" title="github"></a>github</h2><p><a target="_blank" rel="noopener" href="https://github.com/llvm/llvm-project/tree/main/llvm/tools/llvm-mca">https://github.com/llvm/llvm-project/tree/main/llvm/tools/llvm-mca</a></p>
<p><img src="https://pic.shaojiemike.top/img/20210910210630.png"></p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><a target="_blank" rel="noopener" href="https://github.com/llvm/llvm-project/releases/tag/llvmorg-12.0.1">下载可执行文件</a>上传服务器，解压</p>
<h3 id="安装遇到的问题"><a href="#安装遇到的问题" class="headerlink" title="安装遇到的问题"></a>安装遇到的问题</h3><ol>
<li>cannot find libtinfo.so.5<ol>
<li>sudo apt install libncurses5</li>
<li>ln -s &#x2F;usr&#x2F;lib&#x2F;libncursesw.so.6 &#x2F;usr&#x2F;lib&#x2F;libtinfo.so.5 或者类似的 ln -s &#x2F;usr&#x2F;lib&#x2F;libncurses.so.5 &#x2F;usr&#x2F;lib&#x2F;libtinfo.so.5 </li>
<li>在&#x2F;snap&#x2F;core下找到了，但是这是什么目录？是之前Ubuntu的包管理工具，但是已经不用了。</li>
</ol>
</li>
</ol>
<h3 id="从源码安装"><a href="#从源码安装" class="headerlink" title="从源码安装"></a>从源码安装</h3><h3 id="node5"><a href="#node5" class="headerlink" title="node5"></a>node5</h3><p>由于之后要写代码的，还是从头安装更好。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd llvm-project</span><br><span class="line">mkdir build</span><br><span class="line">cmake -S llvm -B build -G &quot;Unix Makefiles&quot; -DLLVM_ENABLE_PROJECTS=&quot;clang;llvm-mca&quot; -DCMAKE_INSTALL_PREFIX=&quot;~/Install/llvm&quot; -DCMAKE_BUILD_TYPE=Debug -DLLVM_ENABLE_ASSERTIONS=On</span><br><span class="line">cd build</span><br><span class="line">make -j32</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h3 id="kunpeng"><a href="#kunpeng" class="headerlink" title="kunpeng"></a>kunpeng</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake -S llvm -B build -G &quot;Unix Makefiles&quot; -DLLVM_ENABLE_PROJECTS=all -DCMAKE_INSTALL_PREFIX=&quot;~/Install/llvm&quot; -DCMAKE_BUILD_TYPE=Debug -DLLVM_ENABLE_ASSERTIONS=On</span><br><span class="line">#change cmake or -DLLVM_ENABLE_PROJECTS=&quot;all&quot;</span><br></pre></td></tr></table></figure>
<p>error</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">g++: error: unrecognized command line option ‘-mllvm’</span><br><span class="line">g++: error: unrecognized command line option ‘--tail-merge-threshold=0’</span><br><span class="line">g++: error: unrecognized command line option ‘-combiner-global-alias-analysis’</span><br></pre></td></tr></table></figure>
<p>change</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -S llvm -B build -G &quot;Unix Makefiles&quot; -DLLVM_ENABLE_PROJECTS=&quot;clang;llvm-mca&quot; -DCMAKE_INSTALL_PREFIX=&quot;~/Install/llvm&quot; -DLLVM_TARGETS_TO_BUILD=AArch64 -DCMAKE_BUILD_TYPE=Debug -DLLVM_ENABLE_ASSERTIONS=On</span><br></pre></td></tr></table></figure>

<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang foo.c -O2 -target x86_64-unknown-unknown -S -o - | llvm-mca -mcpu=btver2</span><br></pre></td></tr></table></figure>
<p>由于不是X86,<code>llc --version</code> 查看到target是 <code>aarch64-unknown-linux-gnu</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang /home/shaojiemike/Download/llvm-project-main/lldb/test/API/lang/c/forward/foo.c -O2 -target aarch64-unknown-linux-gnu -S -o -|llvm-mca -timeline -show-encoding -all-stats -all-views</span><br></pre></td></tr></table></figure>
<p>生成汇编代码，并默认管道到llvm-mca,并开启所有输出。</p>
<p>可以看出是用TSV110Unit的port,默认cpu是tsv110</p>
<h2 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h2><h3 id="ALU-BRU"><a href="#ALU-BRU" class="headerlink" title="ALU&#x2F;BRU"></a>ALU&#x2F;BRU</h3><p> 算数逻辑单元 ALU 负责处理整数运算指令. 跳转处理单元BRU 负责处理跳转指令. BRU 可以与 ALU 合并, 复用 ALU 的逻辑来计算跳转指令的条件和跳转地址, 也可以作为一个单独的功能单元接入到流水线中.</p>
<h3 id="MDU"><a href="#MDU" class="headerlink" title="MDU"></a>MDU</h3><p>乘除法单元 MDU (mult-divide unit)</p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><ol>
<li>llvm-mca微指令怎么实现的,怎么把汇编变成微指令</li>
<li>在view里加memory的实现</li>
<li>考虑了cache命中等影响 <a target="_blank" rel="noopener" href="https://github.com/andreas-abel/uiCA">https://github.com/andreas-abel/uiCA</a> uops</li>
<li>鲲鹏架构 <a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/community/usersnew/id_1513665626477516">https://bbs.huaweicloud.com/community/usersnew/id_1513665626477516</a></li>
</ol>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><ol>
<li><code>llvm-mca -mcpu=help</code>竟然会卡住，不知道为什么</li>
<li>所以说是华为已经写了一个叫tsv110的，实现2个功能？</li>
</ol>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'></div>
无

<h2 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">Iterations:        100</span><br><span class="line">Instructions:      200</span><br><span class="line">Total Cycles:      70</span><br><span class="line">Total uOps:        200</span><br><span class="line"></span><br><span class="line">Dispatch Width:    4</span><br><span class="line">uOps Per Cycle:    2.86</span><br><span class="line">IPC:               2.86</span><br><span class="line">Block RThroughput: 0.5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">No resource or data dependency bottlenecks discovered.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Instruction Info:</span><br><span class="line">[1]: #uOps</span><br><span class="line">[2]: Latency</span><br><span class="line">[3]: RThroughput</span><br><span class="line">[4]: MayLoad</span><br><span class="line">[5]: MayStore</span><br><span class="line">[6]: HasSideEffects (U)</span><br><span class="line">[7]: Encoding Size</span><br><span class="line"></span><br><span class="line">[1]    [2]    [3]    [4]    [5]    [6]    [7]    Encodings:                    Instructions:</span><br><span class="line"> 1      1     0.33                         4     20 00 80 52                   mov	w0, #1</span><br><span class="line"> 1      1     0.50                  U      4     c0 03 5f d6                   ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Dynamic Dispatch Stall Cycles:</span><br><span class="line">RAT     - Register unavailable:                      0</span><br><span class="line">RCU     - Retire tokens unavailable:                 0</span><br><span class="line">SCHEDQ  - Scheduler full:                            0</span><br><span class="line">LQ      - Load queue full:                           0</span><br><span class="line">SQ      - Store queue full:                          0</span><br><span class="line">GROUP   - Static restrictions on the dispatch group: 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Dispatch Logic - number of cycles where we saw N micro opcodes dispatched:</span><br><span class="line">[# dispatched], [# cycles]</span><br><span class="line"> 0,              20  (28.6%)</span><br><span class="line"> 4,              50  (71.4%)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Schedulers - number of cycles where we saw N micro opcodes issued:</span><br><span class="line">[# issued], [# cycles]</span><br><span class="line"> 0,          3  (4.3%)</span><br><span class="line"> 2,          1  (1.4%)</span><br><span class="line"> 3,          66  (94.3%)</span><br><span class="line"></span><br><span class="line">Scheduler&#x27;s queue usage:</span><br><span class="line">No scheduler resources used.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Retire Control Unit - number of cycles where we saw N instructions retired:</span><br><span class="line">[# retired], [# cycles]</span><br><span class="line"> 0,           3  (4.3%)</span><br><span class="line"> 2,           1  (1.4%)</span><br><span class="line"> 3,           66  (94.3%)</span><br><span class="line"></span><br><span class="line">Total ROB Entries:                128</span><br><span class="line">Max Used ROB Entries:             59  ( 46.1% )</span><br><span class="line">Average Used ROB Entries per cy:  32  ( 25.0% )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Register File statistics:</span><br><span class="line">Total number of mappings created:    100</span><br><span class="line">Max number of mappings used:         29</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Resources:</span><br><span class="line">[0.0] - TSV110UnitAB</span><br><span class="line">[0.1] - TSV110UnitAB</span><br><span class="line">[1]   - TSV110UnitALU</span><br><span class="line">[2]   - TSV110UnitFSU1</span><br><span class="line">[3]   - TSV110UnitFSU2</span><br><span class="line">[4.0] - TSV110UnitLdSt</span><br><span class="line">[4.1] - TSV110UnitLdSt</span><br><span class="line">[5]   - TSV110UnitMDU</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Resource pressure per iteration:</span><br><span class="line">[0.0]  [0.1]  [1]    [2]    [3]    [4.0]  [4.1]  [5]    </span><br><span class="line">0.66   0.67   0.67    -      -      -      -      -     </span><br><span class="line"></span><br><span class="line">Resource pressure by instruction:</span><br><span class="line">[0.0]  [0.1]  [1]    [2]    [3]    [4.0]  [4.1]  [5]    Instructions:</span><br><span class="line">0.33    -     0.67    -      -      -      -      -     mov	w0, #1</span><br><span class="line">0.33   0.67    -      -      -      -      -      -     ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Timeline view:</span><br><span class="line">Index     0123456789</span><br><span class="line"></span><br><span class="line">[0,0]     DeER .   .   mov	w0, #1</span><br><span class="line">[0,1]     DeER .   .   ret</span><br><span class="line">[1,0]     DeER .   .   mov	w0, #1</span><br><span class="line">[1,1]     D=eER.   .   ret</span><br><span class="line">[2,0]     .DeER.   .   mov	w0, #1</span><br><span class="line">[2,1]     .DeER.   .   ret</span><br><span class="line">[3,0]     .D=eER   .   mov	w0, #1</span><br><span class="line">[3,1]     .D=eER   .   ret</span><br><span class="line">[4,0]     . DeER   .   mov	w0, #1</span><br><span class="line">[4,1]     . D=eER  .   ret</span><br><span class="line">[5,0]     . D=eER  .   mov	w0, #1</span><br><span class="line">[5,1]     . D=eER  .   ret</span><br><span class="line">[6,0]     .  D=eER .   mov	w0, #1</span><br><span class="line">[6,1]     .  D=eER .   ret</span><br><span class="line">[7,0]     .  D=eER .   mov	w0, #1</span><br><span class="line">[7,1]     .  D==eER.   ret</span><br><span class="line">[8,0]     .   D=eER.   mov	w0, #1</span><br><span class="line">[8,1]     .   D=eER.   ret</span><br><span class="line">[9,0]     .   D==eER   mov	w0, #1</span><br><span class="line">[9,1]     .   D==eER   ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Average Wait times (based on the timeline view):</span><br><span class="line">[0]: Executions</span><br><span class="line">[1]: Average time spent waiting in a scheduler&#x27;s queue</span><br><span class="line">[2]: Average time spent waiting in a scheduler&#x27;s queue while ready</span><br><span class="line">[3]: Average time elapsed from WB until retire stage</span><br><span class="line"></span><br><span class="line">      [0]    [1]    [2]    [3]</span><br><span class="line">0.     10    1.7    1.7    0.0       mov	w0, #1</span><br><span class="line">1.     10    2.0    2.0    0.0       ret</span><br><span class="line">       10    1.9    1.9    0.0       &lt;total&gt;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-08-27T02:17:19.000Z" title="8/27/2021, 2:17:19 AM">2021-08-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.946Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">a few seconds read (About 85 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/08/27/Work/HPC/IPCC/ipcc13/">IPCC Preliminary SLIC Case1/2/3</a></p><div class="content"><h2 id="case-1"><a href="#case-1" class="headerlink" title="case 1"></a>case 1</h2><h3 id="default"><a href="#default" class="headerlink" title="default"></a>default</h3><p><img src="https://pic.shaojiemike.top/img/20210827103406.png"></p>
<h3 id="enforce-intel"><a href="#enforce-intel" class="headerlink" title="enforce_intel"></a>enforce_intel</h3><p><img src="https://pic.shaojiemike.top/img/20210827104120.png"></p>
<h2 id="case-2"><a href="#case-2" class="headerlink" title="case 2"></a>case 2</h2><h3 id="default-1"><a href="#default-1" class="headerlink" title="default"></a>default</h3><p><img src="https://pic.shaojiemike.top/img/20210827102007.png"></p>
<h3 id="enforce-intel-1"><a href="#enforce-intel-1" class="headerlink" title="enforce_intel"></a>enforce_intel</h3><p><img src="https://pic.shaojiemike.top/img/20210827104322.png"></p>
<h2 id="case-3"><a href="#case-3" class="headerlink" title="case 3"></a>case 3</h2><h3 id="default-2"><a href="#default-2" class="headerlink" title="default"></a>default</h3><p><img src="https://pic.shaojiemike.top/img/20210827102322.png"></p>
<h3 id="enforce-intel-2"><a href="#enforce-intel-2" class="headerlink" title="enforce_intel"></a>enforce_intel</h3><p><img src="https://pic.shaojiemike.top/img/20210827104427.png"></p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'></div>
无

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-08-24T11:35:24.000Z" title="8/24/2021, 11:35:24 AM">2021-08-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-16T07:10:54.946Z" title="9/16/2024, 7:10:54 AM">2024-09-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">a minute read (About 188 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/08/24/Work/HPC/IPCC/ipcc12/">IPCC Preliminary SLIC Optimization 6: Non-blocking MPI </a></p><div class="content"><h2 id="非阻塞MPI"><a href="#非阻塞MPI" class="headerlink" title="非阻塞MPI"></a>非阻塞MPI</h2><p><img src="https://pic.shaojiemike.top/img/20210824193806.png"></p>
<p>MPI_Send &amp; MPI_receive<br><img src="https://pic.shaojiemike.top/img/20210824193830.png"></p>
<p>MPI_AllTogether()更慢，需要4s</p>
<h2 id="手动向量化对齐"><a href="#手动向量化对齐" class="headerlink" title="手动向量化对齐"></a>手动向量化对齐</h2><h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h3><p><img src="https://pic.shaojiemike.top/img/d438489bdd5b1053243aa1ddd661600.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vx = _mm256_set_pd(x); #改成</span><br><span class="line">vx = _mm256_set_pd(x+3,x+2,x+1,x);</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.shaojiemike.top/img/20210828225101.png"></p>
<p><img src="https://pic.shaojiemike.top/img/20210828225803.png"></p>
<p>发现不对劲，打印更多输出。第一次循环肯定是对的因为和DBL_MAX比较。</p>
<p><img src="https://pic.shaojiemike.top/img/20210829114319.png"></p>
<p><img src="https://pic.shaojiemike.top/img/20210829115314.png"></p>
<p><img src="https://pic.shaojiemike.top/img/20210829120303.png"></p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>为什么明明有56GB的IB网，传输速度还是这么慢呢？写比较慢？</p>
<p>7*8&#x3D;56 8条通道</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'></div>
无

</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/categories/Tutorials/page/8/">Previous</a></div><div class="pagination-next"><a href="/categories/Tutorials/page/10/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/categories/Tutorials/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/categories/Tutorials/page/8/">8</a></li><li><a class="pagination-link is-current" href="/categories/Tutorials/page/9/">9</a></li><li><a class="pagination-link" href="/categories/Tutorials/page/10/">10</a></li><li><a class="pagination-link" href="/categories/Tutorials/page/11/">11</a></li><li><a class="pagination-link" href="/categories/Tutorials/page/12/">12</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="Shaojie Tan"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Shaojie Tan</p><p class="is-size-6 is-block">𝘊𝘰𝘮𝘱𝘶𝘵𝘦𝘳 𝘈𝘳𝘤𝘩𝘪𝘵𝘦𝘤𝘵𝘶𝘳𝘦 &amp; 𝘏𝘗𝘊</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Anhui, Hefei, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">421</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">34</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">510</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Kirrito-k423" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Kirrito-k423"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithms/"><span class="level-start"><span class="level-item">Algorithms</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/Architecture/"><span class="level-start"><span class="level-item">Architecture</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile" href="/categories/Artificial-Intelligence/"><span class="level-start"><span class="level-item">Artificial Intelligence</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Camp/"><span class="level-start"><span class="level-item">Camp</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Databases/"><span class="level-start"><span class="level-item">Databases</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/HPC/"><span class="level-start"><span class="level-item">HPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math/"><span class="level-start"><span class="level-item">Math</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile" href="/categories/Operating-system/"><span class="level-start"><span class="level-item">Operating system</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Overview/"><span class="level-start"><span class="level-item">Overview</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/categories/Software/"><span class="level-start"><span class="level-item">Software</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Thinking/"><span class="level-start"><span class="level-item">Thinking</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Tips/"><span class="level-start"><span class="level-item">Tips</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Treasure/"><span class="level-start"><span class="level-item">Treasure</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tutorials/"><span class="level-start"><span class="level-item">Tutorials</span></span><span class="level-end"><span class="level-item tag">116</span></span></a></li><li><a class="level is-mobile" href="/categories/Values/"><span class="level-start"><span class="level-item">Values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/architecture/"><span class="level-start"><span class="level-item">architecture</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/diary/"><span class="level-start"><span class="level-item">diary</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/english/"><span class="level-start"><span class="level-item">english</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/hardware/"><span class="level-start"><span class="level-item">hardware</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/love/"><span class="level-start"><span class="level-item">love</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/math/"><span class="level-start"><span class="level-item">math</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/network/"><span class="level-start"><span class="level-item">network</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/operating-system/"><span class="level-start"><span class="level-item">operating system</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/programming/"><span class="level-start"><span class="level-item">programming</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/security/"><span class="level-start"><span class="level-item">security</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/software/"><span class="level-start"><span class="level-item">software</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile" href="/categories/thinking/"><span class="level-start"><span class="level-item">thinking</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/thinking/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/tips/"><span class="level-start"><span class="level-item">tips</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/toLearn/"><span class="level-start"><span class="level-item">toLearn</span></span><span class="level-end"><span class="level-item tag">54</span></span></a></li><li><a class="level is-mobile" href="/categories/values/"><span class="level-start"><span class="level-item">values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://ibug.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ibugs</span></span><span class="level-right"><span class="level-item tag">ibug.io</span></span></a></li><li><a class="level is-mobile" href="https://jia.je/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">jiegec</span></span><span class="level-right"><span class="level-item tag">jia.je</span></span></a></li><li><a class="level is-mobile" href="https://leimao.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">leimao</span></span><span class="level-right"><span class="level-item tag">leimao.github.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-13T07:08:55.000Z">2024-09-13</time></p><p class="title"><a href="/2024/09/13/Work/software/PC/macbook/">Macbook Config</a></p><p class="categories"><a href="/categories/software/">software</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-13T00:47:35.000Z">2024-09-13</time></p><p class="title"><a href="/2024/09/13/Work/Programming/2-languageGrammar/c/Types/">[C++ Basic] Types</a></p><p class="categories"><a href="/categories/toLearn/">toLearn</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-12T14:41:50.000Z">2024-09-12</time></p><p class="title"><a href="/2024/09/12/Work/Programming/2-languageGrammar/c/Class/">[C++ Basic] User-Defined Types: Class</a></p><p class="categories"><a href="/categories/Programming/">Programming</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-12T14:17:34.000Z">2024-09-12</time></p><p class="title"><a href="/2024/09/12/Work/Programming/2-languageGrammar/c/cbuiltInFunctions/">[C++ Basic] Exploring Useful Built-in Functions</a></p><p class="categories"><a href="/categories/Programming/">Programming</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-12T12:36:28.000Z">2024-09-12</time></p><p class="title"><a href="/2024/09/12/Work/software/network/SwitchRouterCLIConfig/">Switch &amp; Router &amp; CLI Config</a></p><p class="categories"><a href="/categories/software/">software</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">September 2024</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">July 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">June 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">May 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">April 2024</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">March 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">January 2024</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">December 2023</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">November 2023</span></span><span class="level-end"><span class="level-item tag">33</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">October 2023</span></span><span class="level-end"><span class="level-item tag">56</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">September 2023</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/08/"><span class="level-start"><span class="level-item">August 2023</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">July 2023</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">June 2023</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">April 2023</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">March 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">January 2023</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">December 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">September 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/5G/"><span class="tag">5G</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/64bits-vs-32bits/"><span class="tag">64bits vs 32bits</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMAT/"><span class="tag">AMAT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMD/"><span class="tag">AMD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ASPLOS/"><span class="tag">ASPLOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ATI/"><span class="tag">ATI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AVX/"><span class="tag">AVX</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Alpha/"><span class="tag">Alpha</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Analysis/"><span class="tag">Analysis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apt/"><span class="tag">Apt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Assembly/"><span class="tag">Assembly</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BFS/"><span class="tag">BFS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BHive/"><span class="tag">BHive</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BT/"><span class="tag">BT</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BTL/"><span class="tag">BTL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Baka-Mitai/"><span class="tag">Baka Mitai</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bash/"><span class="tag">Bash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Big-Endian/"><span class="tag">Big-Endian</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a><p class="is-size-7"><span>&copy; 2024 Shaojie Tan</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>