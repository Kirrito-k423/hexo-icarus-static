<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>Category: Tutorials - SHAOJIE&#039;S BOOK</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="SHAOJIE&#039;S BOOK"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SHAOJIE&#039;S BOOK"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="SHAOJIE&#039;S BOOK"><meta property="og:url" content="http://icarus.shaojiemike.top/"><meta property="og:site_name" content="SHAOJIE&#039;S BOOK"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://icarus.shaojiemike.top/img/og_image.png"><meta property="article:author" content="Shaojie Tan"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://icarus.shaojiemike.top/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://icarus.shaojiemike.top"},"headline":"SHAOJIE'S BOOK","image":["http://icarus.shaojiemike.top/img/og_image.png"],"author":{"@type":"Person","name":"Shaojie Tan"},"publisher":{"@type":"Organization","name":"SHAOJIE'S BOOK","logo":{"@type":"ImageObject","url":"http://icarus.shaojiemike.top/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">Categories</a></li><li class="is-active"><a href="#" aria-current="page">Tutorials</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-29T16:00:00.000Z" title="3/29/2022, 4:00:00 PM">2022-03-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.381Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">8 minutes read (About 1152 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/29/Work/Programming/2.2-parallel/pythonMPI/">Python MPI</a></p><div class="content"><h2 id="å…¨å±€è§£é‡Šå™¨é”ï¼ˆGIL-Global-Interpreter-Lock"><a href="#å…¨å±€è§£é‡Šå™¨é”ï¼ˆGIL-Global-Interpreter-Lock" class="headerlink" title="å…¨å±€è§£é‡Šå™¨é”ï¼ˆGIL,Global Interpreter Lock)"></a>å…¨å±€è§£é‡Šå™¨é”ï¼ˆGIL,Global Interpreter Lock)</h2><p>Pythonä»£ç çš„æ‰§è¡Œç”±Pythonè™šæ‹Ÿæœºï¼ˆè§£é‡Šå™¨ï¼‰æ¥æ§åˆ¶ã€‚</p>
<p>å¯¹Pythonè™šæ‹Ÿæœºçš„è®¿é—®ç”±å…¨å±€è§£é‡Šå™¨é”ï¼ˆGILï¼‰æ¥æ§åˆ¶ï¼Œæ­£æ˜¯è¿™ä¸ªé”èƒ½ä¿è¯åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œã€‚æ‰€ä»¥å°±ä¼šå‡ºç°å°½ç®¡ä½ è®¾ç½®äº†å¤šçº¿ç¨‹çš„ä»»åŠ¡ï¼Œä½†æ˜¯åªèƒ½è·‘ä¸€ä¸ªçš„æƒ…å†µã€‚</p>
<p>ä½†æ˜¯I&#x2F;Oå¯†é›†çš„ç¨‹åº(çˆ¬è™«)ç›¸å¯¹å¥½ä¸€ç‚¹ï¼Œå› ä¸ºI&#x2F;Oæ“ä½œä¼šè°ƒç”¨å†…å»ºçš„æ“ä½œç³»ç»ŸCä»£ç ï¼Œæ‰€ä»¥è¿™æ—¶ä¼šé‡Šæ”¾GILé”ï¼Œè¾¾åˆ°éƒ¨åˆ†å¤šçº¿ç¨‹çš„æ•ˆæœã€‚</p>
<p>é€šå¸¸æˆ‘ä»¬ç”¨çš„è§£é‡Šå™¨æ˜¯å®˜æ–¹å®ç°çš„CPythonï¼Œè¦çœŸæ­£åˆ©ç”¨å¤šæ ¸ï¼Œé™¤éé‡å†™ä¸€ä¸ªä¸å¸¦GILçš„è§£é‡Šå™¨ã€‚</p>
<h2 id="Python-é¸¡è‚‹çš„å¤šçº¿ç¨‹"><a href="#Python-é¸¡è‚‹çš„å¤šçº¿ç¨‹" class="headerlink" title="Python é¸¡è‚‹çš„å¤šçº¿ç¨‹"></a>Python é¸¡è‚‹çš„å¤šçº¿ç¨‹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from threading import Thread</span><br></pre></td></tr></table></figure>
<h2 id="Python-å¤šè¿›ç¨‹æ­£å¸¸å®ç°"><a href="#Python-å¤šè¿›ç¨‹æ­£å¸¸å®ç°" class="headerlink" title="Python å¤šè¿›ç¨‹æ­£å¸¸å®ç°"></a>Python å¤šè¿›ç¨‹æ­£å¸¸å®ç°</h2><p>é€šè¿‡å¤šè¿›ç¨‹å®ç°å¤šæ ¸ä»»åŠ¡ã€‚å¤šä¸ªPythonè¿›ç¨‹æœ‰å„è‡ªç‹¬ç«‹çš„GILé”ï¼Œäº’ä¸å½±å“ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from multiprocessing import Process</span><br></pre></td></tr></table></figure>

<h3 id="å­è¿›ç¨‹è°ƒç”¨å®ä¾‹"><a href="#å­è¿›ç¨‹è°ƒç”¨å®ä¾‹" class="headerlink" title="å­è¿›ç¨‹è°ƒç”¨å®ä¾‹"></a>å­è¿›ç¨‹è°ƒç”¨å®ä¾‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">def TIMEOUT_COMMAND(command, timeout=10):</span><br><span class="line">    &quot;&quot;&quot;call shell-command and either return its output or kill it</span><br><span class="line">    if it doesn&#x27;t normally exit within timeout seconds and return None&quot;&quot;&quot;</span><br><span class="line">    import subprocess, datetime, os, time, signal</span><br><span class="line">    cmd = command.split(&quot; &quot;)</span><br><span class="line">    start = datetime.datetime.now()</span><br><span class="line">    process = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE,encoding=&quot;utf-8&quot;,preexec_fn=os.setsid) #è®© Popen æˆç«‹è‡ªå·±çš„è¿›ç¨‹ç»„</span><br><span class="line">    # https://www.cnblogs.com/gracefulb/p/6893166.html</span><br><span class="line">    # å› æ­¤åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå°±å¯ä»¥é€šè¿‡ preexec_fn å‚æ•°è®© Popen æˆç«‹è‡ªå·±çš„è¿›ç¨‹ç»„ï¼Œ ç„¶åå†å‘è¿›ç¨‹ç»„å‘é€ SIGTERM æˆ– SIGKILLï¼Œä¸­æ­¢ subprocess.Popen æ‰€å¯åŠ¨è¿›ç¨‹çš„å­å­å­™å­™ã€‚å½“ç„¶ï¼Œå‰ææ˜¯è¿™äº›å­å­å­™å­™ä¸­æ²¡æœ‰è¿›ç¨‹å†è°ƒç”¨ setsid åˆ†è£‚è‡ªç«‹é—¨æˆ·ã€‚</span><br><span class="line">    ic(&quot;BHive-noUseOSACA-before&quot;,process.pid,process.poll())</span><br><span class="line">    while process.poll() != 208: # poll()(å¥½åƒBHive208æ˜¯æ­£å¸¸ç»“æŸ)è¿”å›0 æ­£å¸¸ç»“æŸï¼Œ 1 sleepï¼Œ 2 å­è¿›ç¨‹ä¸å­˜åœ¨ï¼Œ-15 killï¼ŒNone åœ¨è¿è¡Œ</span><br><span class="line">        ic(&quot;BHive-noUseOSACA-During&quot;,process.pid,process.poll())</span><br><span class="line">        time.sleep(0.2)</span><br><span class="line">        now = datetime.datetime.now()</span><br><span class="line">        if (now - start).seconds&gt; timeout:</span><br><span class="line">            # BHiveæœ‰å­è¿›ç¨‹ï¼Œéœ€è¦æ€æ­»è¿›ç¨‹ç»„ã€‚ä½†æ˜¯éœ€è¦æ–°ç”Ÿæˆè¿›ç¨‹ç»„ï¼Œä¸ç„¶ä¼šæŠŠè‡ªå·±killæ‰</span><br><span class="line">            os.killpg(os.getpgid(process.pid), signal.SIGKILL)</span><br><span class="line">            # os.killpg(process.pid, signal.SIGTERM) SIGTERMä¸ä¸€å®šä¼škillï¼Œå¯èƒ½ä¼šè¢«å¿½ç•¥ï¼Œè¦çœ‹ä»£ç å®ç°</span><br><span class="line">            # https://blog.csdn.net/zhupenghui176/article/details/109097737</span><br><span class="line">            # os.waitpid(-1, os.WNOHANG)</span><br><span class="line">            (killPid,killSig) = os.waitpid(process.pid, 0)</span><br><span class="line">            if killPid != process.pid or killSig!=9:</span><br><span class="line">                errorPrint(&quot;TIMEOUT_COMMAND kill failed! killPid %d process.pid %d killSig %d&quot; % (killPid, process.pid, killSig))</span><br><span class="line">            ic(&quot;Killed&quot;,process.pid,process.poll())</span><br><span class="line">            return None</span><br><span class="line">    ic(&quot;BHive-noUseOSACA-Finished&quot;,process.pid,process.poll())</span><br><span class="line">    return process.stdout.readlines()</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨Queueæˆ–è€…Pipeé€šè®¯"><a href="#ä½¿ç”¨Queueæˆ–è€…Pipeé€šè®¯" class="headerlink" title="ä½¿ç”¨Queueæˆ–è€…Pipeé€šè®¯"></a>ä½¿ç”¨Queueæˆ–è€…Pipeé€šè®¯</h3><p><a target="_blank" rel="noopener" href="https://github.com/Kirrito-k423/BHive-Prediction-Compare/blob/main/pythonTest/0326_newBar_qcjiang.py">https://github.com/Kirrito-k423/BHive-Prediction-Compare/blob/main/pythonTest/0326_newBar_qcjiang.py</a></p>
<h2 id="å¤šæ ¸çš„è§£å†³æ–¹æ³•ï¼šè°ƒç”¨Cè¯­è¨€çš„é“¾æ¥åº“"><a href="#å¤šæ ¸çš„è§£å†³æ–¹æ³•ï¼šè°ƒç”¨Cè¯­è¨€çš„é“¾æ¥åº“" class="headerlink" title="å¤šæ ¸çš„è§£å†³æ–¹æ³•ï¼šè°ƒç”¨Cè¯­è¨€çš„é“¾æ¥åº“"></a>å¤šæ ¸çš„è§£å†³æ–¹æ³•ï¼šè°ƒç”¨Cè¯­è¨€çš„é“¾æ¥åº“</h2><p>æŠŠä¸€äº›è®¡ç®—å¯†é›†å‹ä»»åŠ¡ç”¨Cè¯­è¨€ç¼–å†™ï¼Œç„¶åæŠŠ.soé“¾æ¥åº“å†…å®¹åŠ è½½åˆ°Pythonä¸­ï¼Œå› ä¸ºæ‰§è¡ŒCä»£ç ï¼ŒGILé”ä¼šé‡Šæ”¾ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥åšåˆ°æ¯ä¸ªæ ¸éƒ½è·‘ä¸€ä¸ªçº¿ç¨‹çš„ç›®çš„ï¼</p>
<h2 id="è¿›ç¨‹æ± "><a href="#è¿›ç¨‹æ± " class="headerlink" title="è¿›ç¨‹æ± "></a>è¿›ç¨‹æ± </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from mpi4py import MPI</span><br></pre></td></tr></table></figure>

<h2 id="å­è¿›ç¨‹å®ä¾‹"><a href="#å­è¿›ç¨‹å®ä¾‹" class="headerlink" title="å­è¿›ç¨‹å®ä¾‹"></a>å­è¿›ç¨‹å®ä¾‹</h2><summary>pythonçš„å­ç¨‹åºå®ç°æœ‰é—®é¢˜ï¼Œè¿è¡Œä¸­ï¼Œä¼šæœ‰bhive-regé—ç•™ä¸‹æ¥ï¼ˆå¤šè¾¾20ä¸ªï¼Œéœ€è¦æŒ‰ç…§ä¸‹é¢æ‰‹åŠ¨killï¼Œè¿™ä¹Ÿæ˜¯æ ¸æ•°å»ºè®®ä¸ºæ€»æ ¸æ•°çš„1/3çš„åŸå› </summary>
<details>

<h3 id="check-process-create-time"><a href="#check-process-create-time" class="headerlink" title="check process create time"></a>check process create time</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps -eo pid,lstart,cmd |grep bhive</span><br><span class="line">date</span><br></pre></td></tr></table></figure>
<h3 id="kill-all-process-by-name"><a href="#kill-all-process-by-name" class="headerlink" title="kill all process by name"></a>kill all process by name</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ps -ef | grep &#x27;bhive-re&#x27; | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27; | sudo xargs -r kill -9</span><br></pre></td></tr></table></figure>

<h3 id="ä»¥ä¸ºçš„åŸå› "><a href="#ä»¥ä¸ºçš„åŸå› " class="headerlink" title="ä»¥ä¸ºçš„åŸå› "></a>ä»¥ä¸ºçš„åŸå› </h3><p>subProcess.pool è¿”å›ç¨‹åºçŠ¶æ€çš„æ—¶å€™ï¼Œé™¤äº†è¿è¡Œå’Œç»“æŸçŠ¶æ€ï¼Œè¿˜æœ‰ä¼‘çœ ç­‰å…¶ä»–çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯ç¨‹åºåœ¨å‘å°„ä¹‹åå¹¶ä¸æ˜¯ç›´æ¥è¿›å…¥è¿è¡ŒçŠ¶æ€çš„ã€‚åˆ¤æ–­ç¨‹åºæ˜¯å¦è¶…æ—¶ä¸èƒ½é€šè¿‡åˆ¤æ–­æ˜¯å¦è¿è¡Œï¼Œå› ä¸ºä¸€å¼€å§‹whileå¾ªç¯è¿›ä¸å»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">while process.poll() is None:</span><br></pre></td></tr></table></figure>
<p>è€Œåº”è¯¥æ˜¯åˆ¤æ–­æ˜¯å¦æ­£å¸¸ç»“æŸ(208æ˜¯BHiveç»“æŸè¿”å›å€¼ï¼Œä¸åŒç¨‹åºä¸åŒ)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">while process.poll() != 208:</span><br></pre></td></tr></table></figure>
<h3 id="ç»§ç»­åˆ†æ"><a href="#ç»§ç»­åˆ†æ" class="headerlink" title="ç»§ç»­åˆ†æ"></a>ç»§ç»­åˆ†æ</h3><p>å®é™…debugè¿˜æ˜¯æœ‰<br><img src="https://pic.shaojiemike.top/img/20220625173740.png"></p>
<p>åœ¨debugè¾“å‡ºé‡Œæ²¡æœ‰è¿™äº›pid</p>
<p>checkäº†ï¼Œè¾“å‡ºçš„ä¸ªæ•°æ˜¯ç¬¦åˆçš„ã€‚</p>
<p>ä¸æ‡‚äº†ï¼Œæˆ‘éƒ½æ²¡è°ƒç”¨ï¼Œè¿™åƒµå°¸è¿›ç¨‹å“ªé‡Œæ¥çš„ï¼Ÿé™¤éæ˜¯BHiveäº§ç”Ÿçš„ã€‚</p>
<h3 id="å®é™…åŸå› "><a href="#å®é™…åŸå› " class="headerlink" title="å®é™…åŸå› "></a>å®é™…åŸå› </h3><p>è°ƒç”¨çš„Bhiveä¼šäº§ç”Ÿå­è¿›ç¨‹ï¼ŒåŸæœ¬çš„pythonå®ç°ä¸èƒ½æ€æ­»å­è¿›ç¨‹çš„å­è¿›ç¨‹ã€‚éœ€è¦æ”¹ç”¨æ€æ­»è¿›ç¨‹ç»„çš„å®ç°</p>
<h3 id="æ€æ­»è¿›ç¨‹ç»„"><a href="#æ€æ­»è¿›ç¨‹ç»„" class="headerlink" title="æ€æ­»è¿›ç¨‹ç»„"></a>æ€æ­»è¿›ç¨‹ç»„</h3><p><img src="https://pic.shaojiemike.top/img/20220625185611.png"></p>
<p>å¯èƒ½è®¾å®šæ˜¯timeoutæ˜¯20ç§’ï¼Œä½†æ˜¯htopç¨‹åºè¿è¡Œäº†2åˆ†é’Ÿä¹Ÿæ²¡æœ‰killã€‚è¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºä¸»ç¨‹åºæŒ¤å èµ„æºå¯¼è‡´æŒ‚èµ·äº†ï¼Œå¯¼è‡´æ— æ³•åŠæ—¶åˆ¤æ–­å’Œkill</p>
</details>

<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p>æ— </p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-29T09:28:38.000Z" title="3/29/2022, 9:28:38 AM">2022-03-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.393Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">a minute read (About 183 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/29/Work/software/windows/windowsCommand/">Windows Command VS. Linux Command</a></p><div class="content"><h2 id="Windows-VS-linux"><a href="#Windows-VS-linux" class="headerlink" title="Windows VS linux"></a>Windows VS linux</h2><p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/linux-vs-windows-commands/">https://www.geeksforgeeks.org/linux-vs-windows-commands/</a></p>
<h2 id="Windows-Powershell"><a href="#Windows-Powershell" class="headerlink" title="Windows Powershell"></a>Windows Powershell</h2><h3 id="file-size"><a href="#file-size" class="headerlink" title="file size"></a>file size</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du -h --max-depth=1 #du - estimate file space usage</span><br></pre></td></tr></table></figure>
<h3 id="Powershell-file-size"><a href="#Powershell-file-size" class="headerlink" title="Powershell file size"></a>Powershell file size</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Function Format-FileSize() &#123;</span><br><span class="line">    Param ([int64]$size)</span><br><span class="line">    If     ($size -gt 1TB) &#123;[string]::Format(&quot;&#123;0:0.00&#125; TB&quot;, $size / 1TB)&#125;</span><br><span class="line">    ElseIf ($size -gt 1GB) &#123;[string]::Format(&quot;&#123;0:0.00&#125; GB&quot;, $size / 1GB)&#125;</span><br><span class="line">    ElseIf ($size -gt 1MB) &#123;[string]::Format(&quot;&#123;0:0.00&#125; MB&quot;, $size / 1MB)&#125;</span><br><span class="line">    ElseIf ($size -gt 1KB) &#123;[string]::Format(&quot;&#123;0:0.00&#125; kB&quot;, $size / 1KB)&#125;</span><br><span class="line">    ElseIf ($size -gt 0)   &#123;[string]::Format(&quot;&#123;0:0.00&#125; B&quot;, $size)&#125;</span><br><span class="line">    Else                   &#123;&quot;&quot;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Get-ChildItem | Select-Object Name, @&#123;Name=&quot;Size&quot;;Expression=&#123;Format-FileSize($_.Length)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><h3 id="zip-split-big-zip-file"><a href="#zip-split-big-zip-file" class="headerlink" title="zip split big zip file"></a>zip split big zip file</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zip -r -s 500m myfiles.zip compress_folder/</span><br><span class="line">split your-zip.zip -b 32M ZIPCHUNKS</span><br></pre></td></tr></table></figure>
<h3 id="combine-and-extract-zip-files"><a href="#combine-and-extract-zip-files" class="headerlink" title="combine and extract zip files"></a>combine and extract zip files</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">zip -F myfiles.zip --out single-archive.zip</span><br><span class="line">type * &gt; myZipFile.zip</span><br><span class="line">cat ZIPCHUNKS* &gt; reassembled-zip.zip</span><br><span class="line"></span><br><span class="line">unzip single-archive.zip</span><br></pre></td></tr></table></figure>

<h2 id="Linux-cheat-sheet"><a href="#Linux-cheat-sheet" class="headerlink" title="Linux cheat sheet"></a>Linux cheat sheet</h2><p><a target="_blank" rel="noopener" href="https://cheatography.com/davechild/cheat-sheets/linux-command-line/">https://cheatography.com/davechild/cheat-sheets/linux-command-line/</a></p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><div id='refer-anchor'></div>
æ— 

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-06T09:55:27.000Z" title="3/6/2022, 9:55:27 AM">2022-03-06</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.377Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">3 minutes read (About 447 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/06/Work/Programming/1-env/terminal/powershell/">Powershell</a></p><div class="content"><h2 id="Install-powershell-in-D-driver"><a href="#Install-powershell-in-D-driver" class="headerlink" title="Install powershell in D driver"></a>Install powershell in D driver</h2><p>å¦‚æœä½ éœ€è¦å°†PowerShell 7.2ä¸å…¶ä»–ç‰ˆæœ¬å¹¶æ’è¿è¡Œï¼Œè¯·ä½¿ç”¨ZIPå®‰è£…æ–¹æ³•å°†å…¶ä»–ç‰ˆæœ¬å®‰è£…åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹ã€‚</p>
<h2 id="â€œBashrcâ€é…ç½®æ–‡ä»¶-in-powershell"><a href="#â€œBashrcâ€é…ç½®æ–‡ä»¶-in-powershell" class="headerlink" title="â€œBashrcâ€é…ç½®æ–‡ä»¶ in powershell"></a>â€œBashrcâ€é…ç½®æ–‡ä»¶ in powershell</h2><p>å­˜æ”¾è·¯å¾„ä¸æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">E:/PowerShell via ï¢˜ v14.17.3 via ğŸ v3.9.7</span><br><span class="line">â¯ <span class="built_in">echo</span> <span class="variable">$PSHOME</span></span><br><span class="line">E:\commonSoftware\PowerShell7</span><br><span class="line"></span><br><span class="line">E:/PowerShell via ï¢˜ v14.17.3 via ğŸ v3.9.7</span><br><span class="line">â¯ <span class="built_in">echo</span> <span class="variable">$PROFILE</span></span><br><span class="line">D:\Documents\PowerShell\Microsoft.PowerShell_profile.ps1</span><br></pre></td></tr></table></figure>

<h3 id="Usefull-setting"><a href="#Usefull-setting" class="headerlink" title="Usefull setting"></a>Usefull setting</h3><figure class="highlight plaintext"><figcaption><span>title</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Import-Module DirColors</span><br><span class="line">Import-Module posh-git # å¼•å…¥ posh-git</span><br><span class="line">Import-Module oh-my-posh # å¼•å…¥ oh-my-posh</span><br><span class="line"></span><br><span class="line">#Set-Theme Paradox  è®¾ç½®ä¸»é¢˜ä¸º Paradox</span><br><span class="line"></span><br><span class="line">Set-PSReadLineOption -PredictionSource History # è®¾ç½®é¢„æµ‹æ–‡æœ¬æ¥æºä¸ºå†å²è®°å½•</span><br><span class="line"> </span><br><span class="line">Set-PSReadlineKeyHandler -Key Tab -Function Complete # è®¾ç½® Tab é”®è¡¥å…¨</span><br><span class="line">Set-PSReadLineKeyHandler -Key &quot;Ctrl+d&quot; -Function MenuComplete # è®¾ç½® Ctrl+d ä¸ºèœå•è¡¥å…¨å’Œ Intellisense</span><br><span class="line">Set-PSReadLineKeyHandler -Key &quot;Ctrl+z&quot; -Function Undo # è®¾ç½® Ctrl+z ä¸ºæ’¤é”€</span><br><span class="line">Set-PSReadLineKeyHandler -Key UpArrow -Function HistorySearchBackward # è®¾ç½®å‘ä¸Šé”®ä¸ºåå‘æœç´¢å†å²è®°å½•</span><br><span class="line">Set-PSReadLineKeyHandler -Key DownArrow -Function HistorySearchForward # è®¾ç½®å‘ä¸‹é”®ä¸ºå‰å‘æœç´¢å†å²çºªå½•</span><br><span class="line">Set-PSReadLineOption -Colors @&#123; InlinePrediction =  &#x27;#DF6C75&#x27;&#125;</span><br><span class="line"></span><br><span class="line">Invoke-Expression (&amp;starship init powershell)</span><br><span class="line">function Pro &#123;notepad $PROFILE&#125;</span><br><span class="line">function Get-CmdletAlias ($cmdletname) &#123;</span><br><span class="line">  Get-Alias |</span><br><span class="line">    Where-Object -FilterScript &#123;$_.Definition -like &quot;$cmdletname&quot;&#125; |</span><br><span class="line">      Format-Table -Property Definition, Name -AutoSize</span><br><span class="line">&#125;</span><br><span class="line">$env:TEMP=&quot;E:\Temp&quot;</span><br><span class="line">$env:TMP=&quot;E:\Temp&quot;</span><br><span class="line">Write-Host &quot;Hi Mike, welcome back!&quot;</span><br><span class="line">$HOMEDRIVE = &quot;E:&quot;</span><br><span class="line">$HOMEPATH = &quot;\PowerShell&quot;</span><br><span class="line">Remove-Variable -Force HOME</span><br><span class="line">#Set-Variable HOME &quot;E:\PowerShell&quot;</span><br><span class="line"># Set and force overwrite of the $HOME variable</span><br><span class="line">Set-Variable HOME &quot;$HOMEDRIVE$HOMEPATH&quot; -Force</span><br><span class="line"></span><br><span class="line"># Set the &quot;~&quot; shortcut value for the FileSystem provider</span><br><span class="line">(get-psprovider &#x27;FileSystem&#x27;).Home = $HOMEDRIVE + $HOMEPATH</span><br><span class="line">Set-location E:\PowerShell</span><br><span class="line"></span><br><span class="line">Function Format-FileSize() &#123;</span><br><span class="line">    Param ([int64]$size)</span><br><span class="line">    If     ($size -gt 1TB) &#123;[string]::Format(&quot;&#123;0:0.00&#125; TB&quot;, $size / 1TB)&#125;</span><br><span class="line">    ElseIf ($size -gt 1GB) &#123;[string]::Format(&quot;&#123;0:0.00&#125; GB&quot;, $size / 1GB)&#125;</span><br><span class="line">    ElseIf ($size -gt 1MB) &#123;[string]::Format(&quot;&#123;0:0.00&#125; MB&quot;, $size / 1MB)&#125;</span><br><span class="line">    ElseIf ($size -gt 1KB) &#123;[string]::Format(&quot;&#123;0:0.00&#125; kB&quot;, $size / 1KB)&#125;</span><br><span class="line">    ElseIf ($size -gt 0)   &#123;[string]::Format(&quot;&#123;0:0.00&#125; B&quot;, $size)&#125;</span><br><span class="line">    Else                   &#123;&quot;&quot;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><ul>
<li>æŸ¥çœ‹ï¼šè¿è¡Œ<code>dir env:</code>æ˜¾ç¤º</li>
<li>ä¿®æ”¹ï¼š<code>$env:TMP=&quot;D:\Temp&quot;</code></li>
</ul>
<h3 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$env</span>:http_proxy = <span class="string">&quot;http://127.0.0.1:7890&quot;</span></span><br><span class="line"><span class="variable">$env</span>:https_proxy = <span class="string">&quot;http://127.0.0.1:7890&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="PATH"><a href="#PATH" class="headerlink" title="PATH"></a>PATH</h3><p><code>echo $env:PATH| tr &quot;;&quot; &quot;\n&quot;| sort</code></p>
<h3 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h3><p>Win32-OpenSSH they go to <code>%USERPROFILE%\.ssh.</code> That typically is: <code>C:\Users\username\.ssh</code></p>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p>[^1] <a target="_blank" rel="noopener" href="https://shaojiemike.notion.site/powershell-a911ddbfca564b0f91dbe141d9169259">notion tips</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-02-22T10:35:16.000Z" title="2/22/2022, 10:35:16 AM">2022-02-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.389Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">7 minutes read (About 995 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/22/Work/software/manager/pip/">Pip</a></p><div class="content"><h2 id="å‘å¸ƒè‡ªå·±çš„pipåŒ…"><a href="#å‘å¸ƒè‡ªå·±çš„pipåŒ…" class="headerlink" title="å‘å¸ƒè‡ªå·±çš„pipåŒ…"></a>å‘å¸ƒè‡ªå·±çš„pipåŒ…</h2><p>ä¸€ã€æ³¨å†Œè‡ªå·±çš„ PyPi å¸å·</p>
<p>ä¹Ÿå¯ä»¥æ˜¯è‡ªå·±æ­çš„ PyPiç§æœä»“åº“çš„è´¦å·</p>
<p>äºŒã€ä¾æ®è‡ªå·±çš„é¡¹ç›®ç›®å½•ï¼Œåˆ›å»ºsetup.py</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œagent_cliæ˜¯æˆ‘æ•´ä½“çš„é¡¹ç›®ï¼Œæˆ‘æƒ³è¦å°†pip-testç›®å½•ä¸‹çš„ä»£ç æ‰“åŒ…ä¸Šä¼ åˆ°Pypiä»“åº“ä¸­ï¼›</p>
<p>åœ¨pip-testçš„åŒçº§ç›®å½•ï¼Œåˆ›å»ºsetup.pyæ–‡ä»¶</p>
<p><img src="https://img2020.cnblogs.com/blog/1745584/202007/1745584-20200715180532904-686172821.png"></p>
<p>ä¸‰ã€ ç¼–å†™è‡ªå·±çš„setup.pyæ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> setup, find_packages</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    name=<span class="string">&#x27;tsjPython&#x27;</span>,  <span class="comment"># æ‰“åŒ…åçš„åŒ…æ–‡ä»¶å</span></span><br><span class="line">    version=<span class="string">&#x27;0.1&#x27;</span>,  <span class="comment"># ç‰ˆæœ¬å·</span></span><br><span class="line">    keywords=(<span class="string">&quot;tsj&quot;</span>),    <span class="comment"># å…³é”®å­—</span></span><br><span class="line">    description=<span class="string">&#x27;personal code for tsj&#x27;</span>,  <span class="comment"># è¯´æ˜</span></span><br><span class="line">    long_description=<span class="string">&quot;none&quot;</span>,  <span class="comment"># è¯¦ç»†è¯´æ˜</span></span><br><span class="line">    license=<span class="string">&quot;MIT Licence&quot;</span>,  <span class="comment"># è®¸å¯</span></span><br><span class="line">    url=<span class="string">&#x27;http://home.ustc.edu.cn/~shaojiemike&#x27;</span>,</span><br><span class="line">    author=<span class="string">&#x27;Shaojie Tan&#x27;</span>,</span><br><span class="line">    author_email=<span class="string">&#x27;shaojiemike@mail.ustc.edu.cn&#x27;</span>,</span><br><span class="line">    <span class="comment"># packages=find_packages(),     #è¿™ä¸ªå‚æ•°æ˜¯å¯¼å…¥ç›®å½•ä¸‹çš„æ‰€æœ‰__init__.pyåŒ…</span></span><br><span class="line">    include_package_data=<span class="literal">True</span>,</span><br><span class="line">    platforms=<span class="string">&quot;any&quot;</span>,</span><br><span class="line">    install_requires=[<span class="string">&#x27;termcolor&#x27;</span>,</span><br><span class="line">                      <span class="string">&#x27;plotille&#x27;</span>],    <span class="comment"># å¼•ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹åº“</span></span><br><span class="line">    <span class="comment"># py_modules=[&#x27;pip-test.DoRequest&#x27;, &#x27;pip-test.GetParams&#x27;, &#x27;pip-test.ServiceRequest&#x27;,</span></span><br><span class="line">    <span class="comment">#             &#x27;pip-test.ts.constants&#x27;, &#x27;pip-test.ac.Agent2C&#x27;,</span></span><br><span class="line">    <span class="comment">#             &#x27;pip-test.ts.ttypes&#x27;, &#x27;pip-test.ac.constants&#x27;,</span></span><br><span class="line">    <span class="comment">#             &#x27;pip-test.__init__&#x27;],  # ä½ è¦æ‰“åŒ…çš„æ–‡ä»¶ï¼Œè¿™é‡Œç”¨ä¸‹é¢è¿™ä¸ªå‚æ•°ä»£æ›¿</span></span><br><span class="line">    packages=[<span class="string">&#x27;tsjPython&#x27;</span>]  <span class="comment"># è¿™ä¸ªå‚æ•°æ˜¯å¯¼å…¥ç›®å½•ä¸‹çš„æ‰€æœ‰__init__.pyåŒ…</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å››ã€æ‰“åŒ…è‡ªå·±çš„é¡¹ç›®</p>
<p>æ‰§è¡Œä¸‹è¿°ä¸¤æ¡å‘½ä»¤</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python setup.py build  ã€€ã€€<span class="comment">#æ‰§è¡Œæ­¤å‘½ä»¤åï¼Œä¼šç”Ÿæˆä¸Šé¢å›¾ç‰‡ä¸­buildçš„ç›®å½•ï¼Œç›®å½•å±‚çº§æ˜¯  build/lib/pip-test,  pip-testç›®å½•ä¸‹å°±æ˜¯ä½ æ‰“åŒ…æ–‡ä»¶è§£å‹åçš„ç»“æœï¼Œå¯ä»¥åœ¨æ­¤æŸ¥çœ‹æ‰“åŒ…çš„ä»£ç æ˜¯å¦å®Œæ•´</span></span><br><span class="line"></span><br><span class="line">python setup.py sdistã€€ã€€  <span class="comment"># æ‰§è¡Œæ­¤å‘½ä»¤åï¼Œå°±ä¼šåœ¨distç›®å½•ä¸‹ç”Ÿæˆå‹ç¼©åŒ…æ–‡ä»¶ .tar.gz</span></span><br></pre></td></tr></table></figure>

<p>äº”ã€ä¸Šä¼ åˆ°PyPiæœåŠ¡å™¨</p>
<p>åœ¨ä¸Šä¼ å‰ï¼Œè¦å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œ<code>$HOME/.pypirc</code>ï¼Œ<code>$HOME</code>ç›®å½•åœ¨linuxæˆ–è€…macç³»ç»Ÿä¸‹å°±æ˜¯~&#x2F;ç›®å½•ã€‚åœ¨è¿™é‡Œå»ºä¸€ä¸ª <code>.pypirc</code>æ–‡ä»¶ã€‚é‡Œè¾¹çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[distutils]</span><br><span class="line">index-servers = pypi</span><br><span class="line"> </span><br><span class="line">[pypi]</span><br><span class="line">username:ä½ çš„PyPiç”¨æˆ·å</span><br><span class="line">password:ä½ çš„PyPiå¯†ç </span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä½¿ç”¨token.</p>
<p>æ³¨å†Œå¥½ä¹‹åï¼Œç”Ÿæˆä¸€ä¸ª tokenï¼š<a target="_blank" rel="noopener" href="https://pypi.org/manage/account/#api-tokens%E3%80%82%E7%94%B1%E4%BA%8E%E6%88%91%E4%BB%AC%E6%98%AF%E8%A6%81%E4%B8%8A%E4%BC%A0%E6%96%B0%E9%A1%B9%E7%9B%AE%EF%BC%8C%E6%89%80%E4%BB%A5%E4%B8%8D%E8%A6%81%E9%99%90%E5%88%B6">https://pypi.org/manage/account/#api-tokensã€‚ç”±äºæˆ‘ä»¬æ˜¯è¦ä¸Šä¼ æ–°é¡¹ç›®ï¼Œæ‰€ä»¥ä¸è¦é™åˆ¶</a> scope åˆ°ç‰¹å®šçš„é¡¹ç›®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[pypi]</span><br><span class="line">username = __token__</span><br><span class="line">password = &lt;æ¢æˆä½ åˆšåˆšå¤åˆ¶ä¸‹æ¥çš„ token, åŒ…æ‹¬ `pypi-` å‰ç¼€&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æå‰å®‰è£… <code>py -m pip install --upgrade twine</code></p>
<p>æ‰§è¡Œæ­¤å‘½ä»¤ï¼š <code>twine upload dist/XXXXX-0.1.0.tar.gz</code>   ä¸Šä¼ ä½ åˆšåˆšæ‰“åŒ…å¥½çš„å‹ç¼©åŒ…</p>
<p>å…­ã€å®‰è£…ä½¿ç”¨</p>
<p>ä½¿ç”¨ <code>pip install XXX</code>   å°±å¯ä»¥è½»æ¾ä½¿ç”¨</p>
<h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requests.exceptions.ProxyError: HTTPSConnectionPool(host=&#x27;upload.pypi.org&#x27;, port=443): Max retries exceeded with url: /legacy/ (Caused by ProxyError(&#x27;Cannot connect to proxy.&#x27;, OSError(0, &#x27;Error&#x27;)))</span><br></pre></td></tr></table></figure>

<p>ä¸è¦æŒ‚ä»£ç†</p>
<h3 id="å¼€å‘æµ‹è¯•åŒ…"><a href="#å¼€å‘æµ‹è¯•åŒ…" class="headerlink" title="å¼€å‘æµ‹è¯•åŒ…"></a>å¼€å‘æµ‹è¯•åŒ…</h3><p>å¦‚æœä¸ºäº†æµ‹è¯•è€Œä¸Šä¼ ä»£ç ï¼Œä¼šå ç”¨ç‰ˆå·ã€‚</p>
<p>å¯ä»¥é€šè¿‡å…ˆå®‰è£…åœ¨æœ¬åœ°æ¥å®ç°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install packageName</span><br><span class="line">pip uninstall packageName</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ setup.py å®‰è£…çš„åŒ…ä¼šè¢«å¤åˆ¶åˆ°å½“å‰ç¯å¢ƒçš„ site-packages ç›®å½•ä¸‹ï¼Œè¿™æ„å‘³ç€ï¼Œä¸€æ—¦æˆ‘ä»¬ä¿®æ”¹äº†åŒ…çš„æºä»£ç ï¼Œå°±éœ€è¦é‡æ–°å®‰è£…å®ƒã€‚</p>
<p>è¿™å¸¸å¸¸æ˜¯é›†ä¸­å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå¾ˆå®¹æ˜“å¿˜è®°éœ€è¦å†æ¬¡æ‰§è¡Œå®‰è£…ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ setuptools æä¾›äº†ä¸€ä¸ªé¢å¤–çš„ develop å‘½ä»¤çš„é‡è¦åŸå› ã€‚</p>
<p><code>develop</code> å‘½ä»¤çš„å®Œæ•´æ ¼å¼ä¸º<code>Python setup.py develop</code>ï¼Œè¯¥å‘½ä»¤å…è®¸æˆ‘ä»¬åœ¨å¼€å‘æ¨¡å¼ä¸‹å®‰è£…åŒ…ï¼Œå®ƒä¼šåœ¨éƒ¨ç½²ç›®å½•ï¼ˆsite-packagesï¼‰æ—¶åˆ›å»ºä¸€ä¸ªæŒ‡å‘é¡¹ç›®æºä»£ç çš„ç‰¹æ®Šé“¾æ¥ï¼Œè€Œä¸æ˜¯å°†æ•´ä¸ªåŒ…å¤åˆ¶è¿‡å»ï¼Œä»è€Œå®ç°<strong>åœ¨ç¼–è¾‘åŒ…çš„æºä»£ç ä¹‹åæ— éœ€å†é‡æ–°å®‰è£…</strong>ï¼Œå¹¶ä¸”å®ƒåœ¨ <code>sys.path</code> ä¸­å¯ç”¨ï¼Œå°±åƒæ­£å¸¸å®‰è£…ä¸€æ ·ã€‚</p>
<p>pip ä¹Ÿæ”¯æŒç”¨è¿™ç§æ¨¡å¼æ¥å®‰è£…åŒ…ï¼Œè¿™ä¸ªå®‰è£…é€‰é¡¹å«ä½œå¯ç¼–è¾‘æ¨¡å¼ï¼Œå¯ä»¥ä½¿ç”¨ install å‘½ä»¤çš„ -<code>e</code> å‚æ•°æ¥å¯ç”¨ï¼Œä»£ç æ ¼å¼å¦‚ä¸‹ï¼š<br><code>pip install -e åŒ…è·¯å¾„</code></p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><div id='refer-anchor'>https://www.cnblogs.com/weisunblog/p/13307174.html</div>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-07T16:00:00.000Z" title="1/7/2022, 4:00:00 PM">2022-01-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.373Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">11 minutes read (About 1698 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/07/Work/HPC/MPI_OMP/openmp/">OpenMP</a></p><div class="content"><h2 id="çº¿ç¨‹ç»‘å®š"><a href="#çº¿ç¨‹ç»‘å®š" class="headerlink" title="çº¿ç¨‹ç»‘å®š"></a>çº¿ç¨‹ç»‘å®š</h2><p>OpenMP 4.0 æä¾› <code>OMP_PLACES</code> å’Œ <code>OMP_PROC_BIND</code> ç¯å¢ƒå˜é‡æ¥æŒ‡å®šç¨‹åºä¸­çš„ OpenMP çº¿ç¨‹å¦‚ä½•ç»‘å®šåˆ°å¤„ç†å™¨ã€‚è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡é€šå¸¸ç»“åˆä½¿ç”¨ã€‚<code>OMP_PLACES</code> ç”¨äºæŒ‡å®šçº¿ç¨‹å°†ç»‘å®šåˆ°çš„è®¡ç®—æœºä½ç½®ï¼ˆç¡¬ä»¶çº¿ç¨‹ã€æ ¸å¿ƒæˆ–æ’æ§½ï¼‰ã€‚<code>OMP_PROC_BIND</code> ç”¨äºæŒ‡å®šç»‘å®šç­–ç•¥ï¼ˆçº¿ç¨‹å…³è”æ€§ç­–ç•¥ï¼‰ï¼Œè¿™é¡¹ç­–ç•¥æŒ‡å®šå¦‚ä½•å°†çº¿ç¨‹åˆ†é…åˆ°ä½ç½®ã€‚</p>
<p>é™¤äº† <code>OMP_PLACES</code> å’Œ <code>OMP_PROC_BIND</code> è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡å¤–ï¼ŒOpenMP 4.0 è¿˜æä¾›å¯åœ¨ parallel æŒ‡ä»¤ä¸­ä½¿ç”¨çš„ <code>proc_bind</code> å­å¥ã€‚<code>proc_bind</code> å­å¥ç”¨äºæŒ‡å®šå¦‚ä½•å°†æ‰§è¡Œå¹¶è¡ŒåŒºåŸŸçš„çº¿ç¨‹ç»„ç»‘å®šåˆ°å¤„ç†å™¨ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://lab.cs.tsinghua.edu.cn/hpc/doc/faq/binding/">SlURM MPI OpenMPç»‘å®šæ–¹æ³•å‚è€ƒæ¸…åçš„æ–‡æ¡£</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">OMP_NUM_THREADS=28 OMP_PROC_BIND=true OMP_PLACES=coresï¼šæ¯ä¸ªçº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ª coreï¼Œä½¿ç”¨é»˜è®¤çš„åˆ†å¸ƒï¼ˆçº¿ç¨‹ n ç»‘å®šåˆ° core nï¼‰ï¼›</span><br><span class="line">OMP_NUM_THREADS=2 OMP_PROC_BIND=true OMP_PLACES=socketsï¼šæ¯ä¸ªçº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ª socketï¼›</span><br><span class="line">OMP_NUM_THREADS=4 OMP_PROC_BIND=close OMP_PLACES=coresï¼šæ¯ä¸ªçº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ª coreï¼Œçº¿ç¨‹åœ¨ socket ä¸Šè¿ç»­åˆ†å¸ƒï¼ˆåˆ†åˆ«ç»‘å®šåˆ° core 0,1,2,3ï¼›</span><br><span class="line">OMP_NUM_THREADS=4 OMP_PROC_BIND=spread OMP_PLACES=coresï¼šæ¯ä¸ªçº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ª coreï¼Œçº¿ç¨‹åœ¨ socket ä¸Šå°½é‡æ•£å¼€åˆ†å¸ƒï¼ˆåˆ†åˆ«ç»‘å®šåˆ° core 0,7,14,21ï¼›</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lscpuç»“åˆhtopè§‚å¯Ÿ</span><br><span class="line">NUMA èŠ‚ç‚¹0 CPUï¼š                 0-15,32-47              </span><br><span class="line">NUMA èŠ‚ç‚¹1 CPUï¼š                 16-31,48-63</span><br></pre></td></tr></table></figure>
<h2 id="ç¼–è¯‘åˆ¶å¯¼æ ¼å¼"><a href="#ç¼–è¯‘åˆ¶å¯¼æ ¼å¼" class="headerlink" title="ç¼–è¯‘åˆ¶å¯¼æ ¼å¼"></a>ç¼–è¯‘åˆ¶å¯¼æ ¼å¼</h2><p><img src="https://pic.shaojiemike.top/img/20220108091250.png"></p>
<p>é™æ€æ‰©å±•</p>
<ul>
<li>æ–‡æœ¬ä»£ç åœ¨ä¸€ä¸ªç¼–è¯‘åˆ¶å¯¼è¯­å¥ä¹‹åï¼Œè¢«å°è£…åˆ°ä¸€ä¸ªç»“æ„å—ä¸­</li>
</ul>
<p>å­¤ç«‹è¯­å¥</p>
<ul>
<li>ä¸€ä¸ªOpenMPçš„ç¼–è¯‘åˆ¶å¯¼è¯­å¥<strong>ä¸ä¾èµ–</strong>äºå…¶å®ƒçš„è¯­å¥</li>
</ul>
<h3 id="parallel"><a href="#parallel" class="headerlink" title="parallel"></a>parallel</h3><p>å¹¶è¡ŒåŸŸä¸­çš„ä»£ç è¢«æ‰€æœ‰çš„çº¿ç¨‹æ‰§è¡Œ<br><img src="https://pic.shaojiemike.top/img/20220108091641.png"></p>
<h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><p>forè¯­å¥æŒ‡å®šç´§éšå®ƒçš„å¾ªç¯è¯­å¥å¿…é¡»ç”±çº¿ç¨‹ç»„å¹¶è¡Œæ‰§è¡Œï¼›</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092147.png"></p>
<h3 id="sections"><a href="#sections" class="headerlink" title="sections"></a>sections</h3><p>sectionsç¼–è¯‘åˆ¶å¯¼è¯­å¥æŒ‡å®šå†…éƒ¨çš„ä»£ç è¢«åˆ’åˆ†ç»™çº¿ç¨‹ç»„ä¸­çš„å„çº¿ç¨‹</p>
<p>ä¸åŒçš„sectionç”±ä¸åŒçš„çº¿ç¨‹æ‰§è¡Œ</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092508.png"><br><img src="https://pic.shaojiemike.top/img/20220108092557.png"></p>
<h3 id="single"><a href="#single" class="headerlink" title="single"></a>single</h3><p>singleç¼–è¯‘åˆ¶å¯¼è¯­å¥æŒ‡å®šå†…éƒ¨ä»£ç åªæœ‰çº¿ç¨‹ç»„ä¸­çš„ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p>
<p>çº¿ç¨‹ç»„ä¸­æ²¡æœ‰æ‰§è¡Œsingleè¯­å¥çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ä»£ç å—çš„ç»“æŸï¼Œä½¿ç”¨nowaitå­å¥é™¤å¤–</p>
<p><img src="https://pic.shaojiemike.top/img/20220108092830.png"></p>
<p><img src="https://pic.shaojiemike.top/img/20220917130916.png"></p>
<p>æ¥è‡ª <a target="_blank" rel="noopener" href="https://ppc.cs.aalto.fi/ch3/nowait/">https://ppc.cs.aalto.fi/ch3/nowait/</a></p>
<h3 id="ç»„åˆparallel-for-parallel-sections-ç¼–è¯‘åˆ¶å¯¼è¯­å¥"><a href="#ç»„åˆparallel-for-parallel-sections-ç¼–è¯‘åˆ¶å¯¼è¯­å¥" class="headerlink" title="ç»„åˆparallel for &#x2F; parallel sections ç¼–è¯‘åˆ¶å¯¼è¯­å¥"></a>ç»„åˆparallel for &#x2F; parallel sections ç¼–è¯‘åˆ¶å¯¼è¯­å¥</h3><ol>
<li>Parallel forç¼–è¯‘åˆ¶å¯¼è¯­å¥è¡¨æ˜ä¸€ä¸ªå¹¶è¡ŒåŸŸåŒ…å«ä¸€ä¸ªç‹¬ç«‹çš„forè¯­å¥</li>
<li>parallel sectionsç¼–è¯‘åˆ¶å¯¼è¯­å¥è¡¨æ˜ä¸€ä¸ªå¹¶è¡ŒåŸŸåŒ…å«å•ç‹¬çš„ä¸€ä¸ªsectionsè¯­å¥</li>
</ol>
<h3 id="åŒæ­¥ç»“æ„"><a href="#åŒæ­¥ç»“æ„" class="headerlink" title="åŒæ­¥ç»“æ„"></a>åŒæ­¥ç»“æ„</h3><ol>
<li>master åˆ¶å¯¼è¯­å¥<ol>
<li>æŒ‡å®šä»£ç æ®µåªæœ‰ä¸»çº¿ç¨‹æ‰§è¡Œ</li>
</ol>
</li>
<li>criticalåˆ¶å¯¼è¯­å¥<ol>
<li>criticalåˆ¶å¯¼è¯­å¥è¡¨æ˜åŸŸä¸­çš„ä»£ç ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹è¢«é˜»å¡åœ¨ä¸´ç•ŒåŒº</li>
<li>è¯­å¥æ ¼å¼ï¼š<code>#pragma omp critical [name] newline</code></li>
</ol>
</li>
<li>barrieråˆ¶å¯¼è¯­å¥<ol>
<li>åŒæ­¥ä¸€ä¸ªçº¿ç¨‹ç»„ä¸­æ‰€æœ‰çš„çº¿ç¨‹,å…ˆåˆ°è¾¾çš„çº¿ç¨‹åœ¨æ­¤é˜»å¡ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹</li>
</ol>
</li>
<li>atomicåˆ¶å¯¼è¯­å¥<ol>
<li>æŒ‡å®šç‰¹å®šçš„å­˜å‚¨å•å…ƒå°†è¢«åŸå­æ›´æ–°</li>
<li><pre><code>#pragma omp atomic
x++;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">5. flushåˆ¶å¯¼è¯­å¥</span><br><span class="line">   1. æ ‡è¯†ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œç”¨ä»¥ç¡®ä¿æ‰€æœ‰çš„çº¿ç¨‹çœ‹åˆ°ä¸€è‡´çš„å­˜å‚¨å™¨è§†å›¾</span><br><span class="line">   2. ![](https://pic.shaojiemike.top/img/20220108093740.png)</span><br><span class="line">6. orderedåˆ¶å¯¼è¯­å¥</span><br><span class="line">   1. ç›¸å¯¹äºcriticalï¼Œå¤šäº†ä¸€ä¸ªé¡ºåº</span><br><span class="line">   2. åªèƒ½å‡ºç°åœ¨foræˆ–è€…parallel forè¯­å¥çš„åŠ¨æ€èŒƒå›´ä¸­</span><br><span class="line">7. threadprivateè¯­å¥ä½¿ä¸€ä¸ªå…¨å±€æ–‡ä»¶ä½œç”¨åŸŸçš„å˜é‡åœ¨å¹¶è¡ŒåŸŸå†…å˜æˆæ¯ä¸ªçº¿ç¨‹ç§æœ‰</span><br><span class="line">   1. æ¯ä¸ªçº¿ç¨‹å¯¹è¯¥å˜é‡å¤åˆ¶ä¸€ä»½ç§æœ‰æ‹·è´</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### critical vs atomic</span><br><span class="line">The fastest way is neither critical nor atomic. Approximately, addition with critical section is 200 times more expensive than simple addition, atomic addition is 25 times more expensive then simple addition.(**maybe no so much expensive**, the atomic operation will have a few cycle overhead (synchronizing a cache line) on the cost of roughly a cycle. A critical section incurs **the cost of a lock**.)</span><br><span class="line"></span><br><span class="line">The fastest option (not always applicable) is to give each thread its own counter and make reduce operation when you need total sum.</span><br><span class="line"></span><br><span class="line">### critical vs ordered</span><br><span class="line">omp critical is for mutual exclusion(äº’æ–¥), omp ordered refers to a specific loop and ensures that the region **executes sequentually in the order of loop iterations**. Therefore omp ordered is stronger than omp critical, but also only makes sense within a loop.</span><br><span class="line"></span><br><span class="line">omp ordered has some other clauses, such as simd to enforce the use of a single SIMD lane only. You can also specify dependencies manually with the depend clause.</span><br><span class="line"></span><br><span class="line">Note: Both omp critical and omp ordered regions have an implicit memory flush at the entry and the exit.</span><br><span class="line"></span><br><span class="line">### ordered example</span><br></pre></td></tr></table></figure>
vector&lt;int&gt; v;
</code></pre>
</li>
</ol>
</li>
</ol>
<p>#pragma omp parallel for ordered schedule(dynamic, anyChunkSizeGreaterThan1)<br>    for (int i &#x3D; 0; i &lt; n; ++i){<br>            â€¦<br>            â€¦<br>            â€¦<br>#pragma omp ordered<br>            v.push_back(i);<br>    }</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">tid  List of     Timeline</span><br><span class="line">     iterations</span><br><span class="line">0    0,1,2       ==o==o==o</span><br><span class="line">1    3,4,5       ==.......o==o==o</span><br><span class="line">2    6,7,8       ==..............o==o==o</span><br></pre></td></tr></table></figure>

<p><code>=</code> shows that the thread is executing code in parallel. <code>o</code> is when the thread is executing the ordered region. <code>.</code> is the thread being idle, waiting for its turn to execute the ordered region. </p>
<p>With <code>schedule(static,1)</code> the following would happen:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tid  List of     Timeline</span><br><span class="line">     iterations</span><br><span class="line">0    0,3,6       ==o==o==o</span><br><span class="line">1    1,4,7       ==.o==o==o</span><br><span class="line">2    2,5,8       ==..o==o==o</span><br></pre></td></tr></table></figure>

<h3 id="è¯­å¥ç»‘å®šä¸è¯­å¥åµŒå¥—è§„åˆ™"><a href="#è¯­å¥ç»‘å®šä¸è¯­å¥åµŒå¥—è§„åˆ™" class="headerlink" title="è¯­å¥ç»‘å®šä¸è¯­å¥åµŒå¥—è§„åˆ™"></a>è¯­å¥ç»‘å®šä¸è¯­å¥åµŒå¥—è§„åˆ™</h3><p><img src="https://pic.shaojiemike.top/img/20220108162521.png"><br><img src="https://pic.shaojiemike.top/img/20220108162536.png"></p>
<h2 id="Clauses-å­å¥"><a href="#Clauses-å­å¥" class="headerlink" title="Clauses å­å¥"></a>Clauses å­å¥</h2><p>è§ <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160">https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160</a><br><img src="https://pic.shaojiemike.top/img/20220108162156.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#pragma omp parallel for collapse(2)</span><br><span class="line">for( int y = y1; y &lt; y2; y++ )</span><br><span class="line">&#123;</span><br><span class="line">	for( int x = x1; x &lt; x2; x++ )</span><br><span class="line">	&#123;</span><br></pre></td></tr></table></figure>
<h3 id="schedule"><a href="#schedule" class="headerlink" title="schedule"></a>schedule</h3><p><img src="https://pic.shaojiemike.top/img/20220108101831.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">------------------------------------------------</span><br><span class="line">| static | static | dynamic | dynamic | guided |</span><br><span class="line">|    1   |    5   |    1    |    5    |        |</span><br><span class="line">------------------------------------------------</span><br><span class="line">|    0   |    0   |    0    |    2    |    1   |</span><br><span class="line">|    1   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    2   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    3   |    0   |    3    |    2    |    1   |</span><br><span class="line">|    0   |    0   |    2    |    2    |    1   |</span><br><span class="line">|    1   |    1   |    2    |    3    |    3   |</span><br><span class="line">|    2   |    1   |    2    |    3    |    3   |</span><br><span class="line">|    3   |    1   |    0    |    3    |    3   |</span><br><span class="line">|    0   |    1   |    0    |    3    |    3   |</span><br><span class="line">|    1   |    1   |    0    |    3    |    2   |</span><br><span class="line">|    2   |    2   |    1    |    0    |    2   |</span><br><span class="line">|    3   |    2   |    1    |    0    |    2   |</span><br><span class="line">|    0   |    2   |    1    |    0    |    3   |</span><br><span class="line">|    1   |    2   |    2    |    0    |    3   |</span><br><span class="line">|    2   |    2   |    2    |    0    |    0   |</span><br><span class="line">|    3   |    3   |    2    |    1    |    0   |</span><br><span class="line">|    0   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    1   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    2   |    3   |    3    |    1    |    1   |</span><br><span class="line">|    3   |    3   |    0    |    1    |    3   |</span><br><span class="line">------------------------------------------------</span><br></pre></td></tr></table></figure>
<h3 id="private-vs-firstprivate-vs-lastprivate"><a href="#private-vs-firstprivate-vs-lastprivate" class="headerlink" title="private vs firstprivate vs lastprivate"></a>private vs firstprivate vs lastprivate</h3><p> <code>private</code> variables are not initialised, i.e. they start with random values like any other local automatic variable</p>
<p> <code>firstprivate</code> initial the value as the before value.</p>
<p> <code>lastprivate</code> save the value to the after region. è¿™ä¸ªlastçš„æ„æ€ä¸æ˜¯å®é™…æœ€åè¿è¡Œçš„ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œæ˜¯è°ƒåº¦å‘å°„é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªçº¿ç¨‹ã€‚ä»å¦ä¸€ä¸ªè§’åº¦ä¸Šè¯´ï¼Œå¦‚æœä½ ä¿å­˜çš„å€¼æ¥è‡ªéšæœºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¹Ÿæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚<br> firstprivate and lastprivate are just <strong>special cases</strong> of private</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#pragma omp parallel</span><br><span class="line">&#123;</span><br><span class="line">   #pragma omp for lastprivate(i)</span><br><span class="line">      for (i=0; i&lt;n-1; i++)</span><br><span class="line">         a[i] = b[i] + b[i+1];</span><br><span class="line">&#125;</span><br><span class="line">a[i]=b[i];</span><br></pre></td></tr></table></figure>
<h3 id="private-vs-threadprivate"><a href="#private-vs-threadprivate" class="headerlink" title="private vs threadprivate"></a>private vs threadprivate</h3><p><img src="https://pic.shaojiemike.top/img/20220108100045.png"></p>
<p>A <code>private</code> variable is local to a region and will most of the time be placed on the <code>stack</code>. The lifetime of the variableâ€™s privacy is <code>the duration defined of the data scoping clause</code>. Every thread (including the master thread) makes a private <code>copy of the original variable</code> (the new variable is no longer storage-associated with the original variable).</p>
<p>A <code>threadprivate</code> variable on the other hand will be most likely placed in the <code>heap</code> or in the thread local storage (that can be seen as a global memory local to a thread). A threadprivate variable <code>persist across regions</code> (depending on some restrictions). <code>The master thread uses the original variable</code>, all other threads make a private copy of the original variable (the master variable is still storage-associated with the original variable).</p>
<h2 id="task-æŒ‡ä»¤"><a href="#task-æŒ‡ä»¤" class="headerlink" title="task æŒ‡ä»¤"></a>task æŒ‡ä»¤</h2><p>å¯ä»¥æŒ‡å®šæŸä¸€taskä»»åŠ¡åœ¨æŒ‡å®šç¬¬å‡ ä¸ªthreadè¿è¡Œå—ï¼Ÿ</p>
<h2 id="section-å‘½ä»¤-ä¸-for-å‘½ä»¤çš„åŒºåˆ«"><a href="#section-å‘½ä»¤-ä¸-for-å‘½ä»¤çš„åŒºåˆ«" class="headerlink" title="section å‘½ä»¤ ä¸ for å‘½ä»¤çš„åŒºåˆ«"></a>section å‘½ä»¤ ä¸ for å‘½ä»¤çš„åŒºåˆ«</h2><p>ç®€å•ç†è§£sectionså…¶å®æ˜¯forçš„å±•å¼€å½¢å¼ï¼Œé€‚åˆäºå°‘é‡çš„â€œä»»åŠ¡â€ï¼Œå¹¶ä¸”é€‚åˆäºæ²¡æœ‰è¿­ä»£å…³ç³»çš„â€œä»»åŠ¡â€ã€‚æ¯ä¸€ä¸ªsectionè¢«ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œã€‚</p>
<h2 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">omp_get_thread_num() //è·å–çº¿ç¨‹çš„numï¼Œå³IDã€‚åœ¨å¹¶è¡ŒåŒºåŸŸå¤–ï¼Œè·å–çš„æ˜¯masterçº¿ç¨‹çš„IDï¼Œå³ä¸º0ã€‚</span><br><span class="line">omp_get_num_threads/omp_set_num_threads()  //è®¾ç½®/è·å–çº¿ç¨‹æ•°é‡ï¼Œç”¨äºè¦†ç›–OMP_NUM_THREADSç¯å¢ƒå˜é‡çš„è®¾ç½®ã€‚omp_set_num_threadsåœ¨ä¸²è¡ŒåŒºåŸŸè°ƒç”¨æ‰ä¼šæœ‰æ•ˆï¼Œomp_get_num_threadsè·å–å½“å‰çº¿ç¨‹ç»„çš„çº¿ç¨‹æ•°é‡ï¼Œä¸€èˆ¬åœ¨å¹¶è¡ŒåŒºåŸŸè°ƒç”¨ï¼Œåœ¨ä¸²è¡ŒåŒºåŸŸè°ƒç”¨è¿”å›ä¸º1ã€‚</span><br><span class="line">omp_get_max_threads() //è¿”å›OpenMPå½“å‰ç¯å¢ƒä¸‹èƒ½åˆ›å»ºçº¿ç¨‹çš„æœ€å¤§æ•°é‡ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">OMP_SCHEDULEï¼šåªèƒ½ç”¨åˆ°for,parallel forä¸­ã€‚å®ƒçš„å€¼å°±æ˜¯å¤„ç†å™¨ä¸­å¾ªç¯çš„æ¬¡æ•°</span><br><span class="line">OMP_NUM_THREADSï¼šå®šä¹‰æ‰§è¡Œä¸­æœ€å¤§çš„çº¿ç¨‹æ•°</span><br><span class="line">OMP_DYNAMICï¼šé€šè¿‡è®¾å®šå˜é‡å€¼TRUEæˆ–FALSE,æ¥ç¡®å®šæ˜¯å¦åŠ¨æ€è®¾å®šå¹¶è¡ŒåŸŸæ‰§è¡Œçš„çº¿ç¨‹æ•°</span><br><span class="line">OMP_NESTEDï¼šç¡®å®šæ˜¯å¦å¯ä»¥å¹¶è¡ŒåµŒå¥—</span><br></pre></td></tr></table></figure>
<h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#include &lt;omp.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, _TCHAR* argv[])  </span><br><span class="line">&#123;</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	omp_set_num_threads(5);</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line"> </span><br><span class="line">#pragma omp parallel num_threads(5)</span><br><span class="line">	&#123;</span><br><span class="line">		// omp_set_num_threads(6);	// Do not call it in parallel region</span><br><span class="line">		printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line">	</span><br><span class="line">	omp_set_num_threads(6);</span><br><span class="line">	printf(&quot;ID: %d, Max threads: %d, Num threads: %d \n&quot;,omp_get_thread_num(), omp_get_max_threads(), omp_get_num_threads());</span><br><span class="line"> </span><br><span class="line">	return 0;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.shaojiemike.top/img/0_13220169702p8d.gif"></p>
<h2 id="OpenMPå’Œpthreadæ˜¯å¸¸è§çš„æ¨¡å‹"><a href="#OpenMPå’Œpthreadæ˜¯å¸¸è§çš„æ¨¡å‹" class="headerlink" title="OpenMPå’Œpthreadæ˜¯å¸¸è§çš„æ¨¡å‹"></a>OpenMPå’Œpthreadæ˜¯å¸¸è§çš„æ¨¡å‹</h2><p>â™¦OpenMPä¸ºå¾ªç¯çº§å¹¶è¡Œæä¾›äº†æ–¹ä¾¿çš„åŠŸèƒ½ã€‚çº¿ç¨‹ç”±ç¼–è¯‘å™¨æ ¹æ®ç”¨æˆ·æŒ‡ä»¤åˆ›å»ºå’Œç®¡ç†ã€‚</p>
<p>â™¦pthreadæä¾›äº†æ›´å¤æ‚ã€æ›´åŠ¨æ€çš„æ–¹æ³•ã€‚çº¿ç¨‹ç”±ç”¨æˆ·æ˜¾å¼åˆ›å»ºå’Œç®¡ç†ã€‚</p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><p>å¯¹å­å¥å’Œåˆ¶å¯¼çš„å…³ç³»ä¸æ¸…æ¥š</p>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/gengshenghong/article/details/7004594">https://blog.csdn.net/gengshenghong/article/details/7004594</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160">https://docs.microsoft.com/en-us/cpp/parallel/openmp/reference/openmp-clauses?view=msvc-160</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-12-20T03:30:29.000Z" title="12/20/2021, 3:30:29 AM">2021-12-20</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.389Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">a minute read (About 145 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/12/20/Work/software/linux-apps/VNC/">VNC</a></p><div class="content"><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># shaojiemike @ node5 in ~ [11:26:56]</span><br><span class="line">$ vncserver -list</span><br><span class="line"></span><br><span class="line">TigerVNC server sessions:</span><br><span class="line"></span><br><span class="line">X DISPLAY #     RFB PORT #      PROCESS ID</span><br><span class="line">:1              5901            148718 (stale)</span><br><span class="line"></span><br><span class="line"># shaojiemike @ node5 in ~ [11:29:39]</span><br><span class="line">$ vncpasswd</span><br><span class="line">Password:</span><br><span class="line"></span><br><span class="line"># shaojiemike @ node5 in ~ [11:34:08]</span><br><span class="line">$ vncserver -kill :1</span><br><span class="line">Killing Xtigervnc process ID 148718... which was already dead</span><br><span class="line">Cleaning stale pidfile &#x27;/home/shaojiemike/.vnc/node5:1.pid&#x27;!</span><br><span class="line"></span><br><span class="line"># shaojiemike @ node5 in ~ [11:36:15]</span><br><span class="line">$ vncserver</span><br><span class="line"></span><br><span class="line">New &#x27;node5:2 (shaojiemike)&#x27; desktop at :2 on machine node5</span><br><span class="line"></span><br><span class="line">Starting applications specified in /etc/X11/Xvnc-session</span><br><span class="line">Log file is /home/shaojiemike/.vnc/node5:2.log</span><br><span class="line"></span><br><span class="line">Use xtigervncviewer -SecurityTypes VncAuth -passwd /home/shaojiemike/.vnc/passwd :2 to connect to the VNC server.</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.shaojiemike.top/img/20211220113457.png"></p>
<h2 id="å®¢æˆ·ç«¯è½¬å‘"><a href="#å®¢æˆ·ç«¯è½¬å‘" class="headerlink" title="å®¢æˆ·ç«¯è½¬å‘"></a>å®¢æˆ·ç«¯è½¬å‘</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 5901:127.0.0.1:5901 -N -f -l shaojiemike node5.xydustc.me</span><br></pre></td></tr></table></figure>

<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><div id='refer-anchor'></div>
æ— 

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-10-26T01:03:53.000Z" title="10/26/2021, 1:03:53 AM">2021-10-26</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.365Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">a few seconds read (About 57 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/10/26/OutOfWork/4-devices/Bios/">Bios</a></p><div class="content"><h2 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h2><p><img src="https://pic.shaojiemike.top/img/20211026090426.png"><br><img src="https://pic.shaojiemike.top/img/20211026091331.png"></p>
<h3 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h3><p><img src="https://pic.shaojiemike.top/img/20211026091601.png"></p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><div id='refer-anchor'></div>
æ— 

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-10-20T16:00:00.000Z" title="10/20/2021, 4:00:00 PM">2021-10-20</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.373Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">4 minutes read (About 563 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/10/20/Work/HPC/llvm-mca/LLVM-mca3/">LLVM Mca : huawei HiSilicon&#039;s TSV110 work</a></p><div class="content"><h2 id="å‡ ä¸ªå¯¹æ¯”å›¾"><a href="#å‡ ä¸ªå¯¹æ¯”å›¾" class="headerlink" title="å‡ ä¸ªå¯¹æ¯”å›¾"></a>å‡ ä¸ªå¯¹æ¯”å›¾</h2><p><img src="https://pic.shaojiemike.top/img/20210918160557.png"></p>
<p>xè½´çš„å«ä¹‰æ˜¯æ”¹å˜portå€¼çš„æ„æ€ï¼Œæ¯”å¦‚<code>tsv110alu2</code>æ˜¯åœ¨<code>tsv110</code>çš„åŸºç¡€ä¸Šå°†aluçš„å€¼æ”¹æˆ2</p>
<h2 id="ç›¸å…³çš„-git-commit"><a href="#ç›¸å…³çš„-git-commit" class="headerlink" title="ç›¸å…³çš„ git commit"></a>ç›¸å…³çš„ git commit</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">commit c9ca3a3c66a493d72cf7afc7ee975e2de399f2e5</span><br><span class="line">Author: Elvina Yakubova &lt;elvina.yakubova@huawei.com&gt;</span><br><span class="line">Date:   Sat Nov 7 01:50:43 2020 +0300</span><br><span class="line"></span><br><span class="line">    [AArch64] Add driver tests for HiSilicon&#x27;s TSV110</span><br><span class="line"></span><br><span class="line">commit 93b99728b1676d23ab5dabc606344230d25e7f4b</span><br><span class="line">Author: Elvina Yakubova &lt;elvina.yakubova@huawei.com&gt;</span><br><span class="line">Date:   Sat Nov 7 01:22:35 2020 +0300</span><br><span class="line"></span><br><span class="line">    [AArch64] Add pipeline model for HiSilicon&#x27;s TSV110</span><br><span class="line"></span><br><span class="line">    This patch adds the scheduling and cost model for TSV110.</span><br><span class="line"></span><br><span class="line">    Reviewed by: SjoerdMeijer, bryanpkc</span><br><span class="line"></span><br><span class="line">    Differential Revision: https://reviews.llvm.org/D89972</span><br><span class="line"></span><br><span class="line">commit 123553921f86ac0fad7b742740aa45e8d380be02</span><br><span class="line">Author: Bryan Chan &lt;bryan.chan@huawei.com&gt;</span><br><span class="line">Date:   Fri Nov 9 19:32:08 2018 +0000</span><br><span class="line"></span><br><span class="line">    [AArch64] Support HiSilicon&#x27;s TSV110 processor</span><br><span class="line"></span><br><span class="line">    Reviewers: t.p.northover, SjoerdMeijer, kristof.beyls</span><br><span class="line"></span><br><span class="line">    Reviewed By: kristof.beyls</span><br><span class="line"></span><br><span class="line">    Subscribers: olista01, javed.absar, kristof.beyls, kristina, llvm-commits</span><br><span class="line"></span><br><span class="line">    Differential Revision: https://reviews.llvm.org/D53908</span><br><span class="line"></span><br><span class="line">    llvm-svn: 346546	</span><br></pre></td></tr></table></figure>
<p>åªæœ‰3ä¸ªï¼Œæ„Ÿè§‰å’Œ2ä¸ªåŠŸèƒ½å¾ˆç›¸å…³ã€‚</p>
<h2 id="æœ€è¿‘-Driver-commit"><a href="#æœ€è¿‘-Driver-commit" class="headerlink" title="æœ€è¿‘ Driver commit"></a>æœ€è¿‘ Driver commit</h2><p><a target="_blank" rel="noopener" href="https://shaojiemike.notion.site/Huawei-work-on-llvm-mca-recur-e338f3133a10416ebdaa596e27e5c5b7">ç±»ä¼¼çš„llvm checkçš„è®¾ç½®</a></p>
<h2 id="å¤ç°ä¸Šé¢çš„å›¾"><a href="#å¤ç°ä¸Šé¢çš„å›¾" class="headerlink" title="å¤ç°ä¸Šé¢çš„å›¾"></a>å¤ç°ä¸Šé¢çš„å›¾</h2><h3 id="è¦æ”¹çš„åœ°æ–¹"><a href="#è¦æ”¹çš„åœ°æ–¹" class="headerlink" title="è¦æ”¹çš„åœ°æ–¹"></a>è¦æ”¹çš„åœ°æ–¹</h3><p>åº”è¯¥æ¯æ¬¡éƒ½è¦é‡æ–°ç¼–è¯‘å®‰è£…<br><img src="https://pic.shaojiemike.top/img/20210923203642.png"></p>
<h3 id="æµ‹è¯•çš„æ±‡ç¼–ä»£ç "><a href="#æµ‹è¯•çš„æ±‡ç¼–ä»£ç " class="headerlink" title="æµ‹è¯•çš„æ±‡ç¼–ä»£ç "></a>æµ‹è¯•çš„æ±‡ç¼–ä»£ç </h3><ol>
<li>åˆ¤æ–­<code>llvm/test/MC/AArch64</code>ä¸‹çš„æ±‡ç¼–èƒ½ç”¨å—?é€‰ä¸ªæœ€å¤§çš„ï¼Œneon ä¸æ”¯æŒï¼Œ armv8.2ä¹Ÿå¹¶ä¸æ”¯æŒã€‚æ„Ÿè§‰æœ‰ç‰¹åˆ«è¦æ±‚<img src="https://pic.shaojiemike.top/img/20211021152612.png"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat neon-diagnostics.s|llvm-mca -timeline -show-encoding -all-stats -all-views</span><br></pre></td></tr></table></figure></li>
<li>é€‰æ‹©osacaçš„benchmarké‡Œçš„add.c</li>
</ol>
<h2 id="AArch64SchedTSV110-td"><a href="#AArch64SchedTSV110-td" class="headerlink" title="AArch64SchedTSV110.td"></a>AArch64SchedTSV110.td</h2><p>locate at llvm&#x2F;lib&#x2F;Target&#x2F;AArch64&#x2F;AArch64SchedTSV110.td</p>
<h3 id="td-file"><a href="#td-file" class="headerlink" title="td file"></a>td file</h3><p>tablegen(LLVM class) definitions</p>
<h3 id="éƒ¨åˆ†æŒ‡ä»¤è§£é‡Š"><a href="#éƒ¨åˆ†æŒ‡ä»¤è§£é‡Š" class="headerlink" title="éƒ¨åˆ†æŒ‡ä»¤è§£é‡Š"></a>éƒ¨åˆ†æŒ‡ä»¤è§£é‡Š</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def : InstRW&lt;[TSV110Wr_2cyc_1MDU],   (instregex <span class="string">&quot;^(AND|BIC|EON|EOR|ORN|ORR)[WX]rs$&quot;</span>)&gt;;</span><br></pre></td></tr></table></figure>
<p>BIC (bit clear) EON (Exclusive OR) ORR (OR operations on the values in Rn and Operand2)</p>
<p>InstRWçš„å®šä¹‰</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Map a set of opcodes to a list of SchedReadWrite types. This allows</span></span><br><span class="line"><span class="comment">// the subtarget to easily override specific operations.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// SchedModel ties this opcode mapping to a processor.</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">InstRW</span>&lt;list&lt;SchedReadWrite&gt; rw, dag instrlist&gt; &#123;</span><br><span class="line">  list&lt;SchedReadWrite&gt; OperandReadWrites = rw;</span><br><span class="line">  dag Instrs = instrlist;</span><br><span class="line">  SchedMachineModel SchedModel = ?;</span><br><span class="line">  <span class="comment">// Allow a subtarget to mark some instructions as unsupported.</span></span><br><span class="line">  bit Unsupported = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TSV110Wr_2cyc_1MDUçš„å®šä¹‰</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def TSV110Wr_2cyc_1MDU   : SchedWriteRes&lt;[TSV110UnitMDU]&gt;   &#123; let Latency = <span class="number">2</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SchedWriteRes</span>&lt;list&lt;ProcResourceKind&gt; resources&gt; : SchedWrite,</span><br><span class="line">  ProcWriteResources&lt;resources&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰TSV110ä¸Šå¯ç”¨çš„æ¯ç§å¤„ç†å™¨èµ„æºå’Œæ•°é‡ï¼Œ</span></span><br><span class="line"><span class="comment">//å®ƒæœ‰8æ¡pipelineç®¡é“ï¼Œæ¯ä¸ªç®¡é“éƒ½æœ‰è‡ªå·±çš„é˜Ÿåˆ—ï¼Œå¾®æ“ä½œåœ¨é‚£é‡Œç­‰å¾…</span></span><br><span class="line"><span class="comment">//å®ƒä»¬çš„operandså’Œissueå°†æ— åºåœ°å‘é€åˆ°å…«ä¸ªæ‰§è¡Œç®¡é“ä¹‹ä¸€ã€‚</span></span><br><span class="line">def TSV110UnitMDU  : ProcResource&lt;<span class="number">1</span>&gt;; <span class="comment">// Multi-Cycle</span></span><br></pre></td></tr></table></figure>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><div id='refer-anchor'></div>
æ— 

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-10-09T16:00:00.000Z" title="10/9/2021, 4:00:00 PM">2021-10-09</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.373Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">28 minutes read (About 4164 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/10/09/Work/HPC/llvm-mca/LLVM-mca4/">LLVM Mca ï¼šwith BHive (2019)</a></p><div class="content"><h2 id="BHive"><a href="#BHive" class="headerlink" title="BHive"></a>BHive</h2><p>ä¸€ç§æ–°çš„profilerï¼Œå¯ä»¥profileæ²¡æœ‰ç”¨æˆ·å¹²é¢„çš„å†…å­˜è®¿é—®çš„åŸºæœ¬å—ã€‚</p>
<p>åŸºäºè¿™ç§profileråˆ›å»ºäº†BHive,æ¥éªŒè¯llvm-mcaç­‰æ¨¡å‹ã€‚</p>
<p>BHiveæ˜¯ç”¨æ¥è¯„ä»·llvm-mcaè¿™äº›æ¨¡å‹çš„ï¼Œå®éªŒåŸºäºå„ç§æ”¶é›†æ¥çš„<strong>ä¸€ä¸ªåŸºæœ¬å—</strong>å„ç§è¯„ä»·</p>
<h2 id="I-INTRODUCTION"><a href="#I-INTRODUCTION" class="headerlink" title="I. INTRODUCTION"></a>I. INTRODUCTION</h2><h3 id="Automatically-Profiling-Basic-Blocks"><a href="#Automatically-Profiling-Basic-Blocks" class="headerlink" title="Automatically Profiling Basic Blocks"></a>Automatically Profiling Basic Blocks</h3><p>å›°éš¾åœ¨äºç°æœ‰çš„ æ²¡æœ‰è€ƒè™‘ memory crash ??? .é»˜è®¤å‘½ä¸­L1 cache</p>
<p>A <strong>key technical challenge</strong> with collecting a large basic block dataset is that there is no existing approach to profile an arbitrary basic block that has been removed from its program<br>context.</p>
<p>(æ²¡æ‡‚ï¼Ÿé‚£ä¸ºä»€ä¹ˆè¦removed from its program<br>context) å› ä¸ºè¦æŠŠå¸¸ç”¨çš„åº”ç”¨æ‹†æˆå°ä¾‹å­æ¥è¯„åˆ¤ï¼Œè¿™äº›æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>è¿ç”¨éšå«ç‹„åˆ©å…‹é›·åˆ†å¸ƒLDA,åŸºäºcpuèµ„æºçš„åˆ©ç”¨ç‡ï¼Œæ¥cluster benchmark suiteé‡Œçš„åŸºæœ¬å—</p>
<p>é€šè¿‡å¯¹å„ç§ç±»å‹æœ€åŸºæœ¬çš„ä»£ç å—æ¥è¿›è¡Œprofileï¼Œä»è€Œå½¢æˆé’ˆå¯¹å„ç§performance modelçš„æ•°æ®åº“ã€‚</p>
<p>ç°åœ¨å·²ç»æœ‰è¶…è¿‡30ä¸‡çš„åŸºæœ¬å—åˆ†æï¼Œæ¥æºäºå„ç§æ–¹å‘çš„åº”ç”¨ï¼ŒåŒ…æ‹¬æ•°å€¼è®¡ç®—OpenBLAS,æ•°æ®åº“SQLite,æœºå™¨å­¦ä¹ TensorFlowï¼Œå¯†ç å­¦OpenSSLã€‚</p>
<p>è¿™ä¹ˆå¤šçš„æ•°æ®äº§ç”Ÿäº†ä¸€ä¸ªç”¨äºè¯„ä¼°performance modelçš„æ–°benchmarkã€‚</p>
<p>ä½œè€…è¯´<strong>performance modeling ç ”ç©¶çš„æœªæ¥åœ¨äºä¸å…¶ä»–å…ˆè¿›æŠ€æœ¯çš„å¤§è§„æ¨¡å®šé‡æ¯”è¾ƒ</strong></p>
<h3 id="å†…å­˜è®¿é—®çš„å¤„ç†"><a href="#å†…å­˜è®¿é—®çš„å¤„ç†" class="headerlink" title="å†…å­˜è®¿é—®çš„å¤„ç†"></a>å†…å­˜è®¿é—®çš„å¤„ç†</h3><p>é€šè¿‡æŠŠè™šæ‹Ÿé¡µé¢æ˜ å°„åˆ°<strong>å•ä¸ª</strong>ç‰©ç†é¡µé¢ï¼Œæ¥åˆæ³•å†…å­˜è®¿é—®åŒæ—¶é¿å…cache miss</p>
<h2 id="II-èƒŒæ™¯"><a href="#II-èƒŒæ™¯" class="headerlink" title="II. èƒŒæ™¯"></a>II. èƒŒæ™¯</h2><h3 id="Existing-Performance-Models"><a href="#Existing-Performance-Models" class="headerlink" title="Existing Performance Models"></a>Existing Performance Models</h3><p>æœ‰ä¸¤ç§model</p>
<ol>
<li>äº§ç”Ÿå¯ä»¥è¯¦ç»†æè¿°æŒ‡ä»¤ä½•æ—¶å‘å°„å’Œé€€ä¼‘çš„å¯è§£é‡Šæ‰§è¡Œè·¯å¾„çš„å¾®æ¶æ„æ¨¡æ‹Ÿå™¨ï¼Œé™„å¸¦ååé‡é¢„æµ‹ã€‚</li>
<li>æ¯æ¡æŒ‡ä»¤éƒ½æœ‰å»¶è¿Ÿã€ååé‡æŸ¥æ‰¾è¡¨ï¼Œç›¸å½“äºä¸€ä¸ªè¢«å¯„å­˜å™¨åˆ†é…å™¨ä½¿ç”¨çš„é¢å¤–å¼€é”€ä¼°è®¡å™¨</li>
</ol>
<p>å„ç§model, å†™åˆ°å¦ä¸€ç¯‡é‡Œäº†</p>
<ol>
<li>IACA</li>
<li>llvm-mca</li>
<li>OSACA</li>
<li>Ithemal</li>
</ol>
<h3 id="Machine-Code-Profilers"><a href="#Machine-Code-Profilers" class="headerlink" title="Machine Code Profilers"></a>Machine Code Profilers</h3><ol>
<li>é€šè¿‡ Agner Fogâ€™s script æµ‹é‡çœŸå®çš„ï¼Œæœ‰å‘¨æœŸï¼Œcache miss ç­‰ç­‰ã€‚<a target="_blank" rel="noopener" href="https://www.agner.org/optimize/testp.zip">https://www.agner.org/optimize/testp.zip</a></li>
<li>nanoBenchä¹Ÿæ˜¯ã€‚<a target="_blank" rel="noopener" href="https://github.com/andreas-abel/nanoBench">https://github.com/andreas-abel/nanoBench</a> å¯ä»¥æŒ‡å®šprocessor?å’Œ kernelæ¨¡å¼ã€‚</li>
<li><strong>Unrolling</strong><ol>
<li>æµ‹é‡ååé‡çš„åŸºæœ¬æ–¹æ³•å°±æ˜¯å±•å¼€ä¸€ä¸ªåŸºæœ¬å—çš„ä»£ç å¤šæ¬¡ï¼Œç„¶åæµ‹é‡å¤å¤šæ¬¡çš„ä»£ç ã€‚æŠŠå±•å¼€çš„åŸºæœ¬å—latencyé™¤ä»¥<code>unroll factor</code>(å…¸å‹å€¼æ˜¯100)</li>
<li>ç›®çš„ï¼š<ol>
<li>è¾¹ç¼˜åŒ–å‰å‡ æ¬¡warm upçš„latencyå€¼çš„å½±å“ã€‚</li>
<li>å‡å°‘æ”¶èµ·æ•°æ®çš„å¼€é”€å½±å“</li>
</ol>
</li>
<li><code>unroll factor</code>å°±æ˜¯å¾ªç¯å±•å¼€æ¬¡æ•°ã€‚</li>
</ol>
</li>
<li><strong>å±€é™æ€§</strong>æ˜¯ï¼Œå¿…é¡»äººå·¥ç»™ä»£ç å—ï¼Œä¸èƒ½è‡ªåŠ¨profileä¸€å †ä»»æ„çš„åŸºæœ¬å—æ¥ç³»ç»Ÿæ€§éªŒè¯ã€‚???</li>
</ol>
<h2 id="III-PROFILING-ARBITRARY-BASIC-BLOCKS"><a href="#III-PROFILING-ARBITRARY-BASIC-BLOCKS" class="headerlink" title="III.  PROFILING ARBITRARY BASIC BLOCKS"></a>III.  PROFILING ARBITRARY BASIC BLOCKS</h2><p>ç›®æ ‡æ˜¯åœ¨<strong>ä¸éœ€è¦æ‰‹åŠ¨å¹²é¢„</strong>çš„æƒ…å†µä¸‹åˆ†æä»»æ„åŸºæœ¬å—ï¼Œä»¥ä¾¿æµ‹é‡çš„<strong>ååé‡</strong>ä¸æ€§èƒ½æ¨¡å‹é€šå¸¸å‡å®šçš„<strong>å®šä¹‰å’Œä¸å˜é‡</strong>ç›¸å¯¹åº”ã€‚å…³é”®çš„æŒ‘æˆ˜æ˜¯ä½¿è¿™äº›åŸºæœ¬å—èƒ½å¤Ÿåœ¨ä¸å´©æºƒçš„æƒ…å†µä¸‹<strong>è®¿é—®ä»»æ„å†…å­˜åœ°å€</strong>ã€‚</p>
<p>ç”±äºåŸºæœ¬å—åªæ˜¯æ­£å¸¸ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´æ ¹æœ¬ä¸èƒ½å•ç‹¬æ­£å¸¸è¿è¡Œã€‚BHiveåšçš„äº‹æƒ…å°±æ˜¯ï¼Œè®©ä»–æ­£å¸¸è¿è¡Œã€‚</p>
<h3 id="Handling-Arbitrary-Memory-Accesses"><a href="#Handling-Arbitrary-Memory-Accesses" class="headerlink" title="Handling Arbitrary Memory Accesses"></a>Handling Arbitrary Memory Accesses</h3><p><img src="https://pic.shaojiemike.top/img/20211007210352.png"><br>è¿™ä¸ªä»£ç å—åªæœ‰æ‰§è¡Œä»£ç åˆ†é…åœ¨<code>0x4110a</code>æ—¶ï¼Œæ‰èƒ½æ­£å¸¸è¿è¡Œ</p>
<ol>
<li>Remapping Virtual Pages.<ol>
<li>ä¸€ä¸ªåŸºæœ¬å—çš„æ‰€æœ‰è™šæ‹Ÿå†…å­˜é¡µé‡æ–°æ˜ å°„åˆ°ä¸€ä¸ªç‰©ç†é¡µä¸Šï¼Œæ‰€ä»¥å…¨éƒ¨æ•°æ®è®¿é—®éƒ½å‘½ä¸­L1ã€‚è¿™æ ·å°±å¯ä»¥æ‰§è¡Œ97%çš„åŸºæœ¬å—ã€‚</li>
<li>æ­¥éª¤<ol>
<li>æŠŠåŸæœ¬è™šæ‹Ÿé¡µå…¨éƒ¨unmap<ol>
<li>è¿™ä¼šå¯¼è‡´é™¤äº†åŒ…å«åŸºæœ¬å—æŒ‡ä»¤çš„é¡µä¹‹å¤–çš„å…¨éƒ¨çš„è¿ç»­çš„å†…å­˜è®¿é—®å‡ºé—®é¢˜ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>åœ¨å­è¿›ç¨‹é‡Œè¿è¡Œå±•å¼€çš„åŸºæœ¬å—æŒ‡ä»¤ã€‚<ol>
<li>è¿™æ—¶å¯¹æ¯ä¸ªunmapçš„è™šæ‹Ÿé¡µçš„è®¿é—®éƒ½ä¼šå‡ºé”™ï¼Œä½†æ˜¯ä¸»è¿›ç¨‹ä¸€ç§ç›‘è§†ç€ã€‚ä¸€æ—¦ä¸­æ–­å°±é‡æ–°æ˜ å°„å‡ºé”™åœ°å€ï¼Œç„¶åé‡æ–°å¼€å§‹è·‘ã€‚</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>Memory Initialization<ol>
<li>åˆå§‹åŒ–ä¸€ä¸ªä¸­ç­‰å¤§å°0x12345600çš„ç‰©ç†é¡µï¼Œå…è®¸éƒ½è™šæ‹Ÿé¡µéƒ½æ˜ å°„</li>
</ol>
</li>
<li>Virtual page aliasing<ol>
<li>å› ä¸ºä¸åŒçš„è™šæ‹Ÿé¡µæ˜ å°„åœ¨åŒä¸€ä¸ªç‰©ç†é¡µçš„åŒä¸€é¡¹å¯¼è‡´memory dependencesï¼Œè¦ç­‰å¾…</li>
<li><strong>å‰”é™¤</strong>6.28%çš„åŸºæœ¬å—</li>
<li>å¯ä»¥é€šè¿‡å¢å¤§ç‰©ç†é¡µï¼Œæ¥å‡å°å‘ç”Ÿçš„æ¦‚ç‡ã€‚</li>
</ol>
</li>
</ol>
<h3 id="Overall-Profiling-Workflow"><a href="#Overall-Profiling-Workflow" class="headerlink" title="Overall Profiling Workflow"></a>Overall Profiling Workflow</h3><p>é€šè¿‡é‡å¤è¿è¡ŒåŸºæœ¬å—æ¥è®¡ç®—ååé‡</p>
<ol>
<li>Raw Measurement<ol>
<li>å…ˆä»åŸºæœ¬å—é‡Œï¼Œäº§ç”Ÿä¸ä¼šmemory crashçš„å¯æ‰§è¡Œéƒ¨åˆ†ã€‚</li>
<li>unroll factorçš„é€‰å–ã€‚It uses 100 and 200 as the unroll factors for basic blocks <strong>smaller than 100 bytes</strong>; 50 and 100 for basic blocks <strong>between 100 bytes and 200 bytes</strong>; and finally 16 and 32 for basic blocks <strong>larger than 200 bytes</strong></li>
</ol>
</li>
<li>Filtering<ol>
<li>ç­›é€‰æ‰§è¡Œä»£ç æ»¡è¶³ç†æƒ³åŒ–æ¨¡å‹çš„æ‰§è¡Œç»“æœï¼Œæ¯”å¦‚å‘½ä¸­L1cache</li>
<li>L1 Cache Misses<ol>
<li>å·¥å…·å¯ä»¥ç”¨ç¡¬ä»¶è®¡æ•°å™¨ç›‘æ§æŒ‡ä»¤å’Œæ•°æ®cache missesã€‚æ‹’ç»æ‰€æœ‰cache missçš„æƒ…å†µã€‚</li>
</ol>
</li>
<li>Unaligned Loads<ol>
<li>ä¸è¿ç»­çš„è®¿å­˜ä¼šå¾ˆæ…¢ï¼Œè§£å†³æ–¹æ³•å°±æ˜¯å»é™¤æ‰€æœ‰æœ‰ä¸è¿ç»­çš„è®¿å­˜çš„ã€‚å¤§çº¦åˆ é™¤äº†0.18%çš„åŸºæœ¬å—</li>
</ol>
</li>
<li>Subnormal Floating Point<ol>
<li>ä¸€äº›ç‰¹æ®Šçš„æµ®ç‚¹æ•°è®¡ç®—ä¼šæ¯”æ­£å¸¸çš„æµ®ç‚¹æ•°è®¡ç®—æ…¢20å€ï¼Œå»é™¤äº†ä¸MXCSRå¯„å­˜å™¨æœ‰å…³çš„0.1%çš„åŸºæœ¬å—ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/8341395/what-is-a-subnormal-floating-point-number">https://stackoverflow.com/questions/8341395/what-is-a-subnormal-floating-point-number</a></li>
</ol>
</li>
<li>Context Switches<ol>
<li>ä¸Šä¸‹æ–‡åˆ‡æ¢(è‹±è¯­ï¼šcontext switch)ï¼Œåˆç§°ç¯å¢ƒåˆ‡æ¢ï¼Œç”µè„‘æœ¯è¯­ï¼Œæ˜¯ä¸€ä¸ªå­˜å‚¨å’Œé‡å»ºCPUçš„çŠ¶æ€ (å†…æ–‡)ï¼Œå› æ­¤ä»¤å¤šä¸ªè¿›ç¨‹(process)å¯ä»¥åˆ†äº«å•ä¸€CPUèµ„æºçš„è®¡ç®—è¿‡ç¨‹ã€‚è¦åˆ‡æ¢CPUä¸Šçš„è¿›ç¨‹æ—¶ï¼Œå¿…éœ€å…ˆè¡Œå­˜å‚¨ç›®å‰è¿›ç¨‹çš„çŠ¶æ€ï¼Œå†å°†æ¬²è¿è¡Œçš„è¿›ç¨‹ä¹‹çŠ¶æ€è¯»å›CPUä¸­ã€‚</li>
</ol>
</li>
<li>å¯æ¥å—çš„è¯„ä¼°å…¬å¼ 10%çš„è¯¯å·®ï¼Ÿï¼Ÿï¼Ÿ</li>
</ol>
</li>
<li>Throughput Calculation<ol>
<li>å¦‚æœé€šè¿‡äº†åŸºæœ¬å—çš„ç­›é€‰ï¼Œç”¨æœ‰è®°å½•çš„æœ€å°å»¶è¿Ÿè®¡ç®—ååé‡<img src="https://pic.shaojiemike.top/img/20210920154432.png"></li>
</ol>
</li>
<li>Environment Variance<ol>
<li>ç”±äºç¯å¢ƒçš„å½±å“ï¼Œå¯¼è‡´ç»“æœæœ‰ä¸ªç¨³å®šçš„åç§»ã€‚è‡³å°‘æ‰§è¡Œ5æ¬¡ï¼Œå±•å¼€16æ¬¡çš„åŸºæœ¬å—ã€‚å–æœ€å°çš„5æ¬¡ä½œä¸ºç»“æœã€‚</li>
</ol>
</li>
</ol>
<h3 id="Portability-to-Other-Architectures"><a href="#Portability-to-Other-Architectures" class="headerlink" title="Portability to Other Architectures"></a>Portability to Other Architectures</h3><p>åªè¦æ¶æ„æ»¡è¶³ä»¥ä¸‹å‡ ç‚¹è¦æ±‚</p>
<ol>
<li>æœ‰å°†å¤šä¸ªè™šæ‹Ÿé¡µé¢æ˜ å°„åˆ°å‡ ä¸ªç‰©ç†é¡µé¢çš„APIã€‚map<br>multiple virtual pages to a few physical pages <ol>
<li><strong>without</strong> incurring a performance <strong>penalty</strong> due to unnecessary cache invalidation. We therefore require that the target processor has a **physically tagged data cache(VIPT)**ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>we additionally require that the page size is small enough so the indexing bits are<br>not affected by address translation.</li>
</ol>
</li>
<li>detecting cache misses, </li>
<li>and detecting or disabling floating-point underflow.</li>
</ol>
<h2 id="IV-BASIC-BLOCK-DATASET"><a href="#IV-BASIC-BLOCK-DATASET" class="headerlink" title="IV. BASIC BLOCK DATASET"></a>IV. BASIC BLOCK DATASET</h2><p><img src="https://pic.shaojiemike.top/img/20210921190750.png"></p>
<p>åº”ç”¨çš„é€‰æ‹©</p>
<ol>
<li>å°½å¯èƒ½è¿˜åŸç°å®ç”Ÿæ´»çš„å„ä¸ªæ–¹é¢ï¼Œ</li>
<li>è€Œä¸”æ˜¯ç”¨æˆ·çš„å…¸å‹ç”¨æ³•ã€‚</li>
<li>Clang&#x2F;LLVM (compiler), Redis (inmemory database), SQLite (database), and Gzip æ˜¯ç”¨é«˜çº§è¯­è¨€Cæˆ–è€…C++ç¼–å†™çš„ï¼Œç®—æ³•å’Œæ•°æ®ç»“æ„æœ‰å¤æ‚çš„è®¾è®¡ã€‚</li>
<li>OpenSSL (cryptography), OpenBLAS , Eigen (scientific computing),TensorFlow (machine learning) ä»£è¡¨çš„æ˜¯æ ¸å¿ƒå¾ªç¯æ˜¯æ‰‹åŠ¨æ±‡ç¼–ä¼˜åŒ–è¿‡çš„é«˜æ€§èƒ½åº“ã€‚<ol>
<li>å…¶ä¸­Embreeæ˜¯ ç”¨Intel ispc (a data-parallel language)ç¼–å†™çš„ã€‚</li>
</ol>
</li>
</ol>
<p>We compiled all applications with the <strong>highest optimization</strong> settings defined by their build systems. å¦‚æœå¯ä»¥ç”¨ä¸Šäº†AVX2ã€‚</p>
<p>ä½¿ç”¨DynamoRIOåŠ¨æ€åˆ†ææ¥æç‚¼åŸºæœ¬å—ã€‚å¯ä»¥å®ç°åœ¨è¿è¡Œæ—¶è®°å½•æ¯ä¸ªè¿è¡Œçš„åŸºæœ¬å—ã€‚æˆ‘ä»¬é‡‡ç”¨åŠ¨æ€åˆ†æï¼Œè€Œä¸æ˜¯é™æ€åæ±‡ç¼–ã€‚å› ä¸ºé™æ€åæ±‡ç¼–æ— æ³•åŒºåˆ«padding bytes from instructionsã€‚???</p>
<p>åº”ç”¨çš„ä¾‹å­é™¤äº†FFmpeg and Gzipéƒ½æ˜¯é€‰æ‹©çš„å®˜æ–¹çš„benchmarkã€‚<br>Eigen é‡‡ç”¨çš„æ˜¯ two sparse linear algebra workloads: sparse matrix-matrix multiplication (SpMM) and sparse matrix-vector multiplication (SpMV).</p>
<h2 id="V-BASIC-BLOCK-CLUSTERING"><a href="#V-BASIC-BLOCK-CLUSTERING" class="headerlink" title="V. BASIC BLOCK CLUSTERING"></a>V. BASIC BLOCK CLUSTERING</h2><p>ä¸€äº›åŸºæœ¬å—æ¯”å…¶ä»–çš„æ›´éš¾å»ºæ¨¡ï¼Œ???(å»ºä»€ä¹ˆæ¨¡ï¼ŒVI-Bè¯´æ˜äº†ä»€ä¹ˆ)æœ‰å†…å­˜ä¾èµ–çš„åŸºæœ¬å—é¢„æµ‹é”™è¯¯ç‡æ›´é«˜ã€‚</p>
<p>é‡‡ç”¨äº†ä¸€ç§æŠ€æœ¯???(æ˜¯åº”ç”¨åœ¨æå–ä¸Š) åŸºäºå¤„ç†å™¨çš„ä½¿ç”¨èšç±»åŸºæœ¬å—ã€‚<br>è¿™ä¸ªæŠ€æœ¯æœ‰åŠ©äºæ€§èƒ½æ¨¡å‹çš„è®¾è®¡å’Œä½¿ç”¨è€…<strong>æ›´ç»†ç²’åº¦äº†è§£</strong>performance model,è®©ä»–ä»¬èƒ½é›†ä¸­ä»¥åæ–°æ·»åŠ çš„èµ„æºåœ¨æœ‰å›°éš¾çš„é‚£ä¸€ç±»åŸºæœ¬å—ã€‚</p>
<ol>
<li>Methodology<ol>
<li>å…·ä½“æ–¹æ³•<ol>
<li>æ‰¾åˆ°æ¯ä¸ªåŸºæœ¬å—çš„ç¡¬ä»¶ä½¿ç”¨ç‡çš„è¡¨ç¤º port-mapping representation</li>
<li>æ ¹æ®å…¶èšç±»</li>
</ol>
</li>
<li>å¯¹æ¯æ¡æŒ‡ä»¤ç»“åˆportä½¿ç”¨<ol>
<li>è¿ç”¨ Abel and Reineke A. Abel and J. Reineke, â€œuops.info: Characterizing latency, throughput, and port usage of instructions on intel microarchitectures,â€ in ASPLOS, 2019çš„ç»“æœ ???</li>
<li>ä¾‹å¦‚???<ol>
<li><code>xor %rax, %rbx</code> in Haswell is <code>&#123;p0156 â†’ 1&#125;</code></li>
</ol>
</li>
</ol>
</li>
<li>ä½¿ç”¨<strong>Latent Dirichlet Allocation</strong> (LDA)æ¥æ„å»ºtopic model æ¨¡å‹(python è®­ç»ƒæ¨¡å‹)<ol>
<li>åœ¨è¯­è¨€å¤„ç†ä¸Šçš„åº”ç”¨æ˜¯åŸºäºç»Ÿè®¡è¯é¢‘</li>
<li>åœ¨å®é™…è¿ç”¨çš„æ—¶å€™ï¼Œå¾®æŒ‡ä»¤æ“ä½œä¼šæ ¹æ®ä½¿ç”¨çš„portè€Œæœ‰å°ä¸åŒã€‚<ol>
<li>topicsæ˜¯åˆ†ç±»çš„ç±»åˆ«,6ç±»</li>
<li>documentsæ˜¯åŸºæœ¬å—</li>
<li>Î± &#x3D; 1&#x2F;6 and Î² &#x3D; 1&#x2F;13.</li>
</ol>
</li>
<li>ä¸ºäº†æ¨æ–­æ¯ä¸ªå¾®æŒ‡ä»¤æ“ä½œæ‰€å±çš„ç±»åˆ«ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†SciKit Learn transformå¯¹äºLDAçš„éšæœºå˜åŒ–æ¨æ–­çš„é»˜è®¤å®ç°</li>
<li>è®¡ç®—æ¯ä¸ªåŸºæœ¬å—çš„æœ€æœ‰å¯èƒ½çš„ç±»åˆ«ä½œä¸ºå…¶åˆ†ç±»ç»“æœ</li>
</ol>
</li>
</ol>
</li>
<li>Results<ol>
<li>LDAå°†ç»“æœèšç±»åï¼Œæ ¹æ®åŸºæœ¬å—çš„å†…å®¹ï¼Œæ‰‹åŠ¨è¿›è¡Œæ³¨åä»¥åŠè¯´æ˜<img src="https://pic.shaojiemike.top/img/20211009165208.png"></li>
<li>example<img src="https://pic.shaojiemike.top/img/20211009165630.png"></li>
<li>æ ¹æ®è¿è¡Œæ—¶é¢‘ç‡ç¡®å®šå…¶æƒé‡ï¼Œ åŸºäºsample-based profiler??? (A portable sampling-based profiler for java virtual machines,)ç¡®å®šã€‚</li>
<li>é«˜æ€§èƒ½çš„åº“å¦‚é¢„æœŸä¸€æ ·ï¼Œå‘é‡åŒ–çš„åŸºæœ¬å—å æ¯”è¾ƒå¤šã€‚</li>
<li>å…¶ä½™çš„æ— å‘é‡åŒ–çš„è¾ƒå¤šã€‚OpenSSL and Gzipæœ‰è®¸å¤šä½æ“ä½œçš„ã€‚</li>
</ol>
</li>
<li>Case Study on Data-Center Applications<ol>
<li>ç›®çš„ï¼šä½œä¸ºæµ‹è¯•ä¾‹å­ï¼Œçœ‹è¿™ä¸ªèšç±»æ–¹æ³•èƒ½ä¸èƒ½æ‰¾å¾—åˆ°éšè—çš„çƒ­ç‚¹ã€å·¥ä½œè´Ÿè½½</li>
<li>Methodology<ol>
<li>ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆå°†å…¶åŸºæœ¬å—åˆ†æˆä¹‹å‰çš„å‡ ç±»ï¼Œè¿˜æ˜¯ä½¿ç”¨LDA</li>
<li>ç¬¬äºŒæ­¥ï¼šåˆ†ç±»ç»“æœæ ‡æ³¨</li>
<li>ç¬¬ä¸‰æ­¥ï¼šæ¯”è¾ƒèšç±»ç»“æœçš„perplexityå€¼???</li>
<li>ï¼Ÿï¼Ÿï¼Ÿæœ‰æ²¡æœ‰ç»“åˆgoogleçš„åº”ç”¨<img src="https://pic.shaojiemike.top/img/20211009173926.png"></li>
</ol>
</li>
<li>Results<ol>
<li>æ·»åŠ æ–°åº”ç”¨åï¼Œè¯¥å€¼åªæ˜¯ç•¥å¾®å¢é•¿ã€‚è¯´æ˜æ¨¡å‹çš„ä»£è¡¨æ€§å¥½ã€‚???</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="VI-PERFORMANCE-MODEL-EVALUATION"><a href="#VI-PERFORMANCE-MODEL-EVALUATION" class="headerlink" title="VI. PERFORMANCE MODEL EVALUATION"></a>VI. PERFORMANCE MODEL EVALUATION</h2><p>åœ¨3ç§Intelæ¶æ„ä¸ŠéªŒè¯4ç§å·²æœ‰çš„æ€§èƒ½æ¨¡å‹</p>
<ol>
<li>Methodology<ol>
<li>è¯´æ˜å„ä¸ªæµ‹è¯•è½¯ä»¶çš„ç‰ˆæœ¬ã€‚</li>
<li>Dataset<ol>
<li>basic block dataset discussed in Section IV</li>
</ol>
</li>
<li>Platform<ol>
<li>balabala 3ç§æ¶æ„çš„ Intel cpus</li>
</ol>
</li>
<li>Evaluation Metrics<ol>
<li>æµ‹é‡ååé‡tå’Œé¢„æµ‹ååé‡tâ€™$$err(t,tâ€™)&#x3D;|\frac{t-tâ€™}{t}|$$</li>
<li>ä¸ä»¥é¢„æµ‹ç²¾åº¦ï¼Œè€Œæ˜¯ä»¥é¢„æµ‹ç»“æœçš„ç›¸å¯¹å…³ç³»ä¸ºè¯„åˆ†æ ‡å‡†ã€‚</li>
</ol>
</li>
<li>é¢å¤–èƒ½è¯„ä¼°æ¯ä¸ªæ¨¡å‹å¦‚ä½•ä¿æŒåŸºæœ¬å—ååé‡çš„é¡ºåºã€‚ä½¿ç”¨Kendallâ€™s tauç³»æ•°(è¶Šå¤§æ•ˆæœè¶Šå¥½)ï¼Œè€Œä¸æ˜¯ç›¸å¯¹è¯¯å·®ã€‚æµ‹é‡çš„åŸå› æ˜¯ä½¿ç”¨è€…å¯èƒ½å…³å¿ƒçš„ä¸æ˜¯ç»å¯¹çš„æ•°å€¼ç²¾åº¦ï¼Œè€Œæ˜¯ç›¸å¯¹å…³ç³»çš„å‡†ç¡®ç‡ã€‚æ¯”å¦‚ä¼˜åŒ–è½¯ä»¶çš„æ—¶å€™å…³å¿ƒçš„ä¸æ˜¯å…·ä½“è€—æ—¶ï¼Œè€Œæ˜¯å“ªä¸ªä¼˜åŒ–ç­–ç•¥è€—æ—¶æ›´çŸ­ã€‚</li>
</ol>
</li>
<li>Results<ol>
<li><img src="https://pic.shaojiemike.top/img/20211010154102.png"></li>
<li><strong>IACA</strong> ç¬¬äºŒå¥½çš„ï¼Œåœ¨å‘é‡åŒ–ç±»æ¨¡æ‹Ÿçš„æœ€å¥½</li>
<li><strong>llvm-mca</strong> æœ€å·®çš„ï¼Œå°¤å…¶æ˜¯å’Œloadsæœ‰å…³æ—¶ã€‚</li>
<li><strong>Ithemal</strong>  é™¤äº†å‘é‡åŸºæœ¬å—éƒ½æ˜¯æœ€å¥½çš„ã€‚åœ¨memory dependence (Ld&#x2F;St)å°¤å…¶å¥½ï¼Œä½†æ˜¯å‘é‡åŸºæœ¬å—ä¸å¥½ï¼Œå¯èƒ½ä¸è®­ç»ƒé›†æ²¡æœ‰å‘é‡åŸºæœ¬å—æœ‰å…³ã€‚</li>
<li><strong>OSACA</strong> ç¬¬ä¸‰ã€‚ç”±äºè¿˜åœ¨å¼€å‘ä¸­ï¼Œä½¿ç”¨è¿˜é‡åˆ°5ä¸ªbugã€‚åœ¨é‡åˆ°ä¸€äº›ä¸è®¤è¯†çš„æŒ‡ä»¤çš„æ—¶å€™ï¼Œä¼šç›´æ¥æŒ‰ç…§nopsç©ºæŒ‡ä»¤å¤„ç†ã€‚</li>
</ol>
</li>
<li>Examples of Modeling Bugs<img src="https://pic.shaojiemike.top/img/20211010155758.png"><ol>
<li>æœ€åä¸€ä¸ªä¾‹å­æ˜¯ç”±äºæ¨¡å‹<strong>é”™è¯¯è°ƒåº¦å¾®æŒ‡ä»¤</strong>å¯¼è‡´çš„</li>
<li>Modeling bug due to unsigned division<ol>
<li>ä¾‹å­æ˜¯ a 64-bit by 32-bit unsigned division.<img src="https://pic.shaojiemike.top/img/20211010162409.png"><img src="https://pic.shaojiemike.top/img/20211010163913.png"><img src="https://pic.shaojiemike.top/img/20211010164039.png"><img src="https://pic.shaojiemike.top/img/20211010164455.png"></li>
<li>???<img src="https://pic.shaojiemike.top/img/20211010164745.png"></li>
</ol>
</li>
<li>Modeling bug due to zero-idioms<ol>
<li><img src="https://pic.shaojiemike.top/img/20211010165301.png"></li>
<li>å¯¹è¿™ç§ç»“æœå›ºå®šçš„ç‰¹æ®ŠæŒ‡ä»¤çš„å¿«é€Ÿå¤„ç†ã€‚</li>
</ol>
</li>
<li>Modeling bug due to mis-scheduling<ol>
<li>å¯¹äºæ•°æ®ä¾èµ–ï¼Œä¸Šä¸‹æŒ‡ä»¤çš„å¯„å­˜å™¨æœ‰å†™åè¯»ã€‚</li>
<li>Ithemalâ€™s and OSACAå¿½ç•¥äº†è¯¥ä¾èµ–</li>
<li><img src="https://pic.shaojiemike.top/img/20211010170051.png"></li>
<li>llvm-mca æ²¡æœ‰æ³¨æ„åˆ°(%rcx)æ˜¯memoryï¼Œæ²¡æœ‰ä¾èµ–å¯ä»¥æå‰å‘å°„ã€‚</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="CONCLUSION"><a href="#CONCLUSION" class="headerlink" title="CONCLUSION"></a>CONCLUSION</h2><p>ç°æœ‰çš„é™æ€åˆ†æå™¨å¯¹<strong>å†…å­˜ä¾èµ–</strong>å’Œ<strong>å‘é‡åŒ–å—</strong>çš„å»ºæ¨¡è¿˜æœ‰å›°éš¾ã€‚</p>
<h2 id="githubä»£ç è¯´æ˜"><a href="#githubä»£ç è¯´æ˜" class="headerlink" title="githubä»£ç è¯´æ˜"></a>githubä»£ç è¯´æ˜</h2><ol>
<li><code>benchmark/sources</code>ä¸‹æ˜¯å„ç§è½¯ä»¶çš„å„ä¸ªéƒ¨åˆ†çš„16è¿›åˆ¶åŸºæœ¬ä»£ç å—å’Œå…¶å‡ºç°æ¦‚ç‡ï¼Œç”¨csvæ ¼å¼(é€—å·åˆ†éš”å€¼ (Comma-separated values))å­˜å‚¨</li>
<li><code>benchmark/throughput</code>æ˜¯åœ¨å„ç§æ¶æ„ä¸‹çš„å„åŸºæœ¬å—çš„æµ‹é‡ååé‡ï¼Œå•ä½cycles per hundred-iterations.<br><img src="https://pic.shaojiemike.top/img/20210920151028.png"><img src="https://pic.shaojiemike.top/img/20210920154432.png"></li>
<li><code>benchmark/disasm</code>å¯ä»¥æŠŠ16è¿›åˆ¶ä»£ç é€šè¿‡<code>nasm</code>å˜æˆæ±‡ç¼–ï¼Œ<img src="https://pic.shaojiemike.top/img/20210920151258.png"></li>
<li><code>timing-harness</code><img src="https://pic.shaojiemike.top/img/20210920153113.png"><br><img src="https://pic.shaojiemike.top/img/20210921143255.png"><br>ååé‡çš„è®¡ç®—(çŒœçš„)Skylake microarchitecture$$\frac{6632-1030}{2333-100}*100&#x3D;250.8 (cyc&#x2F;hundred\ iters)$$</li>
</ol>
<h2 id="BHive-è¢«è´¨ç–‘çš„å±€é™æ€§"><a href="#BHive-è¢«è´¨ç–‘çš„å±€é™æ€§" class="headerlink" title="BHive è¢«è´¨ç–‘çš„å±€é™æ€§"></a>BHive è¢«è´¨ç–‘çš„å±€é™æ€§</h2><p>uops çš„æ–‡ç« ï¼Œ Accurate Throughput Prediction of Basic Blocks on Recent Intel Microarchitectures</p>
<p>4.2 Extending BHive</p>
<h2 id="BHive-è¿è¡Œé€»è¾‘"><a href="#BHive-è¿è¡Œé€»è¾‘" class="headerlink" title="BHive è¿è¡Œé€»è¾‘"></a>BHive è¿è¡Œé€»è¾‘</h2><ol>
<li>è¯»å…¥16è¿›åˆ¶ä»£ç å’Œå¾ªç¯æ¬¡æ•°</li>
<li><code>hhex2bin</code>è½¬æ¢ä¸ºäºŒè¿›åˆ¶</li>
<li><code>create_shm_fd</code><img src="https://pic.shaojiemike.top/img/20210922150852.png"><img src="https://pic.shaojiemike.top/img/20210922151143.png"><ol>
<li><p><code>shm_open, shm_unlink</code>creates and opens a new, or opens or unlink an existing, POSIX shared memory object. <code>O_RDWR</code> Open the object for read-write access.<code>O_CREAT</code>  the shared memory object if it does not exist. <code>777</code>æ˜¯ç±»ä¼¼æ–‡ä»¶è¯»å†™æ‰§è¡Œç»„æƒé™çš„ä¸œè¥¿ On success, shm_open() <code>returns</code> a file descriptor (a nonnegative integer)</p>
</li>
<li><p><code>POSIX</code>å¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£The Portable Operating System Interface æ˜¯IEEEä¸ºè¦åœ¨å„ç§UNIXæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œè½¯ä»¶ï¼Œè€Œå®šä¹‰APIçš„ä¸€ç³»åˆ—äº’ç›¸å…³è”çš„æ ‡å‡†çš„æ€»ç§°ã€‚</p>
</li>
<li><p><code>ftruncate</code> â€” truncateæˆªçŸ­ a file to a specified length</p>
</li>
<li><p>#define SIZE_OF_HARNESS_MEM (4096 * 3)</p>
</li>
</ol>
</li>
<li><code>measure</code>å¼€å§‹æµ‹é‡<ol>
<li>int fds[2] ???</li>
<li><code>pipe</code>ç”¨äºåˆ›å»ºpipe,ç”¨æ¥<strong>è¿›ç¨‹é—´</strong>é€šä¿¡çš„<strong>å•å‘</strong>æ•°æ®é€šè·¯ï¼Œä¼ å…¥å˜é‡ç”¨æ¥è¿”å›å¼•ç”¨è‡ªpipeæœ«ç«¯çš„æ–‡ä»¶æè¿°ç¬¦file descriptorsã€‚<strong>ç¬¬ä¸€ä¸ª</strong>æŒ‡å‘the read end of the pipeï¼Œ<strong>ç¬¬äºŒä¸ª</strong>æŒ‡å‘the write end of the pipe</li>
<li><code>mmap(void *addr, size_t length, int prot, int flags,int fd, off_t offset); munmap(void *addr, size_t length);</code>- map or unmap files or devices into memory åœ¨è°ƒç”¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´é‡Œcreate a new mapping.</li>
<li>fork()äº§ç”Ÿå­è¿›ç¨‹<ol>
<li>fork()åŸç†è¯¦è§£<ol>
<li>å¤åˆ¶ä¹‹å‰çš„ä¸€æ¨¡ä¸€æ ·ã€‚</li>
<li>fork() returns a zero to the newly created child process.</li>
<li>fork() returns a positive value, the process ID of the child process, to the parent.</li>
</ol>
</li>
<li>çˆ¶è¿›ç¨‹<ol>
<li>#define OFFSET_TO_COUNTERS 32</li>
<li>ä¸ºä»€ä¹ˆå£°æ˜ä¸€ä¸ªåç§»åœ°å€æŒ‡é’ˆ???<ol>
<li>struct pmc_counters ç”±5ä¸ªuint64_tç»„æˆã€‚ uint64 will always take 8 bytesã€‚ä¸€ä¸ªç»“æ„ä½“40bytes</li>
</ol>
</li>
<li><code>attach_to_child(pid, fds[1]);</code> pidæ˜¯å­è¿›ç¨‹pid<ol>
<li><code>ptrace(enum __ptrace_request request, pid_t pid,void *addr, void *data)</code> - process trace æä¾›ä¸€ç§è¿›ç¨‹tracerè·Ÿè¸ªæ§åˆ¶å¦ä¸€ä¸ªè¿›ç¨‹traceeçš„æ–¹æ³•ï¼Œå¯ä»¥ä¿®æ”¹è¢«æ§åˆ¶è€…çš„memory and registers.<ol>
<li><code>PTRACE_SEIZE</code> Attach to the process specified in pid, making it a tracee of the calling process.  Unlike PTRACE_ATTACH, PTRACE_SEIZE does <strong>not</strong> stop the process</li>
</ol>
</li>
<li>å­è¿›ç¨‹ä»fds[0]é‡Œè¯»åˆ°xé‡Œï¼Œçˆ¶è¿›ç¨‹æŠŠxçš„å€¼å†™å…¥ fds[1] ???</li>
</ol>
</li>
<li>check Performance Monitoring Counters (PMCs) supports<ol>
<li><code>rdpmc_open_attr</code> initialize a raw ring 3 ReaDable PerforMance Counter</li>
</ol>
</li>
<li>last_failing_inst å’Œ mapping_done</li>
<li>To kill child<ol>
<li>#define MAX_FAULTS 1024 # å­è¿›ç¨‹äº§ç”Ÿçš„é”™è¯¯éœ€è¦è§£å†³ï¼Ÿ</li>
<li><code>wait</code>æŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªchildrenç»“æŸï¼Œè¿”å›å…¶PID</li>
<li><code>WIFEXITED</code>Wait_IF_EXITED åˆ¤æ–­æ˜¯å¦æ­£å¸¸ç»“æŸ<img src="https://pic.shaojiemike.top/img/20210922185030.png"></li>
<li>å¦‚æœé”™è¯¯æ‰“å°å‡ºé”™ä¿¡å·(eg.11)æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨RIP,æŒ‡é’ˆå¯„å­˜å™¨RSP<img src="https://pic.shaojiemike.top/img/20210922190632.png"><img src="https://pic.shaojiemike.top/img/20210922191039.png"><img src="https://pic.shaojiemike.top/img/20210922191252.png"></li>
<li>å‡½æ•°æ˜¯ç”¨æ±‡ç¼–å†™çš„å°±ç¦»è°±<img src="https://pic.shaojiemike.top/img/20210922191507.png"><img src="https://pic.shaojiemike.top/img/20210922193149.png"><img src="https://pic.shaojiemike.top/img/20210922192559.png"><img src="https://pic.shaojiemike.top/img/20210922191801.png"><img src="https://pic.shaojiemike.top/img/20210922191931.png">what is aux mem?</li>
<li>ä¿®æ”¹å‡ºé”™åœ°æ–¹çš„å¯„å­˜å™¨ï¼Œé‡æ–°è¿è¡Œ<code>PTRACE_CONT</code> Restart the stopped tracee process</li>
<li>æœ€å¤šæ‰§è¡ŒMAX_FAULTSæ¬¡</li>
</ol>
</li>
<li>æœ€åçˆ¶è¿›ç¨‹æ€æ­»å­è¿›ç¨‹</li>
</ol>
</li>
<li>å­è¿›ç¨‹<ol>
<li>çˆ¶è¿›ç¨‹æµ‹è¯•æ˜¯å¦æ”¯æŒPMCs,å­è¿›ç¨‹ä½¿ç”¨<img src="https://pic.shaojiemike.top/img/20210922194738.png"><img src="https://pic.shaojiemike.top/img/20210922195030.png"></li>
<li>harness.c ï¼š277</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/from-zero/p/13750852.html">https://www.cnblogs.com/from-zero/p/13750852.html</a></p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><ol>
<li>time æ€ä¹ˆç®—çš„the latency of the basic blockï¼Ÿä¸ºä»€ä¹ˆæ‰“å°15ä¸ªå‘¢ï¼Ÿ</li>
<li>è¿˜æœ‰ä¸­é—´çš„é”™è¯¯æ˜¯æ€ä¹ˆå›äº‹?</li>
<li>è®ºæ–‡é‡Œçš„è¯¯å·®æ€ä¹ˆç®—çš„ï¼Ÿ<ol>
<li>BHiveæ•´åˆäº†å‡ ä¸ªè½¯ä»¶ï¼ˆæ•´åˆäº†ä»€ä¹ˆå‘¢ï¼‰ï¼Œåº”è¯¥æ˜¯çœŸå®æµ‹é‡äº†å¾—å‡ºçœŸå®ååé‡ï¼Ÿè¿˜æ˜¯ä¹Ÿæ˜¯æ¨¡æ‹Ÿçš„ï¼Ÿ</li>
<li>å’Œuopsæ¯”æ€ä¹ˆæ ·</li>
</ol>
</li>
<li>å“ªä¸ªæ•°æ®æ˜¯å‡†ç¡®çš„ï¼Œæ˜¯BHiveæ¨¡æ‹Ÿçš„ï¼Œè¿˜æ˜¯çœŸå®æµ‹é‡çš„ã€‚<ol>
<li>é€šè¿‡ Agner Fogâ€™s script æµ‹é‡çœŸå®çš„ï¼Œæœ‰å‘¨æœŸï¼Œcache miss ç­‰ç­‰ã€‚<a target="_blank" rel="noopener" href="https://www.agner.org/optimize/testp.zip">https://www.agner.org/optimize/testp.zip</a></li>
<li>nanoBenchä¹Ÿæ˜¯ã€‚<a target="_blank" rel="noopener" href="https://github.com/andreas-abel/nanoBench">https://github.com/andreas-abel/nanoBench</a> å¯ä»¥æŒ‡å®šprocessor?å’Œ kernelæ¨¡å¼ã€‚</li>
<li>å±€é™æ€§æ˜¯ï¼Œå¿…é¡»äººå·¥ç»™ä»£ç å—ï¼Œä¸èƒ½è‡ªåŠ¨profileä¸€å †ä»»æ„çš„åŸºæœ¬å—æ¥ç³»ç»Ÿæ€§éªŒè¯ã€‚???</li>
</ol>
</li>
<li>BHvieçš„ä»£ç å®ç°ï¼Œç§»æ¤åˆ°é²²é¹ï¼Œç„¶åæ ¹æ®PMUè°ƒå‡†ã€‚</li>
</ol>
<p>é—®é¢˜æ˜¯x86çš„äºŒè¿›åˆ¶æˆ–è€…æ±‡ç¼–ä¸èƒ½å˜æˆaarm64çš„äºŒè¿›åˆ¶æˆ–è€…æ±‡ç¼–ã€‚</p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a target="_blank" rel="noopener" href="https://github.com/ithemal/bhive">https://github.com/ithemal/bhive</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-09-15T02:29:03.000Z" title="9/15/2021, 2:29:03 AM">2021-09-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-20T14:27:06.373Z" title="1/20/2024, 2:27:06 PM">2024-01-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">6 minutes read (About 895 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/09/15/Work/HPC/llvm-mca/LLVM-mca2/">LLVM-MCA: Install&amp;RunTests</a></p><div class="content"><h2 id="github"><a href="#github" class="headerlink" title="github"></a>github</h2><p><a target="_blank" rel="noopener" href="https://github.com/llvm/llvm-project/tree/main/llvm/tools/llvm-mca">https://github.com/llvm/llvm-project/tree/main/llvm/tools/llvm-mca</a></p>
<p><img src="https://pic.shaojiemike.top/img/20210910210630.png"></p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p><a target="_blank" rel="noopener" href="https://github.com/llvm/llvm-project/releases/tag/llvmorg-12.0.1">ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶</a>ä¸Šä¼ æœåŠ¡å™¨ï¼Œè§£å‹</p>
<h3 id="å®‰è£…é‡åˆ°çš„é—®é¢˜"><a href="#å®‰è£…é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å®‰è£…é‡åˆ°çš„é—®é¢˜"></a>å®‰è£…é‡åˆ°çš„é—®é¢˜</h3><ol>
<li>cannot find libtinfo.so.5<ol>
<li>sudo apt install libncurses5</li>
<li>ln -s &#x2F;usr&#x2F;lib&#x2F;libncursesw.so.6 &#x2F;usr&#x2F;lib&#x2F;libtinfo.so.5 æˆ–è€…ç±»ä¼¼çš„ ln -s &#x2F;usr&#x2F;lib&#x2F;libncurses.so.5 &#x2F;usr&#x2F;lib&#x2F;libtinfo.so.5 </li>
<li>åœ¨&#x2F;snap&#x2F;coreä¸‹æ‰¾åˆ°äº†ï¼Œä½†æ˜¯è¿™æ˜¯ä»€ä¹ˆç›®å½•ï¼Ÿæ˜¯ä¹‹å‰Ubuntuçš„åŒ…ç®¡ç†å·¥å…·ï¼Œä½†æ˜¯å·²ç»ä¸ç”¨äº†ã€‚</li>
</ol>
</li>
</ol>
<h3 id="ä»æºç å®‰è£…"><a href="#ä»æºç å®‰è£…" class="headerlink" title="ä»æºç å®‰è£…"></a>ä»æºç å®‰è£…</h3><h3 id="node5"><a href="#node5" class="headerlink" title="node5"></a>node5</h3><p>ç”±äºä¹‹åè¦å†™ä»£ç çš„ï¼Œè¿˜æ˜¯ä»å¤´å®‰è£…æ›´å¥½ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd llvm-project</span><br><span class="line">mkdir build</span><br><span class="line">cmake -S llvm -B build -G &quot;Unix Makefiles&quot; -DLLVM_ENABLE_PROJECTS=&quot;clang;llvm-mca&quot; -DCMAKE_INSTALL_PREFIX=&quot;~/Install/llvm&quot; -DCMAKE_BUILD_TYPE=Debug -DLLVM_ENABLE_ASSERTIONS=On</span><br><span class="line">cd build</span><br><span class="line">make -j32</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h3 id="kunpeng"><a href="#kunpeng" class="headerlink" title="kunpeng"></a>kunpeng</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake -S llvm -B build -G &quot;Unix Makefiles&quot; -DLLVM_ENABLE_PROJECTS=all -DCMAKE_INSTALL_PREFIX=&quot;~/Install/llvm&quot; -DCMAKE_BUILD_TYPE=Debug -DLLVM_ENABLE_ASSERTIONS=On</span><br><span class="line">#change cmake or -DLLVM_ENABLE_PROJECTS=&quot;all&quot;</span><br></pre></td></tr></table></figure>
<p>error</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">g++: error: unrecognized command line option â€˜-mllvmâ€™</span><br><span class="line">g++: error: unrecognized command line option â€˜--tail-merge-threshold=0â€™</span><br><span class="line">g++: error: unrecognized command line option â€˜-combiner-global-alias-analysisâ€™</span><br></pre></td></tr></table></figure>
<p>change</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -S llvm -B build -G &quot;Unix Makefiles&quot; -DLLVM_ENABLE_PROJECTS=&quot;clang;llvm-mca&quot; -DCMAKE_INSTALL_PREFIX=&quot;~/Install/llvm&quot; -DLLVM_TARGETS_TO_BUILD=AArch64 -DCMAKE_BUILD_TYPE=Debug -DLLVM_ENABLE_ASSERTIONS=On</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang foo.c -O2 -target x86_64-unknown-unknown -S -o - | llvm-mca -mcpu=btver2</span><br></pre></td></tr></table></figure>
<p>ç”±äºä¸æ˜¯X86,<code>llc --version</code> æŸ¥çœ‹åˆ°targetæ˜¯ <code>aarch64-unknown-linux-gnu</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang /home/shaojiemike/Download/llvm-project-main/lldb/test/API/lang/c/forward/foo.c -O2 -target aarch64-unknown-linux-gnu -S -o -|llvm-mca -timeline -show-encoding -all-stats -all-views</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆæ±‡ç¼–ä»£ç ï¼Œå¹¶é»˜è®¤ç®¡é“åˆ°llvm-mca,å¹¶å¼€å¯æ‰€æœ‰è¾“å‡ºã€‚</p>
<p>å¯ä»¥çœ‹å‡ºæ˜¯ç”¨TSV110Unitçš„port,é»˜è®¤cpuæ˜¯tsv110</p>
<h2 id="åè¯è§£é‡Š"><a href="#åè¯è§£é‡Š" class="headerlink" title="åè¯è§£é‡Š"></a>åè¯è§£é‡Š</h2><h3 id="ALU-BRU"><a href="#ALU-BRU" class="headerlink" title="ALU&#x2F;BRU"></a>ALU&#x2F;BRU</h3><p> ç®—æ•°é€»è¾‘å•å…ƒ ALU è´Ÿè´£å¤„ç†æ•´æ•°è¿ç®—æŒ‡ä»¤. è·³è½¬å¤„ç†å•å…ƒBRU è´Ÿè´£å¤„ç†è·³è½¬æŒ‡ä»¤. BRU å¯ä»¥ä¸ ALU åˆå¹¶, å¤ç”¨ ALU çš„é€»è¾‘æ¥è®¡ç®—è·³è½¬æŒ‡ä»¤çš„æ¡ä»¶å’Œè·³è½¬åœ°å€, ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„åŠŸèƒ½å•å…ƒæ¥å…¥åˆ°æµæ°´çº¿ä¸­.</p>
<h3 id="MDU"><a href="#MDU" class="headerlink" title="MDU"></a>MDU</h3><p>ä¹˜é™¤æ³•å•å…ƒ MDU (mult-divide unit)</p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><ol>
<li>llvm-mcaå¾®æŒ‡ä»¤æ€ä¹ˆå®ç°çš„,æ€ä¹ˆæŠŠæ±‡ç¼–å˜æˆå¾®æŒ‡ä»¤</li>
<li>åœ¨viewé‡ŒåŠ memoryçš„å®ç°</li>
<li>è€ƒè™‘äº†cacheå‘½ä¸­ç­‰å½±å“ <a target="_blank" rel="noopener" href="https://github.com/andreas-abel/uiCA">https://github.com/andreas-abel/uiCA</a> uops</li>
<li>é²²é¹æ¶æ„ <a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/community/usersnew/id_1513665626477516">https://bbs.huaweicloud.com/community/usersnew/id_1513665626477516</a></li>
</ol>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><ol>
<li><code>llvm-mca -mcpu=help</code>ç«Ÿç„¶ä¼šå¡ä½ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</li>
<li>æ‰€ä»¥è¯´æ˜¯åä¸ºå·²ç»å†™äº†ä¸€ä¸ªå«tsv110çš„ï¼Œå®ç°2ä¸ªåŠŸèƒ½ï¼Ÿ</li>
</ol>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><div id='refer-anchor'></div>
æ— 

<h2 id="æ ·ä¾‹è¾“å‡º"><a href="#æ ·ä¾‹è¾“å‡º" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">Iterations:        100</span><br><span class="line">Instructions:      200</span><br><span class="line">Total Cycles:      70</span><br><span class="line">Total uOps:        200</span><br><span class="line"></span><br><span class="line">Dispatch Width:    4</span><br><span class="line">uOps Per Cycle:    2.86</span><br><span class="line">IPC:               2.86</span><br><span class="line">Block RThroughput: 0.5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">No resource or data dependency bottlenecks discovered.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Instruction Info:</span><br><span class="line">[1]: #uOps</span><br><span class="line">[2]: Latency</span><br><span class="line">[3]: RThroughput</span><br><span class="line">[4]: MayLoad</span><br><span class="line">[5]: MayStore</span><br><span class="line">[6]: HasSideEffects (U)</span><br><span class="line">[7]: Encoding Size</span><br><span class="line"></span><br><span class="line">[1]    [2]    [3]    [4]    [5]    [6]    [7]    Encodings:                    Instructions:</span><br><span class="line"> 1      1     0.33                         4     20 00 80 52                   mov	w0, #1</span><br><span class="line"> 1      1     0.50                  U      4     c0 03 5f d6                   ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Dynamic Dispatch Stall Cycles:</span><br><span class="line">RAT     - Register unavailable:                      0</span><br><span class="line">RCU     - Retire tokens unavailable:                 0</span><br><span class="line">SCHEDQ  - Scheduler full:                            0</span><br><span class="line">LQ      - Load queue full:                           0</span><br><span class="line">SQ      - Store queue full:                          0</span><br><span class="line">GROUP   - Static restrictions on the dispatch group: 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Dispatch Logic - number of cycles where we saw N micro opcodes dispatched:</span><br><span class="line">[# dispatched], [# cycles]</span><br><span class="line"> 0,              20  (28.6%)</span><br><span class="line"> 4,              50  (71.4%)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Schedulers - number of cycles where we saw N micro opcodes issued:</span><br><span class="line">[# issued], [# cycles]</span><br><span class="line"> 0,          3  (4.3%)</span><br><span class="line"> 2,          1  (1.4%)</span><br><span class="line"> 3,          66  (94.3%)</span><br><span class="line"></span><br><span class="line">Scheduler&#x27;s queue usage:</span><br><span class="line">No scheduler resources used.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Retire Control Unit - number of cycles where we saw N instructions retired:</span><br><span class="line">[# retired], [# cycles]</span><br><span class="line"> 0,           3  (4.3%)</span><br><span class="line"> 2,           1  (1.4%)</span><br><span class="line"> 3,           66  (94.3%)</span><br><span class="line"></span><br><span class="line">Total ROB Entries:                128</span><br><span class="line">Max Used ROB Entries:             59  ( 46.1% )</span><br><span class="line">Average Used ROB Entries per cy:  32  ( 25.0% )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Register File statistics:</span><br><span class="line">Total number of mappings created:    100</span><br><span class="line">Max number of mappings used:         29</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Resources:</span><br><span class="line">[0.0] - TSV110UnitAB</span><br><span class="line">[0.1] - TSV110UnitAB</span><br><span class="line">[1]   - TSV110UnitALU</span><br><span class="line">[2]   - TSV110UnitFSU1</span><br><span class="line">[3]   - TSV110UnitFSU2</span><br><span class="line">[4.0] - TSV110UnitLdSt</span><br><span class="line">[4.1] - TSV110UnitLdSt</span><br><span class="line">[5]   - TSV110UnitMDU</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Resource pressure per iteration:</span><br><span class="line">[0.0]  [0.1]  [1]    [2]    [3]    [4.0]  [4.1]  [5]    </span><br><span class="line">0.66   0.67   0.67    -      -      -      -      -     </span><br><span class="line"></span><br><span class="line">Resource pressure by instruction:</span><br><span class="line">[0.0]  [0.1]  [1]    [2]    [3]    [4.0]  [4.1]  [5]    Instructions:</span><br><span class="line">0.33    -     0.67    -      -      -      -      -     mov	w0, #1</span><br><span class="line">0.33   0.67    -      -      -      -      -      -     ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Timeline view:</span><br><span class="line">Index     0123456789</span><br><span class="line"></span><br><span class="line">[0,0]     DeER .   .   mov	w0, #1</span><br><span class="line">[0,1]     DeER .   .   ret</span><br><span class="line">[1,0]     DeER .   .   mov	w0, #1</span><br><span class="line">[1,1]     D=eER.   .   ret</span><br><span class="line">[2,0]     .DeER.   .   mov	w0, #1</span><br><span class="line">[2,1]     .DeER.   .   ret</span><br><span class="line">[3,0]     .D=eER   .   mov	w0, #1</span><br><span class="line">[3,1]     .D=eER   .   ret</span><br><span class="line">[4,0]     . DeER   .   mov	w0, #1</span><br><span class="line">[4,1]     . D=eER  .   ret</span><br><span class="line">[5,0]     . D=eER  .   mov	w0, #1</span><br><span class="line">[5,1]     . D=eER  .   ret</span><br><span class="line">[6,0]     .  D=eER .   mov	w0, #1</span><br><span class="line">[6,1]     .  D=eER .   ret</span><br><span class="line">[7,0]     .  D=eER .   mov	w0, #1</span><br><span class="line">[7,1]     .  D==eER.   ret</span><br><span class="line">[8,0]     .   D=eER.   mov	w0, #1</span><br><span class="line">[8,1]     .   D=eER.   ret</span><br><span class="line">[9,0]     .   D==eER   mov	w0, #1</span><br><span class="line">[9,1]     .   D==eER   ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Average Wait times (based on the timeline view):</span><br><span class="line">[0]: Executions</span><br><span class="line">[1]: Average time spent waiting in a scheduler&#x27;s queue</span><br><span class="line">[2]: Average time spent waiting in a scheduler&#x27;s queue while ready</span><br><span class="line">[3]: Average time elapsed from WB until retire stage</span><br><span class="line"></span><br><span class="line">      [0]    [1]    [2]    [3]</span><br><span class="line">0.     10    1.7    1.7    0.0       mov	w0, #1</span><br><span class="line">1.     10    2.0    2.0    0.0       ret</span><br><span class="line">       10    1.9    1.9    0.0       &lt;total&gt;</span><br></pre></td></tr></table></figure>

</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/categories/Tutorials/page/8/">Previous</a></div><div class="pagination-next"><a href="/categories/Tutorials/page/10/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/categories/Tutorials/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/categories/Tutorials/page/8/">8</a></li><li><a class="pagination-link is-current" href="/categories/Tutorials/page/9/">9</a></li><li><a class="pagination-link" href="/categories/Tutorials/page/10/">10</a></li><li><a class="pagination-link" href="/categories/Tutorials/page/11/">11</a></li><li><a class="pagination-link" href="/categories/Tutorials/page/12/">12</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="Shaojie Tan"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Shaojie Tan</p><p class="is-size-6 is-block">ğ˜Šğ˜°ğ˜®ğ˜±ğ˜¶ğ˜µğ˜¦ğ˜³ ğ˜ˆğ˜³ğ˜¤ğ˜©ğ˜ªğ˜µğ˜¦ğ˜¤ğ˜µğ˜¶ğ˜³ğ˜¦ &amp; ğ˜ğ˜—ğ˜Š</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Anhui, Hefei, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">386</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">31</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">487</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Kirrito-k423" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Kirrito-k423"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithms/"><span class="level-start"><span class="level-item">Algorithms</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/Architecture/"><span class="level-start"><span class="level-item">Architecture</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile" href="/categories/Artificial-Intelligence/"><span class="level-start"><span class="level-item">Artificial Intelligence</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Databases/"><span class="level-start"><span class="level-item">Databases</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/HPC/"><span class="level-start"><span class="level-item">HPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math/"><span class="level-start"><span class="level-item">Math</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/Operating-system/"><span class="level-start"><span class="level-item">Operating system</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Overview/"><span class="level-start"><span class="level-item">Overview</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile" href="/categories/Software/"><span class="level-start"><span class="level-item">Software</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Thinking/"><span class="level-start"><span class="level-item">Thinking</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Tips/"><span class="level-start"><span class="level-item">Tips</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Treasure/"><span class="level-start"><span class="level-item">Treasure</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tutorials/"><span class="level-start"><span class="level-item">Tutorials</span></span><span class="level-end"><span class="level-item tag">118</span></span></a></li><li><a class="level is-mobile" href="/categories/Values/"><span class="level-start"><span class="level-item">Values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/architecture/"><span class="level-start"><span class="level-item">architecture</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/diary/"><span class="level-start"><span class="level-item">diary</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/english/"><span class="level-start"><span class="level-item">english</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/hardware/"><span class="level-start"><span class="level-item">hardware</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/math/"><span class="level-start"><span class="level-item">math</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/network/"><span class="level-start"><span class="level-item">network</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/operating-system/"><span class="level-start"><span class="level-item">operating system</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/security/"><span class="level-start"><span class="level-item">security</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/software/"><span class="level-start"><span class="level-item">software</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/thinking/"><span class="level-start"><span class="level-item">thinking</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/thinking/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/tips/"><span class="level-start"><span class="level-item">tips</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/toLearn/"><span class="level-start"><span class="level-item">toLearn</span></span><span class="level-end"><span class="level-item tag">51</span></span></a></li><li><a class="level is-mobile" href="/categories/values/"><span class="level-start"><span class="level-item">values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://ibug.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ibugs</span></span><span class="level-right"><span class="level-item tag">ibug.io</span></span></a></li><li><a class="level is-mobile" href="https://jia.je/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">jiegec</span></span><span class="level-right"><span class="level-item tag">jia.je</span></span></a></li><li><a class="level is-mobile" href="https://leimao.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">leimao</span></span><span class="level-right"><span class="level-item tag">leimao.github.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-13T14:32:40.000Z">2024-01-13</time></p><p class="title"><a href="/2024/01/13/Thinking/2-courage2move/SocialScience/">Social Science</a></p><p class="categories"><a href="/categories/Thinking/">Thinking</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-13T12:15:22.000Z">2024-01-13</time></p><p class="title"><a href="/2024/01/13/Work/Architecture/FPGA/">FPGA</a></p><p class="categories"><a href="/categories/toLearn/">toLearn</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-13T08:02:52.000Z">2024-01-13</time></p><p class="title"><a href="/2024/01/13/Work/Architecture/workloadPriority/">Workload Characterization &amp; Priority &amp; Scheduler to CPU/GPU/PIM</a></p><p class="categories"><a href="/categories/Architecture/">Architecture</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-12T12:16:43.000Z">2024-01-12</time></p><p class="title"><a href="/2024/01/12/OutOfWork/5-VideoEntertainment/AutoFreePTDownloadRSS/">Auto Free PT Download using RSS and Flexget</a></p><p class="categories"><a href="/categories/toLearn/">toLearn</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-10T12:00:31.000Z">2024-01-10</time></p><p class="title"><a href="/2024/01/10/Work/Programming/2-languageGrammar/OpenCLBasic/">OpenCL Basic</a></p><p class="categories"><a href="/categories/Programming/">Programming</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/"><span class="level-start"><span class="level-item">2024</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">235</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">67</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/"><span class="level-start"><span class="level-item">2021</span></span><span class="level-end"><span class="level-item tag">72</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/5G/"><span class="tag">5G</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/64bits-vs-32bits/"><span class="tag">64bits vs 32bits</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMAT/"><span class="tag">AMAT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMD/"><span class="tag">AMD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ASPLOS/"><span class="tag">ASPLOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ATI/"><span class="tag">ATI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AVX/"><span class="tag">AVX</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Alpha/"><span class="tag">Alpha</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Analysis/"><span class="tag">Analysis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apt/"><span class="tag">Apt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Assembly/"><span class="tag">Assembly</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BFS/"><span class="tag">BFS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BHive/"><span class="tag">BHive</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BT/"><span class="tag">BT</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BTL/"><span class="tag">BTL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Baka-Mitai/"><span class="tag">Baka Mitai</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bash/"><span class="tag">Bash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Big-Endian/"><span class="tag">Big-Endian</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a><p class="is-size-7"><span>&copy; 2024 Shaojie Tan</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>