<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>Category: toLearn - SHAOJIE&#039;S BOOK</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="SHAOJIE&#039;S BOOK"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SHAOJIE&#039;S BOOK"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="SHAOJIE&#039;S BOOK"><meta property="og:url" content="http://icarus.shaojiemike.top/"><meta property="og:site_name" content="SHAOJIE&#039;S BOOK"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://icarus.shaojiemike.top/img/og_image.png"><meta property="article:author" content="Shaojie Tan"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://icarus.shaojiemike.top/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://icarus.shaojiemike.top"},"headline":"SHAOJIE'S BOOK","image":["http://icarus.shaojiemike.top/img/og_image.png"],"author":{"@type":"Person","name":"Shaojie Tan"},"publisher":{"@type":"Organization","name":"SHAOJIE'S BOOK","logo":{"@type":"ImageObject","url":"http://icarus.shaojiemike.top/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">Categories</a></li><li class="is-active"><a href="#" aria-current="page">toLearn</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-09-07T16:00:00.000Z" title="9/7/2023, 4:00:00 PM">2023-09-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.249Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">17 minutes read (About 2529 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/09/07/Work/software/linux-sys/wakeUpProcess/">Wake Up Process</a></p><div class="content"><h2 id="Linux-多进程的竞争休眠机制"><a href="#Linux-多进程的竞争休眠机制" class="headerlink" title="Linux 多进程的竞争休眠机制"></a>Linux 多进程的竞争休眠机制</h2><p>基本是基于Linux的时间片轮转机制。A process&#x2F;thread is woken up by inserting it in the queue of processes&#x2F;threads to be scheduled.</p>
<h2 id="内核调度算法"><a href="#内核调度算法" class="headerlink" title="内核调度算法"></a>内核调度算法</h2><p>CFS（Completely Fair Scheduler）是一种用于 Linux 操作系统的调度算法，它旨在实现对 CPU 时间的公平分配。CFS 是 Linux 内核中默认的调度器，自 Linux 2.6.23 版本以来就成为了标准调度器。</p>
<p>CFS 调度算法的主要目标是确保各个任务在相同的时间片内能够获得公平的CPU时间，不会因为优先级等因素而造成资源争夺不均。以下是 CFS 调度算法的一些关键特点和原则：</p>
<ol>
<li><p><strong>虚拟化时钟：</strong> CFS 使用了一种称为虚拟化时钟（virtual runtime）的概念，而不是传统的时间片。每个任务都有一个虚拟运行时间，调度器根据虚拟运行时间来决定哪个任务应该被调度。</p>
</li>
<li><p><strong>权重：</strong> CFS 引入了权重的概念，用于调整不同任务的相对优先级。较高权重的任务会在相同时间间隔内获得更多的虚拟运行时间，从而实现按比例分配CPU资源。</p>
</li>
<li><p><strong>累积虚拟运行时间：</strong> 调度器会根据每个任务的权重和已累积的虚拟运行时间，计算出每个任务的应有的虚拟运行时间片。任务在使用完它的时间片后，会根据虚拟运行时间进行重新排队。</p>
</li>
<li><p><strong>红黑树结构：</strong> CFS 使用红黑树来管理任务队列，这种数据结构使得在插入、删除和搜索任务时的时间复杂度保持在对数级别。</p>
</li>
</ol>
<p>除了 CFS，Linux 内核还有其他调度算法，如：</p>
<ul>
<li><p><strong>实时调度器（Real-Time Scheduler）：</strong> 用于实时任务，提供硬实时和软实时的调度策略，确保实时任务在指定的时间内执行完成。</p>
</li>
<li><p><strong>O(1) 调度器（O(1) Scheduler）：</strong> 是 Linux 2.4 内核中使用的调度器，它的时间复杂度为常数级别。然而，随着多核系统的出现，O(1) 调度器在多核环境下的性能表现受到限制，因此被 CFS 替代。</p>
</li>
</ul>
<p>这些调度算法在不同的场景和需求下，对于多任务操作系统的调度提供了不同的方法和策略。选择适合的调度算法可以根据系统的应用和性能要求来进行。</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>在高强度竞争之后，有些进程陷入长期sleep，并且在核空闲的时候，也不再重新运行？为什么？</p>
<p>原因可能是程序逻辑阻塞了，或者在等待IO</p>
<h2 id="查看进程Sleep的原因"><a href="#查看进程Sleep的原因" class="headerlink" title="查看进程Sleep的原因"></a>查看进程Sleep的原因</h2><p>首先 计算机对一个进程是如何判断sleep的，是某时间内的计算占比低于某个阈值吗？</p>
<p>htop <code>s</code> 可以查看kernel 是不是阻塞， <code>l</code>  可以查看是不是读写同一个文件导致阻塞了。</p>
<p>Sleep的<a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/252507/how-can-i-wake-a-process-from-sleep-status-via-signal-or-proc">瓶颈</a>在哪里</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/154f95084d48">sleep for what, waiting for what?</a></p>
<h2 id="实践1-strace"><a href="#实践1-strace" class="headerlink" title="实践1 strace"></a>实践1 strace</h2><p><code>strace -p PID</code> 可以<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/154f95084d48">显示</a>一些信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ strace -p 4005042</span><br><span class="line">  wait4(-1, <span class="comment"># 等待任意子进程结束</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># check subprocess</span></span><br><span class="line">$ pstree -p 4005042</span><br><span class="line">pinbin(4005042)---BC_Compute(4005082)-+-&#123;BC_Compute&#125;(4005187)</span><br><span class="line">                                      |-&#123;BC_Compute&#125;(4005188)</span><br><span class="line">                                      |-&#123;BC_Compute&#125;(4005252)</span><br><span class="line">                                      |-&#123;BC_Compute&#125;(4005296)</span><br><span class="line">                                      |-&#123;BC_Compute&#125;(4005299)</span><br><span class="line">                                      `-&#123;BC_Compute&#125;(4005302)</span><br><span class="line"></span><br><span class="line">$ strace -p 4005082</span><br><span class="line">strace: Process 4005082 attached</span><br><span class="line">futex(0x7fffe52de1b8, FUTEX_WAIT, 2, NULL</span><br><span class="line"><span class="comment"># futex - fast user-space locking(seems to be used in OpenMP)</span></span><br><span class="line"><span class="comment"># It is typically used as a blocking construct in the context of shared-memory synchronization. </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ strace -p 4005188</span><br><span class="line">nanosleep(&#123;tv_sec=0, tv_nsec=2000000&#125;, 0x7fffe5368bc0) = 0 <span class="comment"># repeat</span></span><br><span class="line">nanosleep(&#123;tv_sec=0, tv_nsec=2000000&#125;, 0x7fffe536dbc0) = 0</span><br></pre></td></tr></table></figure>

<p>It seems this is a subprocess repeating sleep leading to all other process to wait in the synchronization.</p>
<p>Use <code>gdb -p PID</code> to attach the process to locate the infinite loop (need Debug Symbols).</p>
<h3 id="futex解释"><a href="#futex解释" class="headerlink" title="futex解释"></a>futex解释</h3><p><code>futex</code> 是 Linux 下的一个系统调用，用于实现用户空间线程间的同步和通信。让我们逐个解释这个系统调用中的每个参数的含义：</p>
<ol>
<li><code>0x7fffe52de1b8</code>: 这是一个指向内存地址的指针（或称为地址），通常是用于表示需要同步的资源或变量的地址。在这里，它表示需要等待的共享资源或变量的地址。</li>
<li><code>FUTEX_WAIT</code>: 这是一个指定 futex 要执行的操作的标志。<code>FUTEX_WAIT</code> 表示线程正在等待 futex 的值发生变化，即等待条件满足。当某个线程执行 <code>FUTEX_WAIT</code> 操作时，如果 futex 的值与预期不符，则该线程将被置于休眠状态，直到 futex 的值发生变化或超时。</li>
<li><code>2</code>: 这是一个表示期望的 futex 值的参数。当调用 <code>FUTEX_WAIT</code> 时，线程将检查 futex 的当前值是否等于此参数指定的值。如果不等于，则线程将休眠等待。</li>
<li><code>NULL</code>: 这是一个指向 timespec 结构的指针，用于设置超时。这里为 <code>NULL</code> 表示调用没有设置超时，即线程将一直等待，直到 futex 的值发生变化。</li>
</ol>
<p>总的来说，<code>futex(0x7fffe52de1b8, FUTEX_WAIT, 2, NULL)</code> 表示线程正在等待位于内存地址 <code>0x7fffe52de1b8</code> 的 futex 变量的值等于 2。如果 futex 的值不是 2，则线程将一直等待直到 futex 的值变为 2 或者超时。这样的同步机制在多线程编程中用于等待条件满足后再执行某些操作，从而避免资源竞争和提高程序的并发性能。</p>
<h3 id="nanosleep解释"><a href="#nanosleep解释" class="headerlink" title="nanosleep解释"></a>nanosleep解释</h3><p>这是一个系统调用 <code>nanosleep</code> 的输出，通常用于让线程休眠一段时间。让我们逐个解释这个系统调用的含义：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nanosleep(&#123;tv_sec=0, tv_nsec=2000000&#125;, 0x7fffe5368bc0) = 0</span><br></pre></td></tr></table></figure>

<ol>
<li><p><code>nanosleep</code>: 这是 Linux 下的一个系统调用，用于使线程休眠一段指定的时间。</p>
</li>
<li><p><code>&#123;tv_sec=0, tv_nsec=2000000&#125;</code>: 这是传递给 <code>nanosleep</code> 的第一个参数，是一个指向 <code>timespec</code> 结构的指针。<code>timespec</code> 结构用于表示时间间隔，包括秒（<code>tv_sec</code>）和纳秒（<code>tv_nsec</code>）。</p>
<p>在这里，<code>tv_sec=0</code> 表示秒数为 0，<code>tv_nsec=2000000</code> 表示纳秒数为 2000000。因此，这个 <code>nanosleep</code> 调用将会使线程休眠 2 毫秒（1 秒 &#x3D; 1000000000 纳秒，所以 2000000 纳秒就是 2 毫秒）。</p>
</li>
<li><p><code>0x7fffe5368bc0</code>: 这是传递给 <code>nanosleep</code> 的第二个参数，表示一个 <code>timespec</code> 结构的指针。这个参数用于存放未休眠完成的剩余时间，如果 <code>nanosleep</code> 被中断（例如收到信号），它将在这个指针中返回剩余的时间。在这个输出中，剩余时间被存储在内存地址 <code>0x7fffe5368bc0</code> 处。</p>
</li>
<li><p><code>= 0</code>: 这是 <code>nanosleep</code> 的返回值，表示成功完成。返回值为 0 表示 <code>nanosleep</code> 成功休眠了指定的时间。</p>
</li>
</ol>
<p>综上所述，这个输出表示线程成功休眠了 2 毫秒。</p>
<h2 id="实践2-zsim模拟程序"><a href="#实践2-zsim模拟程序" class="headerlink" title="实践2: zsim模拟程序"></a>实践2: zsim模拟程序</h2><p>程序直接执行正常，zsim模拟直接sleep？</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ strace -p 303359</span><br><span class="line"><span class="built_in">read</span>(10,</span><br><span class="line"></span><br><span class="line">$ pstree -p 303359                                                                                 │</span><br><span class="line">gups_vanilla(303359)-+-gups_vanilla(303449)-+-orted+                                               │</span><br><span class="line">                     |                      `-&#123;gups+                                               │</span><br><span class="line">                     |-&#123;gups_vanilla&#125;(303360)                                                      │</span><br><span class="line">                     |-&#123;gups_vanilla&#125;(303361)</span><br><span class="line"></span><br><span class="line">$ pstree -p 303449                                                                                 │</span><br><span class="line">gups_vanilla(303449)-+-orted(303451)-+-&#123;orted&#125;(303452)                                             │</span><br><span class="line">                     |               |-&#123;orted&#125;(303642)                                             │</span><br><span class="line">                     |               |-&#123;orted&#125;(303643)                                             │</span><br><span class="line">                     |               `-&#123;orted&#125;(303644)                                             │</span><br><span class="line">                     `-&#123;gups_vanilla&#125;(303450)</span><br></pre></td></tr></table></figure>

<p>这是一个 Open MPI（Message Passing Interface）的启动命令，用于启动一个 MPI 程序，并配置一些运行时参数。让我们逐个解释这个命令中的每个选项和参数的含义：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">orted --hnp --set-sid --report-uri 11 --singleton-died-pipe 12 -mca state_novm_select 1 -mca ess hnp -mca pmix ^s1,s2,cray,isolated</span><br></pre></td></tr></table></figure>

<p>部分参数含义如下：</p>
<ul>
<li><code>orted</code>: 这是 Open MPI 的一个工具，用于启动和管理 MPI 进程。</li>
<li><code>-mca state_novm_select 1</code>: 这是一个 MCA（Modular Component Architecture）选项，用于指定某个模块或组件的参数设置。在这里，<code>state_novm_select</code> 设置为 1，可能是指定某个组件或模块在运行时的选项。</li>
<li><code>-mca pmix ^s1,s2,cray,isolated</code>: 这是另一个 MCA 选项，用于配置 PMIx（Process Management Interface for Exascale）的相关设置。<code>^s1,s2,cray,isolated</code> 表示排除 s1、s2、cray 和 isolated 这些模块，可能是禁用某些特定的组件或功能。</li>
</ul>
<table>
<thead>
<tr>
<th>pid</th>
<th>strace output</th>
<th>explanation</th>
</tr>
</thead>
<tbody><tr>
<td>303451</td>
<td>restart_syscall(&lt;… resuming interrupted read …&gt;</td>
<td></td>
</tr>
<tr>
<td>303452</td>
<td>futex(0xabba001ec8, FUTEX_WAIT, 2, NULL</td>
<td></td>
</tr>
<tr>
<td>303642</td>
<td>epoll_wait(18, …</td>
<td>epoll_wait 系统调用，用于等待文件描述符18上的事件</td>
</tr>
<tr>
<td>303643</td>
<td>select(50, [48 49], NULL, NULL, {tv_sec&#x3D;2, tv_usec&#x3D;0}</td>
<td>如下</td>
</tr>
<tr>
<td>303644</td>
<td>select(53, [51 52], NULL, NULL, {tv_sec&#x3D;2167, tv_usec&#x3D;944465}</td>
<td></td>
</tr>
</tbody></table>
<ul>
<li><code>restart_syscall</code>表示系统调用被中断后重新启动的过程。它通常出现在系统调用的执行过程中，当某个信号（例如 SIGSTOP 或 SIGCONT）中断了系统调用的执行，然后系统调用在信号处理完成后被重新启动。</li>
<li>select 是一个用于在多个文件描述符上进行 I&#x2F;O 多路复用（I&#x2F;O multiplexing）的系统调用，它可以监视多个文件描述符，并在其中任何一个文件描述符准备好进行 I&#x2F;O 操作时返回。<ul>
<li>select 调用的输出，它将监视文件描述符 48 和 49，并在其中任何一个文件描述符准备好读取数据或超时（2 秒后）时返回。</li>
<li>完全无法理解呢！ 可能需要深入了解MPI的实现栈细节才能明白。</li>
</ul>
</li>
</ul>
<h2 id="命令行唤醒Sleep进程"><a href="#命令行唤醒Sleep进程" class="headerlink" title="命令行唤醒Sleep进程"></a>命令行唤醒Sleep进程</h2><p>The only way to “wake it up” is to arrange for the <a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/304591/how-to-wake-up-inactive-processes-in-linux">condition to be met.</a> 用户是无法更改的状态的。</p>
<h3 id="传统kill进程"><a href="#传统kill进程" class="headerlink" title="传统kill进程"></a>传统kill进程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find pid , state S+ meaning sleep</span></span><br><span class="line">ps aux | grep name</span><br><span class="line"><span class="comment"># gracefully kill process</span></span><br><span class="line"><span class="built_in">kill</span> -15 pid</span><br></pre></td></tr></table></figure>

<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>上面回答部分<strong>来自ChatGPT-3.5</strong>，没有进行正确性的交叉校验。</p>
<div id='refer-anchor'></div>

<p>无</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-08-27T16:00:00.000Z" title="8/27/2023, 4:00:00 PM">2023-08-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.254Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">16 minutes read (About 2466 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/08/27/Work/software/benchmark/benchmark/">Benchmark</a></p><div class="content"><h2 id="Differentiated-Bounded-Applications"><a href="#Differentiated-Bounded-Applications" class="headerlink" title="Differentiated-Bounded Applications"></a>Differentiated-Bounded Applications</h2><p>According to the DAMOV, data movement have six different types.</p>
<p>Although the authors only use temporal Locality to classify the apps, the Figure 3: Locality-based clustering of 44 representative functions shows some cases deserved to test.</p>
<p>In the context of data movement, the DAMOV framework identifies <strong>six</strong> distinct types. While the authors primarily utilize <code>temporal locality</code> for app classification, Figure 3 offers a comprehensive view of the <code>locality-based</code> clustering of 44 representative functions, highlighting specific cases that warrant further examination.</p>
<p>Take, for instance, the four cases situated in the lower right corner:</p>
<table>
<thead>
<tr>
<th>function short name</th>
<th>benchmark</th>
<th>class</th>
</tr>
</thead>
<tbody><tr>
<td>CHAHsti</td>
<td>Chai-Hito</td>
<td>1b: DRAM Latency</td>
</tr>
<tr>
<td>CHAOpad</td>
<td>Chai-Padding</td>
<td>1c: L1&#x2F;L2 Cache Capacity</td>
</tr>
<tr>
<td>PHELinReg</td>
<td>Phoenix-Linear Regression</td>
<td>1b</td>
</tr>
<tr>
<td>PHEStrMat</td>
<td>Phoenix-String Matching</td>
<td>1b</td>
</tr>
</tbody></table>
<p>TLB percentage high -&gt; tlb miss rate high -&gt; memory access address in large span -&gt; spacial locality is low.</p>
<h2 id="benchmark"><a href="#benchmark" class="headerlink" title="benchmark"></a>benchmark</h2><h3 id="Chai-Benchmark"><a href="#Chai-Benchmark" class="headerlink" title="Chai Benchmark"></a>Chai Benchmark</h3><p>The Chai benchmark code can be sourced either from DAMOV or directly from its <a target="_blank" rel="noopener" href="https://github.com/chai-benchmarks/chai">GitHub repository</a>. Chai stands for “Collaborative Heterogeneous Applications for Integrated Architectures.”</p>
<p>Installing Chai is a straightforward process. You can achieve it by executing the command <code>python3 compile.py</code>.</p>
<p>One notable feature of the Chai benchmark is its adaptability in terms of input size. Modifying the input size of the following applications is a simple and flexible task: </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd application directory</span></span><br><span class="line">./bfs_00 -t 4 -f input/xxx.input</span><br><span class="line">./hsti -n 1024000             <span class="comment"># Image Histogram - Input Partitioning (HSTI)</span></span><br><span class="line">./hsto -n 1024000             <span class="comment"># Image Histogram - Output Partitioning (HSTO)</span></span><br><span class="line">./ooppad -m 1000 -n 1000   <span class="comment"># Padding (PAD)</span></span><br><span class="line">./ooptrns -m 100 -n 10000  <span class="comment"># Transpose / In-place Transposition (TRNS)</span></span><br><span class="line">./sc -n 1024000            <span class="comment"># Stream Compaction (SC)</span></span><br><span class="line">./sri -n 1024000           <span class="comment"># select application</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># vector pack , 2048 = 1024 * 2, 1024 = 2^n</span></span><br><span class="line">./vpack -m 2048 -n 1024 -i 2 </span><br><span class="line"><span class="comment"># vector unpack , 2048 = 1024 * 2, 1024 = 2^n</span></span><br><span class="line">./vupack -m 2048 -n 1024 -i 2 </span><br></pre></td></tr></table></figure>

<h3 id="Parboil-how-to-run"><a href="#Parboil-how-to-run" class="headerlink" title="Parboil (how to run)"></a>Parboil (how to run)</h3><p>The Parboil suite was developed from a collection of benchmarks used at the<br>University of Illinois to measure and compare the <strong>performance of computation-intensive algorithms</strong> executing on either a CPU or a GPU.  Each<br>implementation of a GPU algorithm is either in CUDA or OpenCL, and requires<br>a system capable of executing applications using those APIs.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compile , vim compile.py </span></span><br><span class="line"><span class="comment"># python2.7 ./parboil compile bfs omp_base </span></span><br><span class="line">python3 compile.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># no idea how to run, failed command: (skip)</span></span><br><span class="line">python2.7 ./parboil run bfs cuda default </span><br><span class="line"><span class="comment"># exe in benchmarks/*, but need some nowhere input.</span></span><br></pre></td></tr></table></figure>

<h3 id="Phoenix"><a href="#Phoenix" class="headerlink" title="Phoenix"></a>Phoenix</h3><p>Phoenix is a shared-memory implementation of Google’s MapReduce model for data-intensive processing tasks.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># with code from DAMOV</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">os.chdir(<span class="string">&quot;phoenix-2.0/tests&quot;</span>) <span class="comment"># app is changed from sample_apps/*</span></span><br><span class="line">os.system(<span class="string">&quot;make&quot;</span>)</span><br><span class="line">os.chdir(<span class="string">&quot;../../&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate excution in phoenix-2.0/tests/&#123;app&#125;/&#123;app&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># running for example</span></span><br><span class="line">./phoenix-<span class="number">2.0</span>/tests/linear_regression/linear_regression ./phoenix-<span class="number">2.0</span>/datasets/linear_regression_datafiles/key_file_500MB.txt </span><br></pre></td></tr></table></figure>

<h3 id="PolyBench"><a href="#PolyBench" class="headerlink" title="PolyBench"></a>PolyBench</h3><p>PolyBench is a benchmark suite of 30 numerical computations with <strong>static control flow</strong>, extracted from operations in various application domains (linear algebra computations, image processing, physics<br>simulation, dynamic programming, statistics, etc.). </p>
<p>PolyBench features include:</p>
<ul>
<li>A single file, tunable at compile-time, used for the kernel<br>instrumentation. It performs extra operations such as cache flushing<br>before the kernel execution, and can set real-time scheduling to<br>prevent OS interference.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compile using DAMOV code</span></span><br><span class="line">python compile.py</span><br><span class="line"><span class="comment"># exe in OpenMP/compiled, and all running in no parameter</span></span><br></pre></td></tr></table></figure>


<h3 id="PriM"><a href="#PriM" class="headerlink" title="PriM"></a>PriM</h3><p>real apps for the first real PIM platform</p>
<h3 id="Rodinia-developed"><a href="#Rodinia-developed" class="headerlink" title="Rodinia (developed)"></a>Rodinia (developed)</h3><p>Rodinia, a benchmark suite for heterogeneous parallel computing which target multi-core CPU and GPU platforms, which first introduced in <a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/5306797">2009 IISWC</a>.</p>
<p>zsim hooked code from <a target="_blank" rel="noopener" href="https://github.com/Kirrito-k423/rodinia-zsimhooks">github</a></p>
<ol>
<li>Install the CUDA&#x2F;OCL drivers, SDK and toolkit on your machine. </li>
<li>Modify the <code>common/make.config</code> file to change the settings of <ol>
<li>rodinia home directory and CUDA&#x2F;OCL library paths.</li>
<li>It seems need intel opencl, but intel do everything to <a target="_blank" rel="noopener" href="https://community.intel.com/t5/OpenCL-for-CPU/OpenCL-Runtime-for-Ubuntu-20-04/m-p/1366728">oneapi</a></li>
</ol>
</li>
<li>To compile all the programs of the Rodinia benchmark suite, simply use the universal <code>makefile</code> to compile all the programs, or go to each benchmark directory and make individual programs. </li>
<li>full code with related data can be downloaded from <a target="_blank" rel="noopener" href="http://www.cs.virginia.edu/~skadron/lava/Rodinia/Packages/rodinia_3.1.tar.bz2">website</a></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ./bin/linux/omp</span><br><span class="line">make OMP</span><br></pre></td></tr></table></figure>

<p>Running the zsim hooked apps</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> bin/linux/omp</span><br><span class="line">./pathfinder 100000 100 7</span><br><span class="line">./myocyte.out 100 1 0 4</span><br><span class="line">./lavaMD -cores 4 -boxes1d 10 <span class="comment"># -boxes1d  (number of boxes in one dimension, the total number of boxes will be that^3)</span></span><br><span class="line">./omp/lud_omp -s 8000</span><br><span class="line">./srad 2048 2048 0 127 0 127 2 0.5 2</span><br><span class="line">./backprop 4 65536 <span class="comment"># OMP_NUM_THREADS=4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># need to download data or file</span></span><br><span class="line">./hotspot 1024 1024 2 4 ../../data/hotspot/temp_1024 ../../data/hotspot/power_1024 output.out</span><br><span class="line">./OpenMP/leukocyte 5 4 ../../data/leukocyte/testfile.avi</span><br><span class="line"><span class="comment"># streamcluster</span></span><br><span class="line">./sc_omp k1 k2 d n chunksize clustersize infile outfile <span class="built_in">nproc</span></span><br><span class="line">./sc_omp 10 20 256 65536 65536 1000 none output.txt 4</span><br><span class="line">./bfs 4 ../../data/bfs/graph1MW_6.txt </span><br><span class="line">./kmeans_serial/kmeans -i ../../data/kmeans/kdd_cup</span><br><span class="line">./kmeans_openmp/kmeans -n 4 -i ../../data/kmeans/kdd_cup</span><br></pre></td></tr></table></figure>

<h2 id="dynamic-data-structures"><a href="#dynamic-data-structures" class="headerlink" title="dynamic data structures"></a>dynamic data structures</h2><p>We choose this specific suite because dynamic data structures are the core of many server workloads (e.g., Memcached’s hash table, RocksDB’s skip list), and are a great match for nearmemory processing</p>
<p>ASCYLIB + OPTIK[^1]</p>
<h2 id="Graph-Apps"><a href="#Graph-Apps" class="headerlink" title="Graph Apps"></a>Graph Apps</h2><h3 id="Graph500-Benchmark-Exploration"><a href="#Graph500-Benchmark-Exploration" class="headerlink" title="Graph500 Benchmark Exploration"></a>Graph500 Benchmark Exploration</h3><h4 id="Official-Version"><a href="#Official-Version" class="headerlink" title="Official Version"></a>Official Version</h4><p>The official version of the Graph500 benchmark can be downloaded from its <a target="_blank" rel="noopener" href="https://github.com/graph500/graph500">GitHub repository</a>. Notable features of this version include:</p>
<ul>
<li>Primarily MPI Implementation: The benchmark is built as an MPI (Message Passing Interface) version, without an accompanying OpenMP version. This can be disappointing for those utilizing tools like zsim.</li>
<li>Flexible <code>n</code> Value: By default, the value <code>n</code> is set to powers of 2, but it’s possible to change this behavior through configuration adjustments.</li>
<li>Customization Options: Environment variables can be altered to modify the execution process. For instance, the BFS (Breadth-First Search) portion can be skipped or the destination path for saved results can be changed.</li>
</ul>
<h4 id="Unofficial-Repository"><a href="#Unofficial-Repository" class="headerlink" title="Unofficial Repository"></a>Unofficial Repository</h4><p>An alternative <a target="_blank" rel="noopener" href="https://github.com/PamplemousseMR/Benchmark">unofficial repository</a> also exists. However, it requires OpenCL for compilation. The process can be broken down as follows:</p>
<ul>
<li>OpenCL Dependency: The unofficial repository mandates the presence of OpenCL. To set up OpenCL, you can refer to this <a target="_blank" rel="noopener" href="https://support.zivid.com/en/latest/getting-started/software-installation/gpu/install-opencl-drivers-ubuntu.html">tutorial</a>.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install clinfo</span><br><span class="line"><span class="built_in">sudo</span> apt-get install opencl-headers</span><br><span class="line"><span class="built_in">sudo</span> apt install opencl-dev</span><br></pre></td></tr></table></figure>

<p>After completing the OpenCL setup and the compilation process using <code>cmake &amp; make</code>, we obtain the executable file named <code>benchmark</code>.<br>By default, running this executable without any arguments appears to utilize only a single core, despite attempts to set the environment variable with <code>export OMP_NUM_THREADS=32</code>.<br>This default behavior led to a runtime of approximately 5 minutes to generate a report related to edges-node-verify status (or similar). However, for someone without an in-depth technical background, this report can be confusing, especially when trying to locate the BFS (Breadth-First Search) and SSSP (Single-Source Shortest Path) components.</p>
<p>What is even more disheartening is that the TLB (Translation Lookaside Buffer) result is disappointingly low, similar to the performance of the GUPS (Giga Updates Per Second) OpenMP version.</p>
<p>In order to gain a clearer understanding and potentially address these issues, further investigation and potentially adjustments to the program configuration may be necessary.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./tlbstat -c <span class="string">&#x27;/staff/shaojiemike/github/graph500_openmp/build/benchmark&#x27;</span> </span><br><span class="line"><span class="built_in">command</span> is /staff/shaojiemike/github/graph500_openmp/build/benchmark                       </span><br><span class="line">K_CYCLES   K_INSTR      IPC DTLB_WALKS ITLB_WALKS K_DTLBCYC  K_ITLBCYC  DTLB% ITLB%         </span><br><span class="line">20819312   10801013    0.52 7736938    1552557    369122     51902       1.77  0.25</span><br><span class="line">20336549   10689727    0.53 7916323    1544469    354426     48123       1.74  0.24</span><br></pre></td></tr></table></figure>

<h3 id="GAP"><a href="#GAP" class="headerlink" title="GAP"></a>GAP</h3><p>Zsim?&#x2F;LLVM Pass Instrumentation Code from PIMProf paper <a target="_blank" rel="noopener" href="https://github.com/Systems-ShiftLab/PIMProf">github</a></p>
<p>But the graph dataset should be generated by yourself following the <a target="_blank" rel="noopener" href="https://github.com/sbeamer/gapbs">github</a>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2^17 nodes </span></span><br><span class="line">./converter -g17 -k16 -b kron-17.sg</span><br><span class="line">./converter -g17 -k16 -wb kron-17.wsg</span><br></pre></td></tr></table></figure>

<p>Kernels Included</p>
<ul>
<li>Breadth-First Search (BFS) - direction optimizing</li>
<li>Single-Source Shortest Paths (SSSP) - delta stepping</li>
<li>PageRank (PR) - iterative method in pull direction</li>
<li>Connected Components (CC) - Afforest &amp; Shiloach-Vishkin</li>
<li>Betweenness Centrality (BC) - Brandes</li>
<li>Triangle Counting (TC) - Order invariant with possible relabelling</li>
</ul>
<h3 id="ligra"><a href="#ligra" class="headerlink" title="ligra"></a>ligra</h3><p>Code also from DAMOV</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compile</span></span><br><span class="line">python3 compile.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 kind exe of each app, relative code can be found in /ligra directory</span></span><br><span class="line"><span class="comment"># emd: edgeMapDense() maybe processing related dense-data </span></span><br><span class="line"><span class="comment"># ems: edgeMapSparse() analyse edge-data</span></span><br><span class="line"><span class="comment"># compute: of course, the core compute part</span></span><br></pre></td></tr></table></figure>

<p>the source code is difficult to read, skip</p>
<p>the graph format : It seems <code>lines_num = offsets + edges + 3</code> </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">AdjacencyGraph</span><br><span class="line">16777216 <span class="comment"># offsets, and vertex from []</span></span><br><span class="line">100000000 <span class="comment">#   uintE* edges = newA(uintE,m);</span></span><br><span class="line">0</span><br><span class="line">470</span><br><span class="line">794 <span class="comment"># must monotonic increasing, and range [0,edges), represent the folloing edges are belong to corresponding vector</span></span><br><span class="line">……</span><br><span class="line">14680024 <span class="comment"># random but range [0,vector-1], represent each node&#x27;s conjoint others nodes(so there are pairs).</span></span><br><span class="line">16644052</span><br><span class="line">16284631</span><br><span class="line">15850460</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">wc</span> -l  /staff/qcjiang/codes/DAMOV/workloads/ligra/inputs/rMat_10M</span><br><span class="line">116777219 /staff/qcjiang/codes/DAMOV/workloads/ligra/inputs/rMat_10M</span><br></pre></td></tr></table></figure>

<p>Pagerank Algorithm should be referened from my another post.</p>
<h2 id="HPC"><a href="#HPC" class="headerlink" title="HPC"></a>HPC</h2><p>maybe more computation-intensive than graph applications</p>
<h3 id="parsec"><a href="#parsec" class="headerlink" title="parsec"></a>parsec</h3><p>From DAMOV</p>
<p>The Princeton Application Repository for Shared-Memory Computers (PARSEC) is a<br>collection of <strong>parallel programs</strong> which can be used for performance studies of<br>multiprocessor machines.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compile</span></span><br><span class="line">python3 compile_parsec.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># exe in pkgs/binaries</span></span><br><span class="line">./pkgs/binaries/blackscholes 4 ./pkgs/inputs/blackscholes/in_64K.txt black.out</span><br><span class="line">./pkgs/binaries/fluidanimate 4 10 ./pkgs/inputs/fluidanimate/in_300K.fluid</span><br></pre></td></tr></table></figure>

<h3 id="STREAM-apps"><a href="#STREAM-apps" class="headerlink" title="STREAM apps"></a>STREAM apps</h3><p>DAMOV code for memory bandwidth testing which reference J. D. McCalpin et al., “Memory Bandwidth and Machine Balance in Current High Performance Computers,” IEEE TCCA Newsletter, 1995</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compile</span></span><br><span class="line">python3 compile.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># default run with Failed Validation error(whatever)</span></span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">Function    Best Rate MB/s  Avg time     Min time     Max time</span><br><span class="line">Copy:            5072.0     0.205180     0.157728     0.472323</span><br><span class="line">Add:             6946.6     0.276261     0.172746     0.490767</span><br></pre></td></tr></table></figure>

<h3 id="Hardware-Effects"><a href="#Hardware-Effects" class="headerlink" title="Hardware Effects"></a>Hardware Effects</h3><p>Two very Interesting repositys of <a target="_blank" rel="noopener" href="https://github.com/kobzol/hardware-effects">cpu</a> and <a target="_blank" rel="noopener" href="https://github.com/kobzol/hardware-effects-gpu">gpu</a> hardware effects that can degrade application performance<br>in surprising ways and that may be very hard to explain without knowledge of the low-level CPU&#x2F;GPU and OS architecture.</p>
<p>Test also using DAMOV code</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compile</span></span><br><span class="line">python3 compile.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># Every example directory has a README that explains the individual effects.</span></span><br><span class="line">./build/bandwidth-saturation/bandwidth-saturation 0 1</span><br><span class="line">./build/false-sharing/false-sharing 3 8</span><br></pre></td></tr></table></figure>

<p>Most cases using the help of <code>perf</code> to know more about your system ability.</p>
<h3 id="HPCC"><a href="#HPCC" class="headerlink" title="HPCC"></a>HPCC</h3><p>From DAMOV and The HPC Challenge (HPCC) Benchmark Suite,” in SC, 2006</p>
<ul>
<li>RandomAccess OpenMP version (it is also the <a target="_blank" rel="noopener" href="https://github.com/alexandermerritt/gups">GUPS</a>)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install</span></span><br><span class="line">python compile.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># must export</span></span><br><span class="line"><span class="built_in">export</span> OMP_NUM_THREADS=32</span><br><span class="line">./OPENMP/ra_omp 26 <span class="comment"># 26 need almost 20GB mem, 27 need 30GB mem, and so on.</span></span><br></pre></td></tr></table></figure>

<p>but the openmp version shows no big pgw overhead</p>
<h3 id="GUPS"><a href="#GUPS" class="headerlink" title="GUPS"></a>GUPS</h3><p>描述系统的随机访问能力</p>
<p>From <a target="_blank" rel="noopener" href="https://github.com/alexandermerritt/gups">github</a> or <a target="_blank" rel="noopener" href="https://hpcchallenge.org/hpcc/index.html">hpcc official-web</a> and RandomAccess MPI version</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># download using github</span></span><br><span class="line">make -f Makefile.linux gups_vanilla</span><br><span class="line"><span class="comment"># running</span></span><br><span class="line">gups_vanilla N M chunk</span><br></pre></td></tr></table></figure>

<ul>
<li><code>N = length of global table is 2^N</code><ul>
<li><code>Thus N = 30 would run with a billion-element table.</code></li>
</ul>
</li>
<li><code>M = # of update sets per proc</code> 越大代表算得越久（随机访问越久），</li>
<li><code>chunk = # of updates in one set on each proc</code><ul>
<li>In the official HPCC benchmark this is specified to be no larger than 1024, but you can run the code with any value you like.  Your GUPS performance will typically decrease for smaller chunk size.</li>
</ul>
</li>
</ul>
<p>测试之后，最佳搭配如下 <code>mpirun -n 32 ./gups_vanilla 32 100000 2048</code> 其中n最多32，不然会爆内存。</p>
<table>
<thead>
<tr>
<th>n</th>
<th>32</th>
<th>31</th>
<th>30</th>
<th>29</th>
</tr>
</thead>
<tbody><tr>
<td>DTLB%</td>
<td>66.81</td>
<td>45.22</td>
<td>19.50</td>
<td>13.20</td>
</tr>
<tr>
<td>ITLB%</td>
<td>0.06</td>
<td>0.07</td>
<td>0.06</td>
<td>0.09</td>
</tr>
</tbody></table>
<p>或者单独运行<code>./gups_vanilla 30 100000 k</code> (n最多30), <code>./tlbstat -c &#39;/usr/bin/mpirun -np 1 /staff/shaojiemike/github/gups/gups_vanilla  30 100000 8192</code></p>
<table>
<thead>
<tr>
<th>n\k</th>
<th>1024</th>
<th>2048</th>
<th>4096</th>
<th>8192</th>
</tr>
</thead>
<tbody><tr>
<td>30</td>
<td></td>
<td>44%</td>
<td>90%</td>
<td>80%</td>
</tr>
<tr>
<td>27</td>
<td></td>
<td></td>
<td></td>
<td>88%</td>
</tr>
<tr>
<td>24</td>
<td></td>
<td></td>
<td>83%</td>
<td>83%</td>
</tr>
<tr>
<td>20</td>
<td></td>
<td></td>
<td>58%</td>
<td>62%</td>
</tr>
<tr>
<td>15</td>
<td></td>
<td></td>
<td>0.27%</td>
<td>0.3%</td>
</tr>
</tbody></table>
<article class="message is-dark">
        <div class="message-header"><p><i class="fa-solid fa-flask mr-2"></i>手动构造 bigJump</p>
</div>
        <div class="message-body">
            
        </div>
    </article>



   <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../zsim_hooks.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD int(1e9)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2000 tlb entries is the normal cpu config, </span></span><br><span class="line"><span class="comment">// for 4KB page, each data access trigers tlb miss, jump over 1000 int， </span></span><br><span class="line"><span class="comment">// and after 2000 entries to repeat, so at least 2000 * 4KB = 8MB space</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// #define BASIC_8MB 2000000 * 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BASIC_8MB (1 &lt;&lt; 22)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1 second program. stream add 6GB/s， int is 4B, repeated 10^9</span></span><br><span class="line"><span class="comment">// #define all_loops 1000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all_loops (1 &lt;&lt; 20)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (argc != <span class="number">4</span>) &#123;</span><br><span class="line">      std::cerr &lt;&lt; <span class="string">&quot;Usage: &quot;</span> &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &lt;space scale&gt; &lt;jump distance scale&gt; &lt;loop times&gt;&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Convert the second command-line argument (argv[1]) to an integer</span></span><br><span class="line">   <span class="type">int</span> N = std::<span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">   <span class="type">int</span> J = std::<span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line">   <span class="type">int</span> M = std::<span class="built_in">atoi</span>(argv[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">   std::cout &lt;&lt; <span class="string">&quot;Number read from command line: &quot;</span> &lt;&lt; N &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; J &lt;&lt; <span class="string">&quot; (N,J should not big, [0,5] is best.)&quot;</span> &lt;&lt;std::endl;</span><br><span class="line"></span><br><span class="line">   <span class="type">const</span> <span class="type">int</span> size = BASIC_8MB &lt;&lt; N;</span><br><span class="line">   <span class="type">const</span> <span class="type">int</span> size_mask = size - <span class="number">1</span>;</span><br><span class="line">   <span class="type">int</span> * jump_space = (<span class="type">int</span> *)<span class="built_in">malloc</span>(size * <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">   </span><br><span class="line">   <span class="built_in">zsim_begin</span>();</span><br><span class="line">   <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line">   <span class="type">int</span> mem_access_count = <span class="number">0</span>;</span><br><span class="line">   <span class="type">int</span> mem_access_index = <span class="number">0</span>;</span><br><span class="line">   <span class="comment">// int mask = (1&lt;&lt;10&lt;&lt;J)-1;</span></span><br><span class="line">   <span class="comment">// int ran = 0x12345678;</span></span><br><span class="line">   <span class="type">int</span> mask = (<span class="number">1</span>&lt;&lt;J)<span class="number">-1</span>;</span><br><span class="line">   <span class="type">int</span> ran = (<span class="number">1</span>&lt;&lt;<span class="number">30</span>)<span class="number">-1</span>;</span><br><span class="line">   <span class="comment">// without random address, tlb occupancy is alse high</span></span><br><span class="line">   <span class="comment">// ran = (ran &lt;&lt; 1) ^ ((int) ran &lt; 0 ? 0x87654321 : 0);</span></span><br><span class="line">   <span class="keyword">while</span>(mem_access_count++ &lt; all_loops*M)&#123;</span><br><span class="line">      <span class="comment">// read &amp; write </span></span><br><span class="line">      jump_space[mem_access_index] = ran;</span><br><span class="line">      mem_access_index = (mem_access_index + (<span class="number">1024</span> + ran &amp; mask) ) &amp; (size_mask);</span><br><span class="line">      <span class="comment">// cout &lt;&lt; &quot;mem_access_index = &quot; &lt;&lt; mem_access_index &lt;&lt; endl;</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="built_in">zsim_end</span>();</span><br><span class="line"></span><br><span class="line">   <span class="comment">//print first 5 elements</span></span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;result %d&quot;</span>,result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HPCG"><a href="#HPCG" class="headerlink" title="HPCG"></a>HPCG</h3><p>From DAMOV and High Performance Conjugate Gradient Benchmark (HPCG)</p>
<p>HPCG is a software package that performs a fixed number of multigrid preconditioned<br>(using a symmetric Gauss-Seidel smoother) conjugate gradient (PCG) iterations using double<br>precision (64 bit) floating point values. 浮点数的共轭梯度求解</p>
<p>follow the instructions in <code>INSTALL</code> and analyze the <code>compile.py</code></p>
<ol>
<li>choose makefile like <code>setup/Make.GCC_OMP</code><ol>
<li>config values like <code>MPdir</code>, but we can leave them beacuse we use <code>GCC_OMP</code> which set <code>-DHPCG_NO_MPI</code> in it</li>
<li>add <code>-DHPGSym</code> to <code>CXXFLAGS</code> or <code>HPCG_OPTS</code></li>
</ol>
</li>
<li><code>cd build</code> and <code>../configure GCC_OMP</code></li>
<li>run <code>compile.py</code> to compile the executable files<ol>
<li>get 4 <code>ComputePrologation</code> in <code>build/bin</code></li>
</ol>
</li>
<li>test the exe using <code>xhpcg 32 24 16</code> for three  dimension<ol>
<li>or <code>xhpcg --nx=16 --rt=120</code> for <code>NX=NY=NZ=16</code> and time is 120 seconds</li>
<li>change <code>int refMaxIters = 50;</code> to <code>int refMaxIters = 1;</code> to limit <code>CG</code> iteration number</li>
<li>to be attention: <code>--nx=16</code> must be a multiple of 8</li>
</ol>
</li>
<li>if there is no geometry arguments on the command line, hpcg will <code>ReadHpcgDat</code> and get the default <code>--nx=104 --rt=60</code></li>
</ol>
<table>
<thead>
<tr>
<th>value\nx</th>
<th>96</th>
<th>240</th>
<th>360</th>
<th>480</th>
</tr>
</thead>
<tbody><tr>
<td>mem</td>
<td></td>
<td>17GB</td>
<td>40GB</td>
<td>72.8GB</td>
</tr>
<tr>
<td>time(icarus0)</td>
<td>8s</td>
<td>84S</td>
<td>4min40s</td>
<td>core dumped(7mins)</td>
</tr>
</tbody></table>
<p>core dumped for <code>xhpcg_HPGPro: ../src/GenerateProblem_ref.cpp:204: void GenerateProblem_ref(SparseMatrix&amp;, Vector*, Vector*, Vector*): Assertion &#39;totalNumberOfNonzeros&gt;0&#39; failed.</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MPdir        = </span><br><span class="line">MPinc        = </span><br><span class="line">MPlib        = </span><br><span class="line"></span><br><span class="line">HPCG_OPTS     = -DHPCG_NO_MPI -DHPGSym</span><br></pre></td></tr></table></figure>

<h4 id="compile-error"><a href="#compile-error" class="headerlink" title="compile error"></a>compile error</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../src/ComputeResidual.cpp:59:13: error: <span class="string">&#x27;n&#x27;</span> not specified <span class="keyword">in</span> enclosing <span class="string">&#x27;parallel&#x27;</span></span><br></pre></td></tr></table></figure>

<p>just add <code>n</code> to shared values</p>
<h2 id="Database"><a href="#Database" class="headerlink" title="Database"></a>Database</h2><h2 id="Hash-Joins"><a href="#Hash-Joins" class="headerlink" title="Hash Joins"></a>Hash Joins</h2><p>This package provides implementations of the main-memory hash join algorithms<br>described and studied in C. Balkesen, J. Teubner, G. Alonso, and M. T. Ozsu, “Main-Memory Hash Joins on Modern Processor Architectures,” TKDE, 2015.</p>
<p>Test also in DAMOV</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install</span></span><br><span class="line">python compile.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># runing</span></span><br><span class="line">./src/mchashjoins_* -r 12800000 -s 12000000 -x 12345 -y 54321</span><br></pre></td></tr></table></figure>

<p>these case shows tlb resource strains</p>
<h2 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h2><h3 id="Darknet-for-CV-using-multi-cores"><a href="#Darknet-for-CV-using-multi-cores" class="headerlink" title="Darknet for CV using multi-cores"></a>Darknet for CV using multi-cores</h3><p>From DAMOV and <a target="_blank" rel="noopener" href="https://pjreddie.com/darknet/install/">official documentation</a> is  detailed</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shaojiemike @ snode6 <span class="keyword">in</span> ~/github/DAMOV/workloads/Darknet on git:main x [14:13:02]                   │drwxr-xr-x  3 shaojiemike staff   21 Mar 14  2022 .</span><br><span class="line">$ ./darknet detect cfg/yolo.cfg ./weights/yolo.weights data/dog.jpg</span><br></pre></td></tr></table></figure>

<ul>
<li>model in <code>weight</code> files, different size model (28MB -528MB)can be downloaded from <a target="_blank" rel="noopener" href="https://pjreddie.com/darknet/imagenet/">website</a></li>
<li>picture data in <code>data</code> files. (70KB - 100MB)</li>
<li>must run the exe in the file directory. SHIT.</li>
</ul>
<h2 id="genomics-DNA"><a href="#genomics-DNA" class="headerlink" title="genomics &#x2F; DNA"></a>genomics &#x2F; DNA</h2><h3 id="BWA"><a href="#BWA" class="headerlink" title="BWA"></a>BWA</h3><p>From DAMOV and for mapping DNA sequences against a large reference genome, such as the human genome</p>
<ul>
<li>Download DNA data like <code>ref.fa</code> following <a target="_blank" rel="noopener" href="https://github.com/bwa-mem2/bwa-mem2">Data download steps</a><ul>
<li>stucked when running <code>sratoolkit.3.0.6-ubuntu64/bin/fastq-dump --split-files SRR7733443</code> due to generate several 96GB <code>SRR7733443_X.fastq</code> files which <code>X</code> from 1 to n.</li>
<li>sratool can not limit the file size, but we can use <code>head -c 100MB SRR7733443_1.fastq &gt; ref_100MB.fastq</code> to get wanted<br>file size.</li>
</ul>
</li>
<li>Further running commands you can read the <a target="_blank" rel="noopener" href="https://github.com/bwa-mem2/bwa-mem2#usage">github</a><ul>
<li><code>./bwa index -p abc ref_100MB.fastq</code> will generate sevaral <code>abc.suffix</code> files using 50 seconds.</li>
<li>and now you can run <code>./bwa mem -t 4 abc ref_100MB.fastq</code> or <code>./bwa aln -t 4 abc ref_100MB.fastq</code></li>
</ul>
</li>
</ul>
<h3 id="GASE"><a href="#GASE" class="headerlink" title="GASE"></a>GASE</h3><p>GASE - Generic Aligner for *Seed-and-Extend</p>
<hr>
<p>GASE is a DNA read aligner, developed for measuring the mapping accuracy and execution time of different combinations of seeding and extension techniques. GASE is implemented by extending BWA (version 0.7.13) developed by Heng Li.</p>
<p>Code also from DAMOV. But seems there are some program syntax errors, skip this app.</p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>DAMOV: A New Methodology and Benchmark Suite for Evaluating Data Movement Bottlenecks</p>
<p>[^1]: <a target="_blank" rel="noopener" href="https://github.com/LPD-EPFL/ASCYLIB">ASCYLIB + OPTIK</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-08-05T16:00:00.000Z" title="8/5/2023, 4:00:00 PM">2023-08-05</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.273Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">6 minutes read (About 837 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/08/05/Work/Programming/2-languageGrammar/jupyter-ai/">Jupyter AI</a></p><div class="content"><h2 id="Jupyter-简介"><a href="#Jupyter-简介" class="headerlink" title="Jupyter 简介"></a>Jupyter 简介</h2><p>Jupyter是一个开源的、交互式的计算环境，可以让用户创建和共享包含实时代码、可视化和文本的文档。</p>
<ul>
<li>它的名字来源于三个主要的编程语言：Julia、Python和R，这三种语言的开头字母构成了“Jupyter”。</li>
<li>Jupyter最初是IPython项目的一部分，旨在提供Python的交互式计算环境。随着时间的推移，它不仅支持Python，还扩展到其他编程语言，包括R、Julia、Scala等。Jupyter的灵感来自于IPython的交互式shell，但在其基础上增加了更多功能和可扩展性。</li>
</ul>
<p>Jupyter最显著的特点：用户可以<strong>通过Web浏览器</strong>打开Jupyter笔记本，然后在其中编写代码、运行代码并直接查看代码的输出结果。笔记本中的代码和文本可以交叉编排，使得写作、数据分析和可视化变得非常直观和便捷。</p>
<p>主要的Jupyter组件包括：</p>
<ol>
<li>Jupyter Notebook：这是最常见的Jupyter界面，以.ipynb后缀的文件保存。它支持多种编程语言的代码运行，交互式地执行和编辑代码块，并支持在代码块中插入Markdown格式的文本以及图像、链接等内容。</li>
<li>Jupyter Lab：这是Jupyter Notebook的下一代界面，提供了更加现代化和灵活的界面。Jupyter Lab将各种组件整合到一个集成的界面中，使得多个笔记本、终端和文件浏览器可以在一个窗口中同时运行。</li>
<li>Jupyter Kernel：Jupyter支持多种编程语言的内核，通过内核，Jupyter可以与特定编程语言进行交互。例如，使用Python内核可以在笔记本中运行和编写Python代码，同样，使用R内核可以运行和编写R代码。</li>
</ol>
<p>Jupyter在教育、数据科学、机器学习、数据分析等领域得到广泛应用。它提供了一个方便、实用的平台，帮助用户探索数据、实验算法、展示结果，并通过共享笔记本方便地与其他人交流和合作。</p>
<h3 id="Jupyter-vs-python"><a href="#Jupyter-vs-python" class="headerlink" title="Jupyter vs python"></a>Jupyter vs python</h3><p>Jupyter 的<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/37490497">核心</a>在于 数据分析的 计算-分析-可视化 的快速迭代。</p>
<p>如果不是数据科学，就不太需要Jupyter</p>
<h2 id="Installation-in-Linux"><a href="#Installation-in-Linux" class="headerlink" title="Installation in Linux"></a>Installation in Linux</h2><p>安装<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/166425946">Jupyter Lab</a></p>
<h2 id="web-forward-to-local-machine"><a href="#web-forward-to-local-machine" class="headerlink" title="web-forward to local machine"></a>web-forward to local machine</h2><p>远程访问服务器</p>
<h2 id="Jupyter-AI"><a href="#Jupyter-AI" class="headerlink" title="Jupyter-AI"></a>Jupyter-AI</h2><ol>
<li>Installation</li>
<li>test</li>
</ol>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><ol>
<li>python 一大特点就是容易可视化，既然这样，我为什么不用jupyter呢？</li>
<li>chatgpt 类的工具都是基于付费API，有两大问题<ol>
<li>国内难以付费</li>
<li>国内ip一旦访问是很容易封号的。</li>
</ol>
</li>
<li>一种解决办法是使用有免费API的工具，并且在全流量走cloudflare的wg的服务器上配置服务。</li>
</ol>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>上面回答部分<strong>来自ChatGPT-3.5</strong>，没有进行正确性的交叉校验。</p>
<p><a target="_blank" rel="noopener" href="https://jupyter-ai.readthedocs.io/en/latest/users/index.html#installation">https://jupyter-ai.readthedocs.io/en/latest/users/index.html#installation</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-08-02T16:00:00.000Z" title="8/2/2023, 4:00:00 PM">2023-08-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.262Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">3 minutes read (About 464 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/08/02/Work/Algorithms/parallel_sort/">Parallel_sort</a></p><div class="content"><h2 id="并行排序算法"><a href="#并行排序算法" class="headerlink" title="并行排序算法"></a>并行排序算法</h2><p>to learn</p>
<h2 id="PSRS算法"><a href="#PSRS算法" class="headerlink" title="PSRS算法"></a>PSRS算法</h2><p>并行正则采样排序算法</p>
<p><img src="https://pic2.zhimg.com/80/v2-28a103ab8e3911ae13feaa3f9f663d51_1440w.webp" alt="PSRS"></p>
<h3 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h3><p>简单地讨论一下 PSRS 算法的复杂度。</p>
<ul>
<li>在第一部分的快速排序中，时间复杂度为O(klogk)，k&#x3D;n&#x2F;p</li>
<li>然后，各处理器选择 p-1 个代表元素，代价为O(p)</li>
<li>再由 Proc#0 对所有送来的代表元素进行排序，然后选出主元，这里若使用快速排序，代价为O(p^2 logp^2)<ul>
<li>而若使用归并排序，则所需代价为O(p^2)</li>
</ul>
</li>
<li>每个处理器接收到主元后，再对有序数组进行划分，代价为O(k+p)</li>
<li>最后，各个处理器全局交换，并行归并排序，<ul>
<li>每个处理器是串行的<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000009723817">多路归并问题</a>，时间复杂度为<code>O(k*logp)</code></li>
</ul>
</li>
</ul>
<p>考虑到实际应用中，需要排序的数据长度 n 一定远远多于现有的处理器 p，此时可以视 p 为一个小常数，那么 PSRS 排序算法的时间复杂度，就可以简化为 <code>O(klogk+k*logp)~O(klogk)</code></p>
<p>从消息复杂度的角度看，</p>
<ul>
<li>播送主元的复杂度为 O(p^2+p)</li>
<li>分区合并（全局交换）部分的消息复杂度与具体算法实现相关，但其最大值不会超过 O(n)</li>
</ul>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><!-- 字节的面试官抓着这点问，我确实没仔细研究比较过。 -->

<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>上面回答部分<strong>来自ChatGPT-3.5</strong>，没有进行正确性的交叉校验。</p>
<p><a target="_blank" rel="noopener" href="https://dingfen.github.io/mpi&openmp/2021/01/23/psrs_sort.html">https://dingfen.github.io/mpi&amp;openmp/2021/01/23/psrs_sort.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-07-16T16:00:00.000Z" title="7/16/2023, 4:00:00 PM">2023-07-16</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.227Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">19 minutes read (About 2811 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/07/16/Work/Operating%20system/userKernelMode/">User Kernel Mode</a></p><div class="content"><h2 id="内核态"><a href="#内核态" class="headerlink" title="内核态"></a>内核态</h2><p>内核态是计算机系统中的一种特权模式，用于执行操作系统内核的代码和功能。与用户态相比，内核态具有更高的权限和更广泛的访问能力，可以执行一些用户态无法执行的关键任务和操作。下面是从用户态的角度上介绍内核态的功能：</p>
<ol>
<li>系统调用（System Calls）：内核态允许用户程序通过系统调用接口请求操作系统提供的服务和功能。用户程序可以通过系统调用请求文件操作、网络通信、内存管理等操作。当用户程序执行系统调用时，会触发从用户态切换到内核态的转换，以便内核在高权限下执行相应的操作。</li>
<li>资源管理：内核态负责管理计算机系统的各种资源，包括处理器、内存、磁盘、网络等。在内核态下，操作系统可以对这些资源进行分配、调度和释放，确保资源的有效利用和合理分配。</li>
<li>中断处理：当发生硬件中断或异常时，内核态负责处理中断并提供相应的服务。例如，当用户程序需要与设备进行交互时，内核可以响应设备的中断信号，进行数据传输、状态检查等操作。</li>
<li>进程管理：内核态负责创建、销毁和管理进程。它可以调度进程，分配和回收进程所需的资源，并在必要时进行进程间的通信和同步。</li>
<li>内存管理：内核态控制着计算机系统的内存分配和管理。它负责将物理内存分配给进程，并维护虚拟内存和物理内存之间的映射关系。内核还处理内存保护、页面置换、内存回收等任务。</li>
<li>设备驱动程序：内核态包含设备驱动程序，用于与硬件设备进行交互。它允许操作系统通过设备驱动程序来控制和管理硬件设备，如磁盘驱动程序、网络驱动程序等。</li>
<li>安全和权限管理：内核态能够执行与系统安全和权限相关的任务。它可以控制对系统资源的访问权限，并确保用户程序不能越权访问或修改关键数据和系统配置。</li>
</ol>
<p>总的来说，内核态提供了操作系统核心功能的执行环境，拥有更高的权限和更广泛的访问能力，使得操作系统能够管理和控制计算机系统的各个方面，同时为用户程序提供必要的服务和保护。</p>
<h3 id="代码位置"><a href="#代码位置" class="headerlink" title="代码位置"></a>代码位置</h3><p><img src="https://pic.shaojiemike.top/img/20211225203420.png"></p>
<p>在Linux系统中，每个进程的虚拟地址空间中的高位部分通常被映射为内核空间，其中包含了内核态的代码和数据。这个区域通常被称为内核空间或内核页表。内核空间中的内容包括以下两类：</p>
<ol>
<li>内核代码：内核代码是操作系统内核的实现，包括各种系统调用、设备驱动程序和核心功能的代码。这些代码用于提供操作系统的各种服务和功能，如文件系统操作、进程管理、内存管理、网络通信等。内核代码是所有进程共享的，因为它们代表了操作系统的核心部分，为所有进程提供服务。</li>
<li>共享内核数据结构：内核空间中还包含一些共享的内核数据结构，用于维护系统状态和资源管理。例如，进程调度器、内存管理数据结构、文件描述符表等。这些数据结构被多个进程共享，以便内核能够管理和控制系统资源的分配和使用。</li>
</ol>
<p>除了以上共享的内容，内核空间还包含一些每个进程独有的部分，例如：</p>
<ol>
<li>进程描述符（Process Descriptor）：每个进程都有一个唯一的进程描述符，其中包含了进程的状态信息、上下文和其他与进程相关的数据。进程描述符存储在内核空间，每个进程都有自己独立的进程描述符。</li>
<li>用户栈和内核栈：每个进程都有自己的用户栈和内核栈。用户栈用于保存进程在用户态执行时的局部变量和函数调用信息，而内核栈用于保存进程在内核态执行时的上下文信息和函数调用。（内核函数也要嵌套调用）</li>
</ol>
<p>总结起来，Linux进程的高位部分映射了内核空间，其中包含了内核代码、共享的内核数据结构以及每个进程独有的部分，如进程描述符和栈空间。这种映射允许进程与内核进行交互和访问操作系统的功能和服务。</p>
<h3 id="如何共享"><a href="#如何共享" class="headerlink" title="如何共享"></a>如何共享</h3><p>在内核中，代码共享并不是通过动态链接库（.so）的模式来实现的。内核态的代码通常被编译成内核模块或者直接编译进内核映像中，而不是作为独立的可加载库。因此，内核中的代码共享机制与用户空间中的动态链接库不同。</p>
<p>在内核中，代码共享是通过代码复用和内核模块的概念来实现的。内核模块是一种可以动态加载和卸载的代码和数据集合，它可以扩展内核的功能。内核模块可以包含新的设备驱动程序、文件系统、网络协议等，以便在需要时被加载到内核中运行。</p>
<p>内核模块的加载过程可以在运行时根据需要进行，而不需要重新编译整个内核。这样，多个进程可以共享同一个内核模块，从而实现内核代码的共享。当多个进程需要使用某个内核模块时，模块只需要加载一次，然后被多个进程共享调用。</p>
<p>值得注意的是，内核中的代码共享是在内核空间内部进行的，与用户空间的动态链接库不同，它不涉及用户进程的地址空间和加载机制。内核模块的共享是在内核内部完成的，不同进程间可以通过系统调用接口访问共享的内核模块提供的功能和服务。</p>
<p>总结起来，内核中的代码共享是通过内核模块的加载和运行机制来实现的，而不是像用户空间中的动态链接库那样。内核模块可以被多个进程共享调用，从而提供共享的内核功能和服务。</p>
<h2 id="内核态与用户态切换"><a href="#内核态与用户态切换" class="headerlink" title="内核态与用户态切换"></a>内核态与用户态切换</h2><h3 id="切换时机"><a href="#切换时机" class="headerlink" title="切换时机"></a>切换时机</h3><p>内核态与用户态的切换通常由以下几种情况触发：</p>
<ul>
<li>系统调用（System Call）：当用户程序通过系统调用请求操作系统提供的服务时，会触发从用户态到内核态的切换。这是最常见的切换方式。</li>
<li>异常（Exception）和中断（Interrupt）：当发生硬件中断、软件中断（如除零错误）、内存访问错误等异常情况时，CPU会切换到内核态来处理异常。这些异常可以是由程序错误、设备请求或其他条件引起的。</li>
<li>外部事件：例如时钟中断、I&#x2F;O 完成中断等，这些事件可能需要内核处理，因此会导致从用户态切换到内核态。</li>
</ul>
<h3 id="切换的细节"><a href="#切换的细节" class="headerlink" title="切换的细节"></a>切换的细节</h3><p>当进程从用户态切换到内核态，或者从内核态切换回用户态时，涉及到特权级的切换和上下文的保存与恢复。下面是内核态与用户态切换的一般细节：</p>
<ol>
<li><p>特权级切换：内核态拥有更高的特权级别，因此从用户态切换到内核态时，CPU会从当前运行的用户模式切换到内核模式。这种切换会改变CPU的状态，包括特权级、堆栈和指令指针。</p>
</li>
<li><p>上下文保存与恢复：在切换到内核态之前，CPU会保存当前用户态下的进程上下文信息，包括程序计数器（PC）、寄存器的值、堆栈指针等。这些上下文信息保存在进程的内核栈中。</p>
</li>
<li><p>内核态执行：当切换到内核态后，CPU开始执行相应的内核代码，处理请求或异常。在内核态下，操作系统可以访问和操作系统的所有资源和功能，执行必要的操作。</p>
</li>
<li><p>上下文恢复与切换回用户态：当内核态的任务完成后，CPU会从内核栈中恢复之前保存的进程上下文信息。然后，CPU会将特权级切换回用户态，并从保存的程序计数器继续执行用户程序。</p>
</li>
</ol>
<p>需要注意的是，内核态与用户态的切换涉及到CPU和操作系统的底层机制，具体细节可能会因操作系统的设计和架构而有所不同。上述描述是一般情况下的概述，不同的操作系统和处理器架构可能会有特定的实现细节。</p>
<h3 id="开销来源"><a href="#开销来源" class="headerlink" title="开销来源"></a>开销来源</h3><ol>
<li>特权级切换</li>
<li>上下文保存与恢复</li>
<li>由于PTI的存在，内核维护了两套页表。切换到内核态时，可能需要切换内存地址空间的映射关系，例如将用户态的虚拟地址空间映射为内核态的地址空间。这可能涉及页表的切换和TLB（Translation Lookaside Buffer）的刷新，会带来一定的延迟和开销。</li>
</ol>
<h3 id="量化"><a href="#量化" class="headerlink" title="量化"></a>量化</h3><p>内核态与用户态的切换时间在数百到数千个CPU周期之间</p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>上面回答部分<strong>来自ChatGPT-3.5</strong>，没有进行正确性的交叉校验。</p>
<div id='refer-anchor'></div>

<p>无</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-07-14T16:00:00.000Z" title="7/14/2023, 4:00:00 PM">2023-07-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.233Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">4 minutes read (About 663 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/07/14/Work/HPC/IPCC/IPCC2022final/">IPCC2022final</a></p><div class="content"><p><img src="https://pic.shaojiemike.top/img/20221203200751.png"></p>
<h2 id="学到的一些亮点"><a href="#学到的一些亮点" class="headerlink" title="学到的一些亮点"></a>学到的一些亮点</h2><p><img src="https://pic.shaojiemike.top/img/20221202184317.png"></p>
<p><img src="https://pic.shaojiemike.top/img/20221202184521.png"></p>
<h2 id="总结反思"><a href="#总结反思" class="headerlink" title="总结反思"></a>总结反思</h2><p>由于决赛是黑盒制度，没有排行榜，也不知道最终算分的例子是多大。我们优化着眼于自己找的清华的大例子，并行的占比在这部分很小。忽略了小例子里，占比比较高的部分的优化。结果最终赛题例子很小。</p>
<p><img src="https://pic.shaojiemike.top/img/20221202185953.png"></p>
<p>如果提前知道元素个数，并行对同一个数组的末尾添加元素可以并行，添加到指定位置之后再统一排序就行。比如山东大学，就是这里快了大约10ms，加上第一次排序快5ms。</p>
<p><img src="https://pic.shaojiemike.top/img/20221203103311.png"></p>
<p>比如信息中心(应该是第一名)的排序，用的是归并的基数排序<img src="https://pic.shaojiemike.top/img/20221203195910.png"></p>
<p>比如青海大学的优化：<img src="https://pic.shaojiemike.top/img/20221202191111.png"></p>
<p>还有高效的排序，怎么实现。<a target="_blank" rel="noopener" href="https://github.com/cermi29/ParallelStableSort">类似</a></p>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p><img src="https://pic.shaojiemike.top/img/20221202191656.png"></p>
<p>CSR (压缩稀疏行存储) 矩阵和邻接表在表示图数据结构时,计算和访问性能有些差异:</p>
<ul>
<li>CSR通过压缩行存储机制,可以大幅减少空间占用,节省内存。但索引算术运算负担重一些</li>
<li>邻接表使用链表指针连接相邻节点,追踪任意一条边的开销很低。但总体占用内存空间更大。</li>
<li>CSR访问任意一个元素通过索引计算直接可以定位,兼具稠密和稀疏矩阵的特点。</li>
<li>邻接表的边访问性能更好,通过指针直接遍历一个节点的所有相邻节点。</li>
<li>CSR的预处理时间较短,更易于向量化实现提高效率。</li>
<li>邻接表更灵活,可表示加权图或处理动态变化的图。</li>
<li>CSR矩阵更易进行压缩和剪枝来优化存储,节省内存带宽。</li>
</ul>
<p>所以简单来说,如果图更稠密,数据访问模式更随机,CSR可能会有些优势。如果需要频繁遍历边,图结构变化大,邻接表访问效率可能会更高一些。需要根据具体情况选择合适的表示。</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><p>哎呀，你干嘛！ 今年又<del>西巴了</del>,惜败了，应该是第三名左右。</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'></div>
无

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-05-11T16:00:00.000Z" title="5/11/2023, 4:00:00 PM">2023-05-11</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.281Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">23 minutes read (About 3410 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/11/Work/network/Protocol/BT/">BitTorrent</a></p><div class="content"><h2 id="BT简述"><a href="#BT简述" class="headerlink" title="BT简述"></a>BT简述</h2><p>BitTorrent (简称 BT) 协议是和点对点（point-to-point）的协议程序不同，它是用户群对用户群（peer-to-peer, 或简写为 P2P) 传输协议, 它被设计用来高效地分发文件 (尤其是对于大文件、多人同时下载时效率非常高)。该协议基于HTTP协议，属于TCP&#x2F;IP应用层。</p>
<p>将文件划分成多块(默认256Kb一块)，每块可以从网络中不同的用户的BT客户端处并行下载。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BT 下载的文件都是别人上传给你的。</span><br><span class="line">BT 下载速度均来自其他下载同一资源的用户上传速度。</span><br><span class="line">上传的用户越多，你的下载速度越快，相反没用户上传你就没有下载速度。</span><br></pre></td></tr></table></figure>

<p>比特彗星，包括其他 BT 软件（迅雷除外，迅雷不是会员会限速，高速通道下载提高的速度一部分就是接触限速后获得的）都不会限制下载速度。</p>
<h3 id="BT分享规则"><a href="#BT分享规则" class="headerlink" title="BT分享规则"></a>BT分享规则</h3><p>与迅雷不同，BT旨在“人人为我，我为人人”。用户和用户之间对等交换自己手中已有的资源。如果任何一方试图白嫖另外一方的资源，而自己不愿意上传自己的资源，那么那方就会被人视作吸血者而被踢出这个交换，下场是没有人会愿意和你交换数据，你的下载速度也就归零。</p>
<p>如果把上传速度限制为了10KB&#x2F;s，10KB&#x2F;s是BitComet上传最低限速，很大时候就这10KB会被包含DHT查询、向Tracker服务器注册，连接用户所产生的上传全部占满。在下载种子的时候，其他用户连上你是只能拿到1～2KB&#x2F;s甚至一点都没有的。</p>
<p>现在的BT下载客户端都可以做到智能反吸血，所以基本想和交换数据的用户都把你当作Leecher（吸血鬼）Ban（封禁）处理了，故没有下载速度不足为奇。</p>
<p>一般来说，只要预留50KB&#x2F;s的上传给其他网页浏览、聊天就可以了，在下载时应该尽量把上传留给那些和你交换资源的用户，这样才不会被他们视作你在吸血进而屏蔽你。</p>
<p>如果上传不足，就应该主动限制自己的下载速度，否则单位时间下载量远超过上传量反而会遭来更多的屏蔽，对下载速度提升更加不利。</p>
<h3 id="BT基本流程"><a href="#BT基本流程" class="headerlink" title="BT基本流程"></a>BT基本流程</h3><p><code>.torrent</code> 种子文件本质上是文本文件，包含Tracker信息和文件信息两部分。Tracker信息主要是BT下载中需要用到的Tracker服务器的地址和针对Tracker服务器的设置。</p>
<ol>
<li>下载时，BT客户端首先解析种子文件得到Tracker地址，然后连接Tracker服务器。</li>
<li>Tracker服务器回应下载者的请求，提供下载者其他下载者（包括发布者）的IP。</li>
<li>下载者再连接其他下载者，根据种子文件，两者分别告知对方自己已经有的块，然后交换对方所没有的数据。<ol>
<li>此时不需要其他服务器参与，分散了单个线路上的数据流量，因此减轻了服务器负担。</li>
</ol>
</li>
<li>下载者每得到一个块，需要算出下载块的Hash验证码与种子文件中的对比，如果一样则说明块正确，不一样则需要重新下载这个块。这种规定是为了解决下载内容准确性的问题。</li>
</ol>
<h2 id="常规部署"><a href="#常规部署" class="headerlink" title="常规部署"></a>常规部署</h2><ul>
<li>安装<a target="_blank" rel="noopener" href="https://manpages.ubuntu.com/manpages/jammy/man1/qbittorrent-nox.1.html">qBittorrent-nox</a>, tmux下运行，在8080端口挂载WebUI</li>
<li>安装qbittorrent, 用户运行qbittorrent, x11弹出应用窗口<ul>
<li>问题：<ul>
<li>怎么维持窗口？<code>sudo XAUTHORITY=/home/qcjiang/.Xauthority qbittorrent</code></li>
<li>关于写文件权限，如何写网络硬盘</li>
<li>node5 上传很快, 网络原因？种子原因？(不是，是因为网络硬盘，所以下载多少要占用多少上传)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="docker部署"><a href="#docker部署" class="headerlink" title="docker部署"></a>docker部署</h2><p>以qBit的docker为例，参考<a target="_blank" rel="noopener" href="https://hub.docker.com/r/linuxserver/qbittorrent/#!">linuxsever</a>的docker-compose如下：(qBit相对于Transmission有多线程IO的优势) 也可以使用<a target="_blank" rel="noopener" href="https://github.com/SuperNG6/Docker-qBittorrent">其余docker镜像</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">version: &quot;2.1&quot;</span><br><span class="line">services:</span><br><span class="line">  qbittorrent:</span><br><span class="line">    image: lscr.io/linuxserver/qbittorrent:latest</span><br><span class="line">    container_name: qbittorrent</span><br><span class="line">    environment:</span><br><span class="line">      - PUID=0 # 这里是root 如果想以其他用戶A修改文件，可以改成其他用户的UID。通過id A 查看</span><br><span class="line">      - PGID=0</span><br><span class="line">      - TZ=Etc/UTC</span><br><span class="line">      - WEBUI_PORT=8080</span><br><span class="line">    volumes:</span><br><span class="line">      - /addDisk/DiskNo4/qBit:/config</span><br><span class="line">      - /addDisk/DiskNo4/bt:/downloads</span><br><span class="line"></span><br><span class="line">    network_mode: host</span><br><span class="line">    restart: unless-stopped</span><br></pre></td></tr></table></figure>

<p>默认账号 <code>admin</code> 默认密码 <code>adminadmin</code><br>然后通过webUI <code>http://222.195.72.218:8080/</code>管理。</p>
<article class="message is-success">
        <div class="message-header"><p><i class="fa-brands fa-gripfire mr-2"></i>忘记密码处理</p>
</div>
        <div class="message-body">
            <p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/374538088">修改对应配置文件，</a></p>

        </div>
    </article>

<p>如果不想网络通过wireguard，而是本地可以如下设置</p>
<p><img src="https://pic.shaojiemike.top/img/20230314193709.png"></p>
<h3 id="同一台机器实现两个账号做种"><a href="#同一台机器实现两个账号做种" class="headerlink" title="同一台机器实现两个账号做种"></a>同一台机器实现两个账号做种</h3><ul>
<li>思路：两个docker，同一个网络出口</li>
<li>問題：<ul>
<li>qBit要有权限写文件</li>
<li>两个docker兼容性：<ul>
<li>WebUI有bug，不一定会显示。重启刷新即可</li>
<li>其次有一个docker会没有网络。<ul>
<li>这是由于端口随机错误导致的，会导致下面连接状态显示火焰。换端口刷新即可解决。</li>
<li><img src="https://pic.shaojiemike.top/img/20230512090749.png"></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>关于封号<ul>
<li>由于国内环境下载一般都是大内网。同一个网络出去应该没有问题。</li>
<li>大多数做种是通过ipv6，会被检测出同一个机器多个账户做种，导致封号</li>
<li>还有关于盒子刷上传，一方面通过速度，另一方面由于盒子的ip是固定的，所以会被检测出重复导致封号。</li>
</ul>
</li>
</ul>
<h2 id="测速"><a href="#测速" class="headerlink" title="测速"></a>测速</h2><ol>
<li>先用 <a target="_blank" rel="noopener" href="https://www.speedtest.net/">https://www.speedtest.net</a> 测速<ol>
<li><img src="https://pic.shaojiemike.top/img/20221117082208.png"></li>
</ol>
</li>
<li>考虑热门种子测试 <a target="_blank" rel="noopener" href="http://releases.ubuntu.com/19.10/ubuntu-19.10-desktop-amd64.iso.torrent">http://releases.ubuntu.com/19.10/ubuntu-19.10-desktop-amd64.iso.torrent</a><ol>
<li><img src="https://pic.shaojiemike.top/img/20221117084350.png"></li>
<li>没通过代理能找到的用户变少，速度也变慢了。</li>
</ol>
</li>
<li>如果跑不到网络上限，可能和<a target="_blank" rel="noopener" href="https://www.cometbbs.com/t/%E8%A2%AB%E9%99%90%E9%80%9F%E5%9C%A8109mbs/34309/13">软件设置有关</a></li>
</ol>
<h2 id="上传速度"><a href="#上传速度" class="headerlink" title="上传速度"></a>上传速度</h2><p>m站刷上传的时候，发现基本都是对方基本都是通过ipv6下载<br><img src="https://pic.shaojiemike.top/img/Snipaste_2023-03-06_18-17-07.png"><br>uTP是一种基于UDP的协议，它可以根据网络拥塞情况自动调节传输速度，从而减少对其他网络应用的影响。</p>
<p>BT连接是一种基于TCP的协议，它可以保证数据的完整性和可靠性，但是可能会占用较多的网络带宽和资源。</p>
<p>在qBittorrent中，标志U K E P分别表示以下含义：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">U：表示你正在上传数据给对方，或者对方正在从你那里下载数据。</span><br><span class="line">K：表示对方支持uTP协议，即基于UDP的传输协议。</span><br><span class="line">E：表示对方使用了加密连接，即通过加密算法保护数据的安全性。</span><br><span class="line">P：表示对方使用了代理服务器或VPN服务，即通过第三方网络隐藏自己的真实IP地址。</span><br></pre></td></tr></table></figure>

<h2 id="PT设置"><a href="#PT设置" class="headerlink" title="PT设置"></a>PT设置</h2><ul>
<li>虽然说PT下载，客户端要关闭DHT,PeX, LSD。</li>
<li>但是其实种子是默认关闭的，无序额外设置，北洋和M站一样。</li>
<li><img src="https://pic.shaojiemike.top/img/20230512091246.png"></li>
</ul>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h3 id="Tracker"><a href="#Tracker" class="headerlink" title="Tracker"></a>Tracker</h3><p>收集下载者信息的服务器，并将此信息提供给其他下载者，使下载者们相互连接起来，传输数据。</p>
<h3 id="种子"><a href="#种子" class="headerlink" title="种子"></a>种子</h3><p>指一个下载任务中所有文件都被某下载者<strong>完整</strong>的下载，此时下载者成为一个种子。发布者本身发布的文件就是原始种子。</p>
<h3 id="做种"><a href="#做种" class="headerlink" title="做种"></a>做种</h3><p>发布者提供下载任务的<strong>全部</strong>内容的行为；下载者下载完成后继续提供给他人下载的行为。</p>
<h3 id="分享率"><a href="#分享率" class="headerlink" title="分享率"></a>分享率</h3><p>上傳資料量 &#x2F; 下傳資料量的比率,是一種BT的良心度,沒實際作用.(一般为了良心，至少大于1)</p>
<h3 id="长期种子"><a href="#长期种子" class="headerlink" title="长期种子"></a>长期种子</h3><p>BitComet的概念，相对于种子任务的上传能够控制。</p>
<p>长效种子就是你<strong>不开启</strong>任务做种，只要你启动了比特彗星，软件挂后台，当有其他用户也是用比特彗星下载你列表里的存在的文件时候就会被认为是长效种子 。</p>
<h3 id="DHT"><a href="#DHT" class="headerlink" title="DHT"></a>DHT</h3><p>.DHT全称叫分布式哈希表(Distributed Hash Table)，是一种分布式存储方法。在不需要服务器的情况下，每个客户端负责一个小范围的路由，并负责存储一小部分数据，从而实现整个DHT网络的寻址和存储。新版BitComet允许同行连接DHT网络和Tracker，也就是说在完全不连上Tracker服务器的情况下，也可以很好的下载，因为它可以在DHT网络中寻找下载同一文件的其他用户。</p>
<p>类似Tracker的根据种子特征码返回种子信息的网络。</p>
<p>在BitComet中，无须作任何设置即可自动连接并使用DHT网络，完全不需要用户干预。</p>
<h3 id="用户交换Pex"><a href="#用户交换Pex" class="headerlink" title="用户交换Pex"></a>用户交换Pex</h3><p>Peer Exchange (PEX)， 每个peer客户端的用户列表，可以互相交换通用。可以将其理解为“节点信息交换”。前面说到了 DHT 网络是没有中心服务器的，那么我们的客户端总不能满世界去喊：“我在下载这个文件，快来连我吧.”（很大声）。所以就通过各个 BT 客户端自带的节点去同步路由表实现 DHT 网络连接。</p>
<h3 id="本地用户发现"><a href="#本地用户发现" class="headerlink" title="本地用户发现"></a>本地用户发现</h3><p>LSD（LPD）就是本地网络资源，内网下载，没什么几把用的东西，可能学校等私有网络好使</p>
<h3 id="ISP"><a href="#ISP" class="headerlink" title="ISP"></a>ISP</h3><p>網絡業務提供商(Internet Service Provider，簡稱ISP)，互聯網服務提供商，即向廣大用户綜合提供互聯網接入業務、信息業務、和增值業務的電信運營商。</p>
<h2 id="反吸血机制"><a href="#反吸血机制" class="headerlink" title="反吸血机制"></a>反吸血机制</h2><h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><ol>
<li>根据<strong>流量</strong>： 默认设置为120秒，持续对某个peer产生上传，并且从该peer用户获取的下载流量没有超过1KB文件（1024字节）大小，即拉黑该peer，预警颜色为黄色，合法为绿色，红色为封禁。</li>
<li>可组合检测<strong>指定客户端</strong>进行反吸血，比如说指定屏蔽qbittorrent、utorrent等吸血客户端选择（可多选客户端，可对下载任务和做种任务生效）</li>
<li>可组合检测客户端<strong>连接端口号</strong>进行反吸血，比如说指定屏蔽15000迅雷X版本客户端等吸血端口（可多选端口号，可对下载任务和做种任务生效）</li>
<li>可组合检测客户端<strong>连接peer_id标志符</strong>进行反吸血屏蔽，例如屏蔽XL0018客户端等吸血标志符（可多选标志符，可对下载任务和做种任务生效）</li>
</ol>
<h3 id="高级设置"><a href="#高级设置" class="headerlink" title="高级设置"></a>高级设置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bittorrent.anti_leech_min_byte</span><br><span class="line">设定反吸血保护流量：要求对方在指定时间（秒）内需要上传的最少流量（byte）， 取值范围：1-10000。</span><br><span class="line"></span><br><span class="line">bittorrent.anti_leech_min_stable_sec</span><br><span class="line">设定反吸血保护时间：指定与对方连接多长时间（秒）后开始检查流量（byte），取值范围：1-10000。</span><br></pre></td></tr></table></figure>

<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="需要软件开着吗？"><a href="#需要软件开着吗？" class="headerlink" title="需要软件开着吗？"></a>需要软件开着吗？</h3><p>需要</p>
<h3 id="原文件改名或者移动，还会上传吗？"><a href="#原文件改名或者移动，还会上传吗？" class="headerlink" title="原文件改名或者移动，还会上传吗？"></a>原文件改名或者移动，还会上传吗？</h3><p>文件下载后不能移动，不能删除，不能重命名（但可以在软件内改）。 一但BT 软件找不到文件，或删除了任务，就无法做种上传了。</p>
<h3 id="晚上避免上传"><a href="#晚上避免上传" class="headerlink" title="晚上避免上传"></a>晚上避免上传</h3><p>可以在Bitcomet<strong>高级设置</strong>里设置<strong>时段限速</strong></p>
<h3 id="对硬盘损害大吗？"><a href="#对硬盘损害大吗？" class="headerlink" title="对硬盘损害大吗？"></a>对硬盘损害大吗？</h3><p>分享上传也需要频繁读取硬盘。</p>
<p>以Bitcomet为例，该软件就是通过磁盘缓存技术减小频繁随机读写对硬盘的损伤。</p>
<p>磁盘缓存就是利用物理内存作为缓冲，将下载下的数据先存放于内存中，然后定期的一次性写入硬盘，以减少对硬盘的写入操作，很大的程度上降低了磁盘碎片。</p>
<p>因为通常我们设置内存（磁盘缓存）为每任务XX兆，意味着，这个缓冲区可以存放数兆甚至几十兆的“块”，基本上可以杜绝碎片了。</p>
<p>现在BT软件都是自动设置缓存的，它是根据你物理内存的大小分配的。</p>
<h2 id="注意设置"><a href="#注意设置" class="headerlink" title="注意设置"></a>注意设置</h2><ol>
<li>设置了“反吸血”，应对迅雷</li>
<li>校园网设置9，不限制P2P<ol>
<li>国内各省份不同运营商限速策略（QOS）</li>
</ol>
</li>
</ol>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>路由器下载？</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-05-11T16:00:00.000Z" title="5/11/2023, 4:00:00 PM">2023-05-11</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.282Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">9 minutes read (About 1300 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/11/Work/network/example/mountNetworkDisk/">Mount Network Disk</a></p><div class="content"><article class="message is-info">
        <div class="message-header"><p><i class="fa-solid fa-clipboard mr-2"></i>导言</p>
</div>
        <div class="message-body">
            <p>想将Nas上的盘挂载到常驻的Ubuntu机器上，供jellyfin读取。</p>

        </div>
    </article></div><a class="article-more button is-small is-size-7" href="/2023/05/11/Work/network/example/mountNetworkDisk/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-05-05T16:00:00.000Z" title="5/5/2023, 4:00:00 PM">2023-05-05</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.192Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">10 minutes read (About 1439 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/05/Thinking/4-viewOnOthers/4.1-FilmTVRating/">UnimportantView: Film &amp; TV(Anime) Works Rating</a></p><div class="content"><h2 id="如何评价影视剧-动漫作品"><a href="#如何评价影视剧-动漫作品" class="headerlink" title="如何评价影视剧(动漫作品)"></a>如何评价影视剧(动漫作品)</h2><p>我一向的观点是现实生活已经投入了很多时间体验了，影视剧(动漫作品)肯定要是看现实中没有的。这导致的第一个问题就是既然不存在，你怎么让观众相信呢？</p>
<ul>
<li>真实的氛围感<ul>
<li>真实的细节特效</li>
<li>真实的演员反映和期望中的样子</li>
</ul>
</li>
</ul>
<h2 id="如何评价对影视剧-动漫作品-角色的喜爱程度"><a href="#如何评价对影视剧-动漫作品-角色的喜爱程度" class="headerlink" title="如何评价对影视剧(动漫作品)角色的喜爱程度"></a>如何评价对影视剧(动漫作品)角色的喜爱程度</h2><ul>
<li><p>喜欢一个角色往往是没有什么理由的，虽然要追求格物致知。但是将最感性的情感拿来分析是不是有点无情呢？</p>
</li>
<li><p>初印象的美好(40)</p>
<ul>
<li>外貌美(15):<ul>
<li>不一定要完美，但是要有特点，</li>
<li>可以接受有缺陷，但是其一般要具有意义来完善人物塑造。</li>
</ul>
</li>
<li>可爱俏皮(5)<ul>
<li>可以拉进距离感</li>
</ul>
</li>
<li>性格好(乐观、勇敢、坚毅、聪明)(10)<ul>
<li>角色不可能不经历挫折，乐观还是要一点</li>
<li>但是白给的老好人不行，还是要有基础原则的</li>
<li>可以出发点很低(一开始比较恶劣,自闭)，为角色后续成长留下了空间</li>
</ul>
</li>
<li>强烈独特独立的个性魅力、个人行为准则坚定(10)<ul>
<li>额外固执但是专情</li>
<li>病娇(特别爱一个人)，想守护妹妹的想法</li>
<li>厌世，缺爱</li>
</ul>
</li>
</ul>
</li>
<li><p>角色剧情行事逐渐展示出来的</p>
<ul>
<li>真实感(反差,与观众拉近距离) (20)<ul>
<li>平时严酷，但也会含羞</li>
<li>总是公正，但也会偏私</li>
</ul>
</li>
<li>悲剧色彩，激发了同情心(共情)(0~30)<ul>
<li>努力却依旧失败、正义行事却危机四伏、爱而不得、无所谓付出。一哭 +10</li>
<li>美好的东西被摧毁总是令人扼腕痛心，令人印象深刻。+10<ul>
<li>失去美好的未来</li>
</ul>
</li>
<li>刀人：刀友情，刀亲情 +10</li>
</ul>
</li>
<li>共鸣？观众随角色一同成长(40)<ul>
<li>如果观众一开始有一样的疑惑，(10)</li>
<li>然后和角色一起寻找答案 (10)</li>
<li>最后坚定的相信自己找到的 (20)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><ul>
<li>星野爱(113)<ul>
<li>外貌(5)：不是特别感冒的形象</li>
<li>可爱俏皮(2)</li>
<li>乐观性格(6)：演出也有时迷茫，却为了孩子开朗了起来</li>
<li>独特和自我(10)： 厌世，缺爱让人同情</li>
<li>真实感(20)：以谎言编织的怀孕偶像，是最大的反差</li>
<li>悲剧色彩(30)：<ul>
<li>想学会爱，但是到死还在努力</li>
<li>失去了与孩子们的未来</li>
<li>刀母爱</li>
</ul>
</li>
<li>共鸣与成长(40)<ul>
<li>疑惑: 不会爱的人怎么办</li>
<li>寻找：以谎言代替</li>
<li>结论：谎言也是我努力传达爱意的方式。但唯独我爱你们，这句话……绝对不是谎言</li>
</ul>
</li>
</ul>
</li>
<li>亚斯娜(100)<ul>
<li>外貌(15)：理想的人妻</li>
<li>可爱俏皮(5)</li>
<li>乐观性格(10)：理想的姐姐人妻性格，爱你管你又不太束缚你</li>
<li>独特和自我(10)： 为了Kirito 愿意牺牲自己</li>
<li>真实感(20)：平时严酷，但也会含羞</li>
<li>悲剧色彩(10)：<ul>
<li>刀爱情， 差一点失去Kirito</li>
</ul>
</li>
<li>共鸣与成长(30)<ul>
<li>疑惑: 在虚拟世界里，存在的意义是什么</li>
<li>寻找：寻找虚拟世界“红莫罗”的东西</li>
<li>结论：这份感情与相遇的经历是真实的(10,结论不够动容)</li>
</ul>
</li>
</ul>
</li>
<li>爱莉希雅Elysia(125)<ul>
<li>外貌(15)：理想的人妻2</li>
<li>可爱俏皮(10) 与芽衣打情骂俏，甜齁了(摸角)。额外加分+5</li>
<li>乐观性格(10)：理想的姐姐人妻性格，</li>
<li>独特和自我(10)： 真我 ~ 人之律者</li>
<li>真实感(20)：平时严酷，但也会含羞（神之子却爱上了人类）</li>
<li>悲剧色彩(30)：<ul>
<li>出生无知的律者，努力爱人类，却不被理解</li>
<li>反而为人类牺牲</li>
<li>本世代对抗侵蚀之律者，最终数据还被删除</li>
</ul>
</li>
<li>共鸣与成长(30)<ul>
<li>疑惑: 凡事任凭心意而为，自由自在，与副首领的身份格格不入的往事乐土的少女是谁</li>
<li>寻找：寻找前世的真相与少女的秘密</li>
<li>结论：即使往事乐土不存在了，但只要这份记忆还在，你就永远还在。愿时光永驻此刻(10,结论不够动容)</li>
</ul>
</li>
</ul>
</li>
<li>光与焰(120)<ul>
<li>外貌(15)：两个人各有特点</li>
<li>可爱俏皮(5) </li>
<li>乐观性格(10)：理想的姐姐人妻性格，</li>
<li>独特和自我(10)： 光傲娇 焰体贴</li>
<li>真实感(25)：光性格上与焰完全相反，非常要强，不擅长表达自己的感情，但本性其实很温柔，内心很脆弱。<ul>
<li>高质量CG的游戏，真实沉浸感额外加分+5</li>
</ul>
</li>
<li>悲剧色彩(20)：<ul>
<li>被坏人利用，虽然不愿意，但是伤害了世界，</li>
<li>喜欢lex，最后还是牺牲了自己(lex,你一个人也没关系了吧！)</li>
</ul>
</li>
<li>共鸣与成长(35)<ul>
<li>疑惑: 无意间结实的少女</li>
<li>寻找：寻找世界的真相与少女的秘密</li>
<li>结论：即使有前世的经历。但是愿意忘记悲伤的过去。从现在开始彼此守护(15,结论不够动容)</li>
</ul>
</li>
</ul>
</li>
<li>评价模板<ul>
<li>外貌(15)：理想的人妻</li>
<li>可爱俏皮(5)</li>
<li>乐观性格(10)：理想的人妻性格</li>
<li>独特和自我(10)： </li>
<li>真实感(20)：</li>
<li>悲剧色彩(30)：<ul>
<li>想</li>
<li>失去了</li>
<li>刀</li>
</ul>
</li>
<li>共鸣与成长(40)<ul>
<li>疑惑: </li>
<li>寻找：</li>
<li>结论：</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><p>看了星野爱之后，我又emo了</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><div id='refer-anchor'></div>
无
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-04-26T16:00:00.000Z" title="4/26/2023, 4:00:00 PM">2023-04-26</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-26T12:59:30.251Z" title="9/26/2024, 12:59:30 PM">2024-09-26</time></span><span class="level-item"><a class="link-muted" href="/categories/toLearn/">toLearn</a></span><span class="level-item">12 minutes read (About 1797 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/Work/software/simulator/gem5/">Gem5</a></p><div class="content"><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li>GEM5是一款模块化的离散事件驱动全系统模拟器，由C++与python编写</li>
<li>它结合了M5（多处理器模拟器）和GEMS（存储层次模拟器）中最优秀的部分，是一款高度可配置、集成多种ISA和多种CPU模型的体系结构模拟器。<ul>
<li>M5是由Michigan大学开发的一款开源的多处理机模拟器，受到了业内的广泛关注，很多高水平论文都采用M5作为研究工具。</li>
<li>另一方面，Wisconsin推出的GEMS能够对储存层次进行详细而灵活的模拟，包括对多种不同的cache一致性协议和互联模型的支持。</li>
<li>目前的GEM5是M5和GEMS的一个紧耦合版本。</li>
</ul>
</li>
<li>GEM5已经能够支持多种商用ISA，包括X86、ARM、ALPHA、MIPS、Power、SPARC等，并且能够在X86、ARM、ALPHA上加载操作系统。</li>
</ul>
<h3 id="可选配置-灵活性"><a href="#可选配置-灵活性" class="headerlink" title="可选配置(灵活性)"></a>可选配置(灵活性)</h3><ul>
<li>灵活性是指gem5提供了多种CPU模型、系统模型以及存储器模型。<ul>
<li>CPU模型：Atomic、Timing、In-order、<strong>O3（Out of Order）</strong>。<ul>
<li><code>AtomicSimple</code>是最简单规模的模型，一个cycle完成一条指令的执行，memory 模型比较理想化，访存操作为原子性操作。适用于快速功能模拟。</li>
<li><code>TimingSimple</code>模拟器也是无流水线的模拟，但是使用了存储器访问时序模型，用以统计存储器访问延迟。</li>
<li><code>In-Order</code>模型是GEM5模拟的新特性，强调指令时序与仿真精度，流水级为默认五级流水：取值、译码、执行、访存、写回。并且模拟了cache部件、执行部件、分支预测部件等。</li>
<li><code>O3</code>模拟器是流水级模拟，O3模拟器模拟了乱序执行和超标量执行的指令间依赖，以及运行在多CPU上的并发执行的多线程。<ul>
<li>默认7级流水：取值、译码、重命名、发射、执行、写回、提交。</li>
<li>模拟了物理寄存器文件、IO、LSQ、ROB功能部件池等。</li>
<li>主要参数为流水管道间延迟、硬件线程数、IQ&#x2F;LSQ&#x2F;ROB项数、FU延迟、物理寄存器重命名、分支预测、访存依赖预测等。</li>
</ul>
</li>
</ul>
</li>
<li>系统模型：SE（System-call emulation）、FS（Full System）。</li>
<li>存储模型：Classic、Ruby。<ul>
<li>M5的Classic mode存储器是最简单的模型，它提供了简洁快速的可配置性。</li>
<li>GEMS的Ruby模型注重于精确度并且支持不同的cache一致性协议。<ul>
<li>Ruby存储模型支持庞大阵列的互联拓扑，包括两个不同的网络模型：Simple网络与Garnet网络。<ul>
<li>Simple网络对链路、路由延迟与链路带宽进行建模，但并不建模路由资源竞争与流控。</li>
<li>Garnet网络详细建模路由微架构，包括所有相关的资源竞争与流控时序。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="基本模式"><a href="#基本模式" class="headerlink" title="基本模式"></a>基本模式</h3><ul>
<li><strong>System Call Emulation (SE) Mode</strong><ul>
<li>In this mode, one only needs to specify the binary file to be simulated. This binary file can be statically&#x2F;dynamically linked.</li>
</ul>
</li>
<li><strong>full-system mode</strong><ul>
<li>This mode simulates a complete system which provides an operating system based simulation environment.</li>
<li><a target="_blank" rel="noopener" href="https://shaojiemike.notion.site/fs-py-b4574f51316e4ea2841eceec441a78a0">very slow</a>, rendering it impractical for deployment in real-world applications.</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time ./build/ARM/gem5.fast configs/example/se.py --cmd=/home/shaojiemike/test/llvmVSgem5/MV/MV_gem5 -n 32 --cpu-type=O3CPU --l1d_size=64kB --l1i_size=16kB --caches</span><br></pre></td></tr></table></figure>

<ul>
<li>L1d cache是每个核单独64KB（原因见后图）。但其实默认cache结构是L2共享的</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul>
<li>在源目录下运行<code>scons build/&lt;config&gt;/&lt;binary&gt;</code> 建立模拟器。<ul>
<li><code>&lt;config&gt;</code> gem5的配置文件，如<code>ARM</code>，<code>X86</code>等</li>
<li><code>&lt;binary&gt;</code> 模拟器的类型，有如下<ul>
<li><code>gem5.debug</code> 有关闭了优化，使gdb一类的工具更易于调试；</li>
<li><code>gem5.opt</code>有打开优化，但保留了调试输出和断言；</li>
<li><code>gem5.fast</code>去除了调试工具；</li>
<li><code>gem5.prof</code>用于与gprof共同使用</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scons build/ARM/gem5.fast --debug=presub --verbose -j 32</span><br></pre></td></tr></table></figure>

<h2 id="输入参数"><a href="#输入参数" class="headerlink" title="输入参数"></a>输入参数</h2><h3 id="gem5-安装的默认配置"><a href="#gem5-安装的默认配置" class="headerlink" title="gem5 安装的默认配置"></a>gem5 安装的默认配置</h3><p>可选选项在<code>./build/ARM/gem5.fast configs/example/se.py -h</code>或者 <code>configs/common/Options.py</code> 中查看</p>
<p>常规的配置：</p>
<ul>
<li>多级cache</li>
<li>CPU<ul>
<li>频率，核数</li>
<li>指令发射宽度<ul>
<li>commitWidth, decodeWidth, dispatchWidth, fetchWidth, issueWidth,</li>
<li>renameWidth, squashWidth, wbWidth     ,</li>
</ul>
</li>
<li>端口模型的部件类型以及个数</li>
</ul>
</li>
<li>内存</li>
</ul>
<h3 id="cache設置"><a href="#cache設置" class="headerlink" title="cache設置"></a>cache設置</h3><ul>
<li>只指定大小是沒用的，需要在L1cache 前加上 “–caches”，在l2cache前加上 “–l2cache“。命令結果類似</li>
<li>默认cache是没有开硬件预取HWP的，类型通过<code>--list-hwp-types</code>查看。可以指定L1L2cache的HWP类型，如<code>--l1d-hwp-type=TaggedPrefetcher</code>。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">build/X86/gem5.opt configs/example/se.py </span><br><span class="line">  --caches --l1d_size=32kB --l1i_size=32kB </span><br><span class="line">  --l2cache --l2_size=256kB </span><br><span class="line">  --l3_size=8192kB  <span class="comment"># l3 在 se里是不生效的</span></span><br><span class="line">  -c tests/test-progs/hello/bin/x86/linux/hello </span><br><span class="line"></span><br><span class="line"><span class="comment"># 建议将L3大小并入L2来模拟cycle的下限</span></span><br><span class="line">build/X86/gem5.opt configs/example/se.py </span><br><span class="line">  --caches --l1d_size=32kB --l1i_size=32kB </span><br><span class="line">  --l2cache --l2_size=256kB+8192kB</span><br><span class="line">  -c tests/test-progs/hello/bin/x86/linux/hello</span><br></pre></td></tr></table></figure>

<p>进阶配置：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/wyj7260/article/details/8515245">多核模拟时，配置独占cache</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/wyj7260/article/details/8499088">增加共享L3</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/wyj7260/article/details/8501338">添加共享的L3cache，并将L2cache改为独立的</a></li>
</ol>
<h2 id="输出文件"><a href="#输出文件" class="headerlink" title="输出文件"></a>输出文件</h2><p>运行完SE模式，默认会在指令路径下生成<code>m5out</code>文件夹，其中各文件大致含义如下：</p>
<ul>
<li><code>config.ini</code>或者<code>config.json</code> 运行指令的系统参数<ul>
<li>Contains a list of every SimObject created for the simulation and the values for its parameters.</li>
<li><code>json</code>格式的文件能比较好的理清config的重要设置</li>
<li><code>[system.cpu]</code> 有CPU的具体设置</li>
<li><code>[system.mem_ctrls.dram]</code> 有DRAM读取数据的具体设置</li>
<li><code>[system.membus]</code> BUS的相关设置</li>
</ul>
</li>
<li><code>stats.txt</code>  模拟结果数据(具体的周期数等)<ul>
<li>A text representation of all of the gem5 statistics registered for the simulation.</li>
<li><code>system.clk_domain.clock      1000  # Clock period in ticks (Tick)</code></li>
<li><code>system.cpu_clk_domain.clock  500   # Clock period in ticks (Tick)</code></li>
</ul>
</li>
<li><code>fs/proc/lscpu</code> 模拟系统配置(类似lscpu)</li>
<li><code>config.dot.*</code> 模拟的系统结构<ul>
<li><code>config.dot</code> 是以文字展示</li>
<li><code>config.dot.pdf</code> 和 <code>config.dot.svg</code> 都是以图片表示<img src="https://pic.shaojiemike.top/img/20230503164705.png" alt="aliyuncs1"></li>
<li><code>config.dot.svg</code> 能展示每个部件的细节参数 <img src="https://pic.shaojiemike.top/img/20230503171754.png" alt="aliyuncs2"></li>
</ul>
</li>
</ul>
<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/ivy_reny/article/details/54312352">博客</a>, 如果<code>se.py</code>無法滿足要求，可以自己<a target="_blank" rel="noopener" href="https://blog.csdn.net/ivy_reny/article/details/54312297">編寫脚本</a></p>
<h2 id="CPU参数解释"><a href="#CPU参数解释" class="headerlink" title="CPU参数解释"></a>CPU参数解释</h2><h3 id="各阶段发射宽度"><a href="#各阶段发射宽度" class="headerlink" title="各阶段发射宽度"></a>各阶段发射宽度</h3><p>commitWidth, decodeWidth, dispatchWidth, fetchWidth, issueWidth, renameWidth, squashWidth, wbWidth</p>
<p>下面是行数占比最大的几个部分</p>
<h3 id="branchPred"><a href="#branchPred" class="headerlink" title="branchPred"></a>branchPred</h3><ul>
<li>BTBEntries</li>
</ul>
<h3 id="decoder"><a href="#decoder" class="headerlink" title="decoder"></a>decoder</h3><h3 id="fuPool"><a href="#fuPool" class="headerlink" title="fuPool"></a>fuPool</h3><ul>
<li>fuction pool 类似乱序执行的端口模型，ARM下的O3模拟的fuPool如下<br><img src="https://pic.shaojiemike.top/img/20230503203337.png" alt="ARM-O3-fuPool"></li>
</ul>
<h2 id="gem5-模拟器误差来源分析"><a href="#gem5-模拟器误差来源分析" class="headerlink" title="gem5 模拟器误差来源分析"></a>gem5 模拟器误差来源分析</h2><h3 id="运行真实周期数"><a href="#运行真实周期数" class="headerlink" title="运行真实周期数"></a>运行真实周期数</h3><ul>
<li>使用<code>perf stat test.exe</code>, 可参考本博客perf文章</li>
</ul>
<h2 id="需要进一步的研究学习"><a href="#需要进一步的研究学习" class="headerlink" title="需要进一步的研究学习"></a>需要进一步的研究学习</h2><p>暂无</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>暂无</p>
<h2 id="开题缘由、总结、反思、吐槽"><a href="#开题缘由、总结、反思、吐槽" class="headerlink" title="开题缘由、总结、反思、吐槽~~"></a>开题缘由、总结、反思、吐槽~~</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ivy_reny/category_6666068.html">https://blog.csdn.net/ivy_reny/category_6666068.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wyj7260/category_1301132.html">https://blog.csdn.net/wyj7260/category_1301132.html</a></p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/categories/toLearn/page/3/">Previous</a></div><div class="pagination-next"><a href="/categories/toLearn/page/5/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/categories/toLearn/">1</a></li><li><a class="pagination-link" href="/categories/toLearn/page/2/">2</a></li><li><a class="pagination-link" href="/categories/toLearn/page/3/">3</a></li><li><a class="pagination-link is-current" href="/categories/toLearn/page/4/">4</a></li><li><a class="pagination-link" href="/categories/toLearn/page/5/">5</a></li><li><a class="pagination-link" href="/categories/toLearn/page/6/">6</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="Shaojie Tan"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Shaojie Tan</p><p class="is-size-6 is-block">𝘊𝘰𝘮𝘱𝘶𝘵𝘦𝘳 𝘈𝘳𝘤𝘩𝘪𝘵𝘦𝘤𝘵𝘶𝘳𝘦 &amp; 𝘏𝘗𝘊</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Anhui, Hefei, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">423</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">35</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">512</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Kirrito-k423" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Kirrito-k423"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithms/"><span class="level-start"><span class="level-item">Algorithms</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/Architecture/"><span class="level-start"><span class="level-item">Architecture</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile" href="/categories/Artificial-Intelligence/"><span class="level-start"><span class="level-item">Artificial Intelligence</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Camp/"><span class="level-start"><span class="level-item">Camp</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Databases/"><span class="level-start"><span class="level-item">Databases</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/HPC/"><span class="level-start"><span class="level-item">HPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math/"><span class="level-start"><span class="level-item">Math</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile" href="/categories/Operating-system/"><span class="level-start"><span class="level-item">Operating system</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Overview/"><span class="level-start"><span class="level-item">Overview</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/categories/ProjectRecord/"><span class="level-start"><span class="level-item">ProjectRecord</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Software/"><span class="level-start"><span class="level-item">Software</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Thinking/"><span class="level-start"><span class="level-item">Thinking</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Tips/"><span class="level-start"><span class="level-item">Tips</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Treasure/"><span class="level-start"><span class="level-item">Treasure</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tutorials/"><span class="level-start"><span class="level-item">Tutorials</span></span><span class="level-end"><span class="level-item tag">116</span></span></a></li><li><a class="level is-mobile" href="/categories/Values/"><span class="level-start"><span class="level-item">Values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/architecture/"><span class="level-start"><span class="level-item">architecture</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/diary/"><span class="level-start"><span class="level-item">diary</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/english/"><span class="level-start"><span class="level-item">english</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/hardware/"><span class="level-start"><span class="level-item">hardware</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/love/"><span class="level-start"><span class="level-item">love</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/math/"><span class="level-start"><span class="level-item">math</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/network/"><span class="level-start"><span class="level-item">network</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/operating-system/"><span class="level-start"><span class="level-item">operating system</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/programming/"><span class="level-start"><span class="level-item">programming</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/security/"><span class="level-start"><span class="level-item">security</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/software/"><span class="level-start"><span class="level-item">software</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/thinking/"><span class="level-start"><span class="level-item">thinking</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/thinking/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/tips/"><span class="level-start"><span class="level-item">tips</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/toLearn/"><span class="level-start"><span class="level-item">toLearn</span></span><span class="level-end"><span class="level-item tag">54</span></span></a></li><li><a class="level is-mobile" href="/categories/values/"><span class="level-start"><span class="level-item">values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://ibug.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ibugs</span></span><span class="level-right"><span class="level-item tag">ibug.io</span></span></a></li><li><a class="level is-mobile" href="https://jia.je/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">jiegec</span></span><span class="level-right"><span class="level-item tag">jia.je</span></span></a></li><li><a class="level is-mobile" href="https://leimao.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">leimao</span></span><span class="level-right"><span class="level-item tag">leimao.github.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-23T01:54:23.000Z">2024-09-23</time></p><p class="title"><a href="/2024/09/23/Work/Miscellaneous/ProjectRecord/24Q3-1-OptimizePTAWithThreadAffinity/">[DevLog]24Q3P1 - Optimize PTA With Thread Affinity</a></p><p class="categories"><a href="/categories/ProjectRecord/">ProjectRecord</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-22T09:19:48.000Z">2024-09-22</time></p><p class="title"><a href="/2024/09/22/Work/software/simulator/PC/VirtualBox/">VirtualBox</a></p><p class="categories"><a href="/categories/software/">software</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-13T07:08:55.000Z">2024-09-13</time></p><p class="title"><a href="/2024/09/13/Work/software/PC/macbook/">Macbook Config</a></p><p class="categories"><a href="/categories/software/">software</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-13T00:47:35.000Z">2024-09-13</time></p><p class="title"><a href="/2024/09/13/Work/Programming/2-languageGrammar/c/Types/">[C++ Basic] Types</a></p><p class="categories"><a href="/categories/toLearn/">toLearn</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-12T14:41:50.000Z">2024-09-12</time></p><p class="title"><a href="/2024/09/12/Work/Programming/2-languageGrammar/c/Class/">[C++ Basic] User-Defined Types: Class</a></p><p class="categories"><a href="/categories/Programming/">Programming</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">September 2024</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">July 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">June 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">May 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">April 2024</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">March 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">January 2024</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">December 2023</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">November 2023</span></span><span class="level-end"><span class="level-item tag">33</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">October 2023</span></span><span class="level-end"><span class="level-item tag">56</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">September 2023</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/08/"><span class="level-start"><span class="level-item">August 2023</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">July 2023</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">June 2023</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">April 2023</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">March 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">January 2023</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">December 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">September 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/5G/"><span class="tag">5G</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/64bits-vs-32bits/"><span class="tag">64bits vs 32bits</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMAT/"><span class="tag">AMAT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMD/"><span class="tag">AMD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ASPLOS/"><span class="tag">ASPLOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ATI/"><span class="tag">ATI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AVX/"><span class="tag">AVX</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Alpha/"><span class="tag">Alpha</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Analysis/"><span class="tag">Analysis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apt/"><span class="tag">Apt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Assembly/"><span class="tag">Assembly</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BFS/"><span class="tag">BFS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BHive/"><span class="tag">BHive</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BT/"><span class="tag">BT</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BTL/"><span class="tag">BTL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Baka-Mitai/"><span class="tag">Baka Mitai</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bash/"><span class="tag">Bash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Big-Endian/"><span class="tag">Big-Endian</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a><p class="is-size-7"><span>&copy; 2024 Shaojie Tan</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>