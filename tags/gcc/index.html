<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>Tag: gcc - SHAOJIE&#039;S BOOK</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="SHAOJIE&#039;S BOOK"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SHAOJIE&#039;S BOOK"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="SHAOJIE&#039;S BOOK"><meta property="og:url" content="http://icarus.shaojiemike.top/"><meta property="og:site_name" content="SHAOJIE&#039;S BOOK"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://icarus.shaojiemike.top/img/og_image.png"><meta property="article:author" content="Shaojie Tan"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://icarus.shaojiemike.top/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://icarus.shaojiemike.top"},"headline":"SHAOJIE'S BOOK","image":["http://icarus.shaojiemike.top/img/og_image.png"],"author":{"@type":"Person","name":"Shaojie Tan"},"publisher":{"@type":"Organization","name":"SHAOJIE'S BOOK","logo":{"@type":"ImageObject","url":"http://icarus.shaojiemike.top/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">gcc</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-08-22T03:19:25.000Z" title="8/22/2024, 3:19:25 AM">2024-08-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-08-23T07:40:35.249Z" title="8/23/2024, 7:40:35 AM">2024-08-23</time></span><span class="level-item"><a class="link-muted" href="/categories/programming/">programming</a></span><span class="level-item">10 minutes read (About 1425 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/08/22/Work/Programming/4-compile/CompileError/">GCC Compile Error</a></p><div class="content"><article class="message is-info">
        <div class="message-header"><p><i class="fa-solid fa-clipboard mr-2"></i>å¯¼è¨€</p>
</div>
        <div class="message-body">
            <p>é‡åˆ°è¿‡çš„c++ç¼–è¯‘error</p>

        </div>
    </article>

<article class="message is-danger">
        <div class="message-header"><p><i class="fa-solid fa-xmark mr-2"></i>Error</p>
</div>
        <div class="message-body">
            <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CMakeFiles/torch_npu.dir/torch_npu/csrc/utils/TensorType.cpp.o:(.bss+0x58): multiple definition of c10_npu::threadNameToType<span class="string">&#x27;</span></span><br><span class="line"><span class="string">CMakeFiles/torch_npu.dir/torch_npu/csrc/aten/NPUGeneratorImpl.cpp.o:(.bss+0xb0): first defined here</span></span><br><span class="line"><span class="string">CMakeFiles/torch_npu.dir/torch_npu/csrc/utils/TensorType.cpp.o:(.bss+0x28): multiple definition of c10_npu::threadNames&#x27;</span></span><br><span class="line">CMakeFiles/torch_npu.dir/torch_npu/csrc/aten/NPUGeneratorImpl.cpp.o:(.bss+0x80): first defined here</span><br></pre></td></tr></table></figure>

<p>è¿™ç§é”™è¯¯é€šå¸¸å‘ç”Ÿåœ¨å…¨å±€å˜é‡åœ¨å¤šä¸ªæºæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸æ­¢ä¸€æ¬¡ã€‚å³ä½¿ä½ ä½¿ç”¨äº† <code>extern</code> å…³é”®å­—ï¼Œåœ¨å¤šä¸ªæºæ–‡ä»¶ä¸­å®šä¹‰å…¨å±€å˜é‡æ—¶ä»ç„¶ä¼šäº§ç”Ÿâ€œmultiple definitionâ€é”™è¯¯ã€‚<code>extern</code> å£°æ˜åªæ˜¯å‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå˜é‡åœ¨åˆ«çš„åœ°æ–¹å®šä¹‰ï¼Œè€Œä¸æ˜¯åœ¨å½“å‰æ–‡ä»¶ä¸­å®šä¹‰ã€‚</p>
<p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ éœ€è¦ç¡®ä¿å…¨å±€å˜é‡çš„å®šä¹‰ä»…å­˜åœ¨äºä¸€ä¸ªæºæ–‡ä»¶ä¸­ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„æ­¥éª¤ï¼š</p>
<ol>
<li>åœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜å…¨å±€å˜é‡</li>
</ol>
<p>åœ¨å¤´æ–‡ä»¶ä¸­ä½¿ç”¨ <code>extern</code> å£°æ˜å…¨å±€å˜é‡ï¼Œè€Œä¸å®šä¹‰å®ƒä»¬ã€‚ç¡®ä¿åœ¨æ‰€æœ‰éœ€è¦å¼•ç”¨è¿™äº›å˜é‡çš„æºæ–‡ä»¶ä¸­éƒ½åŒ…å«è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œä½†ä¸è¦åœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰å®ƒä»¬ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ThreadUtils.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> c10_npu &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">ThreadType</span> &#123;</span><br><span class="line">    Release_thread = <span class="number">1</span>,</span><br><span class="line">    ACL_thread = <span class="number">2</span>,</span><br><span class="line">    Forward_thread = <span class="number">3</span>,</span><br><span class="line">    Backward_thread = <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ extern å£°æ˜å…¨å±€å˜é‡</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">const</span> std::map&lt;ThreadType, std::string&gt; threadNames;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">const</span> std::map&lt;std::string, ThreadType&gt; threadNameToType;</span><br><span class="line"></span><br><span class="line">&#125;  <span class="comment">// namespace c10_npu</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨æºæ–‡ä»¶ä¸­å®šä¹‰å…¨å±€å˜é‡</li>
</ol>
<p>åœ¨ä¸€ä¸ªæºæ–‡ä»¶ä¸­å®šä¹‰è¿™äº›å…¨å±€å˜é‡ã€‚ç¡®ä¿è¿™ä¸ªæºæ–‡ä»¶ä¸­åªåŒ…å«å˜é‡çš„å®šä¹‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ThreadUtils.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ThreadUtils.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> c10_npu &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ä¸€ä¸ªæºæ–‡ä»¶ä¸­å®šä¹‰å…¨å±€å˜é‡</span></span><br><span class="line"><span class="type">const</span> std::map&lt;ThreadType, std::string&gt; threadNames = &#123;</span><br><span class="line">    &#123;Release_thread, <span class="string">&quot;Release_thread&quot;</span>&#125;,</span><br><span class="line">    &#123;ACL_thread, <span class="string">&quot;ACL_thread&quot;</span>&#125;,</span><br><span class="line">    &#123;Forward_thread, <span class="string">&quot;Other_thread&quot;</span>&#125;,</span><br><span class="line">    &#123;Backward_thread, <span class="string">&quot;Other_thread&quot;</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> std::map&lt;std::string, ThreadType&gt; threadNameToType = &#123;</span><br><span class="line">    &#123;<span class="string">&quot;Release_thread&quot;</span>, Release_thread&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;ACL_thread&quot;</span>, ACL_thread&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;Other_thread&quot;</span>, Forward_thread&#125;  <span class="comment">// Forward_thread å’Œ Backward_thread æ˜ å°„ä¸º &quot;Other_thread&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;  <span class="comment">// namespace c10_npu</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>ç¡®ä¿æ¯ä¸ªæºæ–‡ä»¶åªå¼•ç”¨å¤´æ–‡ä»¶ï¼Œä¸é‡å¤å®šä¹‰å˜é‡</li>
</ol>
<p>ç¡®ä¿åœ¨å…¶ä»–æºæ–‡ä»¶ä¸­ï¼ˆå¦‚ <code>NPUGeneratorImpl.cpp</code> å’Œ <code>TensorType.cpp</code>ï¼‰åªåŒ…å«å¤´æ–‡ä»¶ <code>ThreadUtils.h</code>ï¼Œè€Œä¸æ˜¯åœ¨è¿™äº›æºæ–‡ä»¶ä¸­å®šä¹‰å…¨å±€å˜é‡ã€‚è¿™å¯ä»¥é¿å…åœ¨å¤šä¸ªç¼–è¯‘å•å…ƒä¸­é‡å¤å®šä¹‰ç›¸åŒçš„å…¨å±€å˜é‡ã€‚</p>
<ol start="4">
<li>æ£€æŸ¥å’Œæ¸…ç†é¡¹ç›®</li>
</ol>
<p>å¦‚æœä½ ä»ç„¶é‡åˆ°é—®é¢˜ï¼Œæ£€æŸ¥é¡¹ç›®ä¸­æ˜¯å¦æœ‰é‡å¤çš„å®šä¹‰ï¼Œå¯èƒ½æ˜¯æŸäº›æºæ–‡ä»¶ä¸­æ— æ„é—´é‡å¤äº†å…¨å±€å˜é‡çš„å®šä¹‰ã€‚ç¡®ä¿æ¸…ç†æ—§çš„ç¼–è¯‘æ–‡ä»¶ï¼ˆå¦‚ä½¿ç”¨ <code>make clean</code> æˆ– <code>rm -rf build</code>ï¼‰ï¼Œç„¶åé‡æ–°ç¼–è¯‘é¡¹ç›®ï¼Œä»¥ç¡®ä¿æ²¡æœ‰æ®‹ç•™çš„æ—§æ–‡ä»¶å¯¼è‡´å†²çªã€‚</p>
<p>æ€»ç»“</p>
<ul>
<li>ä½¿ç”¨ <code>extern</code> åœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜å…¨å±€å˜é‡ã€‚</li>
<li>åœ¨ä¸€ä¸ªæºæ–‡ä»¶ä¸­å®šä¹‰è¿™äº›å…¨å±€å˜é‡ã€‚</li>
<li>ç¡®ä¿å…¶ä»–æºæ–‡ä»¶åªåŒ…å«å¤´æ–‡ä»¶è€Œä¸é‡å¤å®šä¹‰å…¨å±€å˜é‡ã€‚</li>
<li>æ¸…ç†é¡¹ç›®å¹¶é‡æ–°ç¼–è¯‘ã€‚</li>
</ul>
<p>è¿™äº›æ­¥éª¤å°†å¸®åŠ©ä½ è§£å†³â€œmultiple definitionâ€é”™è¯¯ã€‚</p>

        </div>
    </article>

<article class="message is-danger">
        <div class="message-header"><p><i class="fa-solid fa-xmark mr-2"></i>error</p>
</div>
        <div class="message-body">
            <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/root/document/shaojie/github/v2.1.0-6.0.rc2/torch_npu/csrc/core/npu/NPUQueue.cpp:517:63: error: passing â€˜const std::map&lt;c10_npu::ThreadType, std::basic_string&lt;char&gt; &gt;â€™ as â€˜thisâ€™ argument discards qualifiers [-fper</span><br><span class="line">missive]</span><br><span class="line">    <span class="keyword">if</span> (prctl(PR_SET_NAME, (threadNames[ThreadType::ACL_thread])) != 0) &#123;</span><br><span class="line">                                                              ^</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé”™è¯¯æ˜¯ç”±äºä½ å°è¯•å°†ä¸€ä¸ª<code>const</code>ä¿®é¥°çš„<code>std::map</code>å¯¹è±¡çš„å…ƒç´ ä¼ é€’ç»™éœ€è¦ä¿®æ”¹è¯¥å¯¹è±¡çš„æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œ<code>std::map::operator[]</code>è¿”å›çš„å¼•ç”¨æ˜¯å¯ä¿®æ”¹çš„ï¼Œä½†æ˜¯ä½ è¯•å›¾åœ¨<code>const std::map</code>å¯¹è±¡ä¸Šè°ƒç”¨å®ƒï¼Œè¿™å¯¼è‡´äº†é”™è¯¯ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆ<br>å¦‚æœä½ ä¸éœ€è¦ä¿®æ”¹<code>threadNames</code>è¿™ä¸ª<code>std::map</code>ï¼Œè€Œåªæ˜¯éœ€è¦è®¿é—®å…¶å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨<code>std::map::at()</code>æ–¹æ³•ä»£æ›¿<code>operator[]</code>ã€‚<code>at()</code>æ–¹æ³•æ˜¯ä¸€ä¸ª<code>const</code>æ–¹æ³•ï¼Œå¯ä»¥åœ¨<code>const std::map</code>ä¸Šå®‰å…¨åœ°è°ƒç”¨ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¿®æ­£åçš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ThreadUtils.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> c10_npu &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> std::map&lt;ThreadType, std::string&gt; threadNames = &#123;</span><br><span class="line">    &#123;Release_thread, <span class="string">&quot;Release_thread&quot;</span>&#125;,</span><br><span class="line">    &#123;ACL_thread, <span class="string">&quot;ACL_thread&quot;</span>&#125;,</span><br><span class="line">    &#123;Forward_thread, <span class="string">&quot;Other_thread&quot;</span>&#125;,</span><br><span class="line">    &#123;Backward_thread, <span class="string">&quot;Other_thread&quot;</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> std::map&lt;std::string, ThreadType&gt; threadNameToType = &#123;</span><br><span class="line">    &#123;<span class="string">&quot;Release_thread&quot;</span>, Release_thread&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;ACL_thread&quot;</span>, ACL_thread&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;Other_thread&quot;</span>, Forward_thread&#125;  <span class="comment">// Forward_thread å’Œ Backward_thread æ˜ å°„ä¸º &quot;Other_thread&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ä»£ç ä¸­ï¼Œä½¿ç”¨at()æ–¹æ³•è®¿é—®mapçš„å€¼</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setThreadName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">prctl</span>(PR_SET_NAME, threadNames.<span class="built_in">at</span>(ThreadType::ACL_thread).<span class="built_in">c_str</span>()) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// é”™è¯¯å¤„ç†ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;  <span class="comment">// namespace c10_npu</span></span><br></pre></td></tr></table></figure>

<p>å…³é”®ç‚¹</p>
<ol>
<li><p><strong><code>at()</code>æ–¹æ³•</strong>ï¼š<code>std::map::at()</code>æ–¹æ³•ä¸<code>operator[]</code>ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯<code>const</code>å®‰å…¨çš„ï¼Œå¯ä»¥åœ¨<code>const std::map</code>å¯¹è±¡ä¸Šä½¿ç”¨ã€‚å®ƒè¿˜ä¼šåœ¨é”®ä¸å­˜åœ¨æ—¶æŠ›å‡º<code>std::out_of_range</code>å¼‚å¸¸ï¼Œè€Œä¸æ˜¯æ’å…¥æ–°å…ƒç´ ã€‚</p>
</li>
<li><p><strong>é¿å…ä¿®æ”¹æ“ä½œ</strong>ï¼šä½¿ç”¨<code>const</code>ä¿®é¥°<code>std::map</code>çš„å¯¹è±¡è¡¨ç¤ºä½ ä¸å¸Œæœ›å®ƒçš„å†…å®¹è¢«ä¿®æ”¹ï¼Œå› æ­¤åº”é¿å…ä½¿ç”¨ä¼šæ”¹å˜å…¶å†…å®¹çš„æ“ä½œï¼Œå¦‚<code>operator[]</code>ã€‚</p>
</li>
</ol>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥åœ¨ä¸æ”¹å˜<code>threadNames</code>çš„æƒ…å†µä¸‹è®¿é—®å…¶ä¸­çš„å…ƒç´ ï¼Œå¹¶è§£å†³<code>const</code>ä¿®é¥°ç¬¦å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯ã€‚</p>

        </div>
    </article>

<!-- ## ğŸ—æ–½å·¥ä¸­ğŸ—

ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§

è§‰å¾—æœ‰æ„ä¹‰å†™ï¼Œå…ˆå ä¸ªä½å­ã€‚è¿˜æ²¡å†™å¥½å‘¢ï¼Œå»ºè®®ä¸è¦çœ‹ï¼ˆé€»è¾‘å†…å®¹éƒ½æ²¡æƒ³æ¸…æ¥šï¼‰ï¼Œä¸è¦æ€¥~~

ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ğŸš§ -->


<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><!-- footnote is for url which the writer do not want reader to click to interupt the reading. -->

<!-- ä¸Šé¢å›ç­”éƒ¨åˆ†**æ¥è‡ªChatGPT-3.5**ï¼Œæ²¡æœ‰è¿›è¡Œæ­£ç¡®æ€§çš„äº¤å‰æ ¡éªŒã€‚-->

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-12T16:00:00.000Z" title="10/12/2023, 4:00:00 PM">2023-10-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-08-23T07:40:35.261Z" title="8/23/2024, 7:40:35 AM">2024-08-23</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">12 minutes read (About 1771 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/12/Work/Programming/3-options/gccCompilerOption/">GCC Compiler Option 1 : Optimization Options</a></p><div class="content"><h2 id="æ‰‹å†Œ"><a href="#æ‰‹å†Œ" class="headerlink" title="æ‰‹å†Œ"></a>æ‰‹å†Œ</h2><p><a target="_blank" rel="noopener" href="https://gcc.gnu.org/onlinedocs/gcc/Option-Summary.html">å…¨ä½“é€‰é¡¹</a>å…¶ä¸­ä¸€éƒ¨åˆ†æ˜¯<a target="_blank" rel="noopener" href="https://gcc.gnu.org/onlinedocs/gcc-4.5.2/gcc/Optimize-Options.html">Optimize-Options</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¼šåˆ—å‡ºå¯é€‰é¡¹</span></span><br><span class="line">g++ -march=native -m32 ... -Q --<span class="built_in">help</span>=target </span><br><span class="line"><span class="comment"># ä¼šåˆ—å‡ºO3é»˜è®¤å¼€å¯å’Œå…³é—­é€‰é¡¹</span></span><br><span class="line">g++ -O3 -Q --<span class="built_in">help</span>=optimizers</span><br></pre></td></tr></table></figure>

<p>ç¼–è¯‘æ—¶æœ€å¥½æŒ‰ç…§å…¶åˆ†ç±»æœ‰æ•ˆç»„ç»‡, ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">g++ </span><br><span class="line"><span class="comment"># Warning Options</span></span><br><span class="line">-Wall -Werror -Wno-unknown-pragmas -Wno-dangling-pointer </span><br><span class="line"><span class="comment"># Program Instrumentation Options</span></span><br><span class="line">-fno-stack-protector</span><br><span class="line"><span class="comment"># Code-Gen-Options</span></span><br><span class="line">-fno-exceptions -funwind-tables -fasynchronous-unwind-tables</span><br><span class="line"><span class="comment"># C++ Dialect</span></span><br><span class="line">-fabi-version=2 -faligned-new -fno-rtti</span><br><span class="line"><span class="comment"># define</span></span><br><span class="line">-DPIN_CRT=1 -DTARGET_IA32E -DHOST_IA32E -fPIC -DTARGET_LINUX </span><br><span class="line"><span class="comment"># include</span></span><br><span class="line">-I../../../source/include/pin </span><br><span class="line">-I../../../source/include/pin/gen </span><br><span class="line">-isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/cxx/include </span><br><span class="line">-isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/crt/include </span><br><span class="line">-isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/crt/include/arch-x86_64 </span><br><span class="line">-isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/crt/include/kernel/uapi </span><br><span class="line">-isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/crt/include/kernel/uapi/asm-x86 </span><br><span class="line">-I../../../extras/components/include </span><br><span class="line">-I../../../extras/xed-intel64/include/xed </span><br><span class="line">-I../../../source/tools/Utils </span><br><span class="line">-I../../../source/tools/InstLib </span><br><span class="line"><span class="comment"># Optimization Options</span></span><br><span class="line">-O3 -fomit-frame-pointer -fno-strict-aliasing </span><br><span class="line">-c -o obj-intel64/inscount0.o inscount0.cpp</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸è§é€‰é¡¹"><a href="#å¸¸è§é€‰é¡¹" class="headerlink" title="å¸¸è§é€‰é¡¹"></a>å¸¸è§é€‰é¡¹</h2><ul>
<li><code>-Wxxx</code> å¯¹ xxx å¯åŠ¨warningï¼Œ </li>
<li><code>-fxxx</code> å¯åŠ¨xxxçš„ç¼–è¯‘å™¨åŠŸèƒ½ã€‚<code>-fno-xxx</code> å…³é—­å¯¹åº”é€‰é¡¹ï¼Ÿï¼Ÿï¼Ÿ</li>
<li><code>-gxxx</code> debug ç›¸å…³</li>
<li><code>-mxxx</code> ç‰¹å®šæœºå™¨æ¶æ„çš„é€‰é¡¹</li>
</ul>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>-Wall</td>
<td>æ‰“å¼€å¸¸è§çš„æ‰€æœ‰warningé€‰é¡¹</td>
</tr>
<tr>
<td>-Werror</td>
<td>æŠŠwarningå½“æˆerror</td>
</tr>
<tr>
<td>-std&#x3D;</td>
<td>C or C++ language standard. eg â€˜c++11â€™ &#x3D;&#x3D; â€˜c++0xâ€™ â€˜c++17â€™ &#x3D;&#x3D; â€˜c++1zâ€™, which â€˜c++0xâ€™,â€™c++17â€™ is develop codename</td>
</tr>
<tr>
<td>-Wunknown-pragmas</td>
<td>æœªçŸ¥çš„pragmaä¼šæŠ¥é”™ï¼ˆ-Wno-unknown-pragmas åº”è¯¥æ˜¯ç›¸åçš„ï¼‰</td>
</tr>
<tr>
<td>-fomit-frame-pointer</td>
<td>ä¸ç”Ÿæˆæ ˆå¸§æŒ‡é’ˆ,å±äº-O1ä¼˜åŒ–</td>
</tr>
<tr>
<td>-Wstack-protector</td>
<td>æ²¡æœ‰é˜²æ­¢å †æ ˆå´©æºƒçš„å‡½æ•°æ—¶warning (-fno-stack-protector)</td>
</tr>
<tr>
<td>-MMD</td>
<td>only user header files, not system header files.</td>
</tr>
<tr>
<td>-fexceptions</td>
<td>Enable exception handling.</td>
</tr>
<tr>
<td>-funwind-tables</td>
<td>Unwind tables contain debug frame information which is also necessary for the handling of such exceptions</td>
</tr>
<tr>
<td>-fasynchronous-unwind-tables</td>
<td>Generate unwind table in DWARF format. so it can be used for stack unwinding from asynchronous events</td>
</tr>
<tr>
<td>-fabi-version&#x3D;n</td>
<td>Use version n of the C++ ABI. The default is version 0.(Version 2 is the version of the C++ ABI that first appeared in G++ 3.4, and was the default through G++ 4.9.) ABI: an application binary interface (ABI) is an interface between two binary program modules. Often, one of these modules is a library or operating system facility, and the other is a program that is being run by a user.</td>
</tr>
<tr>
<td>-fno-rtti</td>
<td>Disable generation of information about every class with virtual functions for use by the C++ run-time type identification features (dynamic_cast and typeid). If you donâ€™t use those parts of the language, you can <strong>save some space</strong> by using this flag</td>
</tr>
<tr>
<td>-faligned-new</td>
<td>Enable support for C++17 new of types that require more alignment than <code>void* ::operator new(std::size_t)</code> provides. A numeric argument such as <code>-faligned-new=32</code> can be used to specify how much alignment (in bytes) is provided by that function, but few users will need to override the default of <code>alignof(std::max_align_t)</code>. This flag is enabled by default for <code>-std=c++17</code>.</td>
</tr>
<tr>
<td>-Wl, xxx</td>
<td>pass xxx option to linker, e.g., <code>-Wl,-R/staff/shaojiemike/github/MultiPIM_icarus0/common/libconfig/lib</code> specify a runtime library search path for dynamic libraries (shared libraries) during the linking process.</td>
</tr>
</tbody></table>
<h2 id="General-Optimization-Options"><a href="#General-Optimization-Options" class="headerlink" title="General Optimization Options"></a>General Optimization Options</h2><h3 id="O-O2-O3"><a href="#O-O2-O3" class="headerlink" title="-O, -O2, -O3"></a>-O, -O2, -O3</h3><p>-O3 turns on all optimizations specified by -O2</p>
<p>and also turns on the -finline-functions, -funswitch-loops, -fpredictive-commoning, -fgcse-after-reload, -ftree-loop-vectorize, -ftree-loop-distribute-patterns, -ftree-slp-vectorize, -fvect-cost-model, -ftree-partial-pre and -fipa-cp-clone options</p>
<h3 id="ffastmath"><a href="#ffastmath" class="headerlink" title="-ffastmath"></a>-ffastmath</h3><p>å…è®¸ä½¿ç”¨æµ®ç‚¹è®¡ç®—è·å¾—æ›´é«˜çš„æ€§èƒ½ï¼Œä½†å¯èƒ½ä¼šç•¥å¾®é™ä½ç²¾åº¦ã€‚</p>
<h3 id="Ofast"><a href="#Ofast" class="headerlink" title="-Ofast"></a>-Ofast</h3><p>æ›´å¿«ä½†æ˜¯æœ‰ä¿è¯æ­£ç¡®</p>
<h3 id="flto"><a href="#flto" class="headerlink" title="-flto"></a>-flto</h3><p>ï¼ˆä»…é™ GNUï¼‰é“¾æ¥æ—¶ä¼˜åŒ–ï¼Œå½“ç¨‹åºé“¾æ¥æ—¶æ£€æŸ¥æ–‡ä»¶ä¹‹é—´çš„å‡½æ•°è°ƒç”¨çš„æ­¥éª¤ã€‚è¯¥æ ‡å¿—å¿…é¡»ç”¨äºç¼–è¯‘å’Œé“¾æ¥æ—¶ã€‚ä½¿ç”¨æ­¤æ ‡å¿—çš„ç¼–è¯‘æ—¶é—´å¾ˆé•¿ï¼Œä½†æ˜¯æ ¹æ®åº”ç”¨ç¨‹åºï¼Œå½“ä¸ -O* æ ‡å¿—ç»“åˆä½¿ç”¨æ—¶ï¼Œå¯èƒ½ä¼šæœ‰æ˜æ˜¾çš„æ€§èƒ½æ”¹è¿›ã€‚è¿™ä¸ªæ ‡å¿—å’Œä»»ä½•ä¼˜åŒ–æ ‡å¿—éƒ½å¿…é¡»ä¼ é€’ç»™é“¾æ¥å™¨ï¼Œå¹¶ä¸”åº”è¯¥è°ƒç”¨ gcc&#x2F;g++&#x2F;gfortran è¿›è¡Œé“¾æ¥è€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ ldã€‚</p>
<h3 id="mtune-processor"><a href="#mtune-processor" class="headerlink" title="-mtune&#x3D;processor"></a>-mtune&#x3D;processor</h3><p>æ­¤æ ‡å¿—å¯¹ç‰¹å®šå¤„ç†å™¨ç±»å‹è¿›è¡Œé¢å¤–è°ƒæ•´ï¼Œä½†å®ƒä¸ä¼šç”Ÿæˆé¢å¤–çš„ SIMD æŒ‡ä»¤ï¼Œå› æ­¤ä¸å­˜åœ¨ä½“ç³»ç»“æ„å…¼å®¹æ€§é—®é¢˜ã€‚è°ƒæ•´å°†æ¶‰åŠå¯¹å¤„ç†å™¨ç¼“å­˜å¤§å°ã€é¦–é€‰æŒ‡ä»¤é¡ºåºç­‰çš„ä¼˜åŒ–ã€‚</p>
<p>åœ¨ AMD Bulldozer èŠ‚ç‚¹ä¸Šä½¿ç”¨çš„å€¼ä¸º bdver1ï¼Œåœ¨ AMD Epyc èŠ‚ç‚¹ä¸Šä½¿ç”¨çš„å€¼ä¸º znver2ã€‚æ˜¯zen ver2çš„ç®€ç§°ã€‚</p>
<h2 id="Optimization-Options-æ•°æ®é¢„å–ç›¸å…³"><a href="#Optimization-Options-æ•°æ®é¢„å–ç›¸å…³" class="headerlink" title="Optimization Options: æ•°æ®é¢„å–ç›¸å…³"></a>Optimization Options: æ•°æ®é¢„å–ç›¸å…³</h2><ol>
<li><code>-fprefetch-loop-arrays</code><ol>
<li>å¦‚æœç›®æ ‡æœºå™¨æ”¯æŒï¼Œç”Ÿæˆé¢„å–å†…å­˜çš„æŒ‡ä»¤ï¼Œä»¥æé«˜è®¿é—®å¤§æ•°ç»„çš„å¾ªç¯çš„æ€§èƒ½ã€‚è¿™ä¸ªé€‰é¡¹å¯èƒ½äº§ç”Ÿæ›´å¥½æˆ–æ›´å·®çš„ä»£ç ï¼›ç»“æœåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæºä»£ç ä¸­çš„å¾ªç¯ç»“æ„ã€‚</li>
<li><code>-Os</code>ç¦ç”¨</li>
</ol>
</li>
</ol>
<h2 id="Optimization-Options-è®¿å­˜ä¼˜åŒ–ç›¸å…³"><a href="#Optimization-Options-è®¿å­˜ä¼˜åŒ–ç›¸å…³" class="headerlink" title="Optimization Options: è®¿å­˜ä¼˜åŒ–ç›¸å…³"></a>Optimization Options: è®¿å­˜ä¼˜åŒ–ç›¸å…³</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/496435946">https://zhuanlan.zhihu.com/p/496435946</a></p>
<p>ä¸‹é¢æ²¡æœ‰ç‰¹åˆ«æŒ‡æ˜éƒ½æ˜¯O3ï¼Œé»˜è®¤å¼€å¯</p>
<h3 id="è°ƒæ•´æ•°æ®çš„è®¿é—®é¡ºåº"><a href="#è°ƒæ•´æ•°æ®çš„è®¿é—®é¡ºåº" class="headerlink" title="è°ƒæ•´æ•°æ®çš„è®¿é—®é¡ºåº"></a>è°ƒæ•´æ•°æ®çš„è®¿é—®é¡ºåº</h3><ol>
<li><code>-ftree-loop-distribution</code><ol>
<li>å…è®¸å°†ä¸€ä¸ªå¤æ‚çš„å¤§å¾ªç¯ï¼Œæ‹†å¼€æˆå¤šä¸ªå¾ªç¯ï¼Œå„è‡ªå¯ä»¥ç»§ç»­å¹¶è¡Œå’Œå‘é‡åŒ–</li>
</ol>
</li>
<li><code>-ftree-loop-distribute-patterns</code><ol>
<li>ç±»ä¼¼ä¸Šé¢ä¸€ç§ï¼Ÿ</li>
</ol>
</li>
<li><code>-floop-interchange</code><ol>
<li>å…è®¸äº¤æ¢å¤šå±‚å¾ªç¯æ¬¡åºæ¥è¿ç»­è®¿å­˜</li>
</ol>
</li>
<li><code>-floop-unroll-and-jam</code><ol>
<li>å…è®¸å¤šå±‚å¾ªç¯ï¼Œå°†å¤–å¾ªç¯æŒ‰æŸç§ç³»æ•°å±•å¼€ï¼Œå¹¶å°†äº§ç”Ÿçš„å¤šä¸ªå†…å¾ªç¯èåˆã€‚</li>
</ol>
</li>
</ol>
<h3 id="ä»£ç æ®µå¯¹é½"><a href="#ä»£ç æ®µå¯¹é½" class="headerlink" title="ä»£ç æ®µå¯¹é½"></a>ä»£ç æ®µå¯¹é½</h3><p>(ä¸æ˜¯è®¡ç®—è®¿é—®çš„æ•°æ®)</p>
<ol>
<li><code>-falign-functions=n:m:n2:m2</code><ol>
<li>Enabled at levels -O2, -O3.<br>ç±»ä¼¼æœ‰ä¸€å †</li>
</ol>
</li>
</ol>
<h3 id="è°ƒæ•´ä»£ç å—çš„å¸ƒå±€"><a href="#è°ƒæ•´ä»£ç å—çš„å¸ƒå±€" class="headerlink" title="è°ƒæ•´ä»£ç å—çš„å¸ƒå±€"></a>è°ƒæ•´ä»£ç å—çš„å¸ƒå±€</h3><ol>
<li><code>-freorder-blocks</code><ol>
<li>å‡½æ•°åŸºæœ¬å—é‡æ’æ¥ï¼Œå‡å°‘åˆ†æ”¯</li>
</ol>
</li>
</ol>
<h2 id="Optimization-Options-Unroll-Flags"><a href="#Optimization-Options-Unroll-Flags" class="headerlink" title="Optimization Options: Unroll Flags"></a>Optimization Options: Unroll Flags</h2><h3 id="funroll-loops"><a href="#funroll-loops" class="headerlink" title="-funroll-loops"></a>-funroll-loops</h3><p>Unroll loops whose <strong>number of iterations</strong> can be determined <strong>at compile time or upon entry to the loop</strong>. <code>-funroll-loops</code> implies <code>-frerun-cse-after-loop</code>. This option makes code larger, and may or may not make it run faster.</p>
<h3 id="funroll-all-loops"><a href="#funroll-all-loops" class="headerlink" title="-funroll-all-loops"></a>-funroll-all-loops</h3><p>Unroll all loops, even if their number of iterations is <strong>uncertain</strong> when the loop is entered. This usually makes programs <strong>run more slowly.</strong> <code>-funroll-all-loops</code> implies the same options as <code>-funroll-loops</code>,</p>
<h3 id="max-unrolled-insns"><a href="#max-unrolled-insns" class="headerlink" title="max-unrolled-insns"></a>max-unrolled-insns</h3><p>The maximum number of instructions that a loop should have if that loop is unrolled, and if the loop is unrolled, it determines how many times the loop code is unrolled.<br>å¦‚æœå¾ªç¯è¢«å±•å¼€ï¼Œåˆ™å¾ªç¯åº”å…·æœ‰çš„æœ€å¤§æŒ‡ä»¤æ•°ï¼Œå¦‚æœå¾ªç¯è¢«å±•å¼€ï¼Œåˆ™å®ƒç¡®å®šå¾ªç¯ä»£ç è¢«å±•å¼€çš„æ¬¡æ•°ã€‚</p>
<h3 id="max-average-unrolled-insns"><a href="#max-average-unrolled-insns" class="headerlink" title="max-average-unrolled-insns"></a>max-average-unrolled-insns</h3><p>The maximum number of instructions biased by probabilities of their execution that a loop should have if that loop is unrolled, and if the loop is unrolled, it determines how many times the loop code is unrolled.<br>å¦‚æœä¸€ä¸ªå¾ªç¯è¢«å±•å¼€ï¼Œåˆ™æ ¹æ®å…¶æ‰§è¡Œæ¦‚ç‡åç½®çš„æœ€å¤§æŒ‡ä»¤æ•°ï¼Œå¦‚æœè¯¥å¾ªç¯è¢«å±•å¼€ï¼Œåˆ™ç¡®å®šå¾ªç¯ä»£ç è¢«å±•å¼€çš„æ¬¡æ•°ã€‚</p>
<h3 id="max-unroll-times"><a href="#max-unroll-times" class="headerlink" title="max-unroll-times"></a>max-unroll-times</h3><p>The maximum number of unrollings of a single loop.<br>å•ä¸ªå¾ªç¯çš„æœ€å¤§å±•å¼€æ¬¡æ•°ã€‚</p>
<h2 id="Optimization-Options-SIMD-Instructions"><a href="#Optimization-Options-SIMD-Instructions" class="headerlink" title="Optimization Options: SIMD Instructions"></a>Optimization Options: SIMD Instructions</h2><h3 id="march-native"><a href="#march-native" class="headerlink" title="-march&#x3D;native"></a>-march&#x3D;native</h3><p>ä¼šè‡ªåŠ¨æ£€æµ‹ï¼Œä½†æœ‰å¯èƒ½æ£€æµ‹ä¸å¯¹ã€‚</p>
<h3 id="march-â€archâ€"><a href="#march-â€archâ€" class="headerlink" title="-march&#x3D;â€archâ€"></a>-march&#x3D;â€archâ€</h3><p>è¿™å°†ä¸ºç‰¹å®šæ¶æ„ç”Ÿæˆ SIMD æŒ‡ä»¤å¹¶åº”ç”¨ -mtune ä¼˜åŒ–ã€‚ arch çš„æœ‰ç”¨å€¼ä¸ä¸Šé¢çš„ -mtune æ ‡å¿—ç›¸åŒã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">g++ -march=native -m32 ... -Q --<span class="built_in">help</span>=target</span><br><span class="line"></span><br><span class="line">-mtune=                               skylake-avx512 </span><br><span class="line"></span><br><span class="line"> Known valid arguments <span class="keyword">for</span> -march= option:</span><br><span class="line">    i386 i486 i586 pentium lakemont pentium-mmx winchip-c6 winchip2 c3 samuel-2 c3-2 nehemiah c7 esther i686 pentiumpro pentium2 pentium3 pentium3m pentium-m pentium4 pentium4m prescott nocona core2 nehalem corei7 westmere sandybridge corei7-avx ivybridge core-avx-i haswell core-avx2 broadwell skylake skylake-avx512 cannonlake icelake-client icelake-server cascadelake tigerlake bonnell atom silvermont slm goldmont goldmont-plus tremont knl knm intel geode k6 k6-2 k6-3 athlon athlon-tbird athlon-4 athlon-xp athlon-mp x86-64 eden-x2 nano nano-1000 nano-2000 nano-3000 nano-x2 eden-x4 nano-x4 k8 k8-sse3 opteron opteron-sse3 athlon64 athlon64-sse3 athlon-fx amdfam10 barcelona bdver1 bdver2 bdver3 bdver4 znver1 znver2 btver1 btver2 generic native</span><br></pre></td></tr></table></figure>

<h3 id="msse4-2-mavx-mavx2-march-core-avx2"><a href="#msse4-2-mavx-mavx2-march-core-avx2" class="headerlink" title="-msse4.2 -mavx -mavx2 -march&#x3D;core-avx2"></a>-msse4.2 -mavx -mavx2 -march&#x3D;core-avx2</h3><h2 id="dynamic-flags"><a href="#dynamic-flags" class="headerlink" title="dynamic flags"></a>dynamic flags</h2><h3 id="fPIC"><a href="#fPIC" class="headerlink" title="-fPIC"></a>-fPIC</h3><p><img src="https://pic.shaojiemike.top/img/20211211153406.png"></p>
<p>position-independent code(PIC)</p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/daidodo/article/details/2185222">https://blog.csdn.net/daidodo/article/details/2185222</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bu.edu/tech/support/research/software-and-programming/programming/compilers/gcc-compiler-flags/">https://www.bu.edu/tech/support/research/software-and-programming/programming/compilers/gcc-compiler-flags/</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-12T16:00:00.000Z" title="10/12/2023, 4:00:00 PM">2023-10-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-08-23T07:40:35.249Z" title="8/23/2024, 7:40:35 AM">2024-08-23</time></span><span class="level-item"><a class="link-muted" href="/categories/operating-system/">operating system</a></span><span class="level-item">an hour read (About 10843 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/12/Work/Programming/4-compile/Cprogramcompileandrunprocess/">C program compile&amp;run process</a></p><div class="content"><h2 id="ç¼–è¯‘æ€»æµç¨‹"><a href="#ç¼–è¯‘æ€»æµç¨‹" class="headerlink" title="ç¼–è¯‘æ€»æµç¨‹"></a>ç¼–è¯‘æ€»æµç¨‹</h2><p>ç¼–è¯‘æ˜¯æŒ‡ç¼–è¯‘å™¨è¯»å–æºç¨‹åºï¼ˆå­—ç¬¦æµï¼‰ï¼Œå¯¹ä¹‹è¿›è¡Œè¯æ³•å’Œè¯­æ³•çš„åˆ†æï¼Œå°†é«˜çº§è¯­è¨€æŒ‡ä»¤è½¬æ¢ä¸ºåŠŸèƒ½ç­‰æ•ˆçš„æ±‡ç¼–ä»£ç ã€‚</p>
<ol>
<li>é¢„å¤„ç†é˜¶æ®µï¼š<ol>
<li>æŠŠ<code>#include</code>è¯­å¥ä»¥åŠä¸€äº›å®æ’å…¥ç¨‹åºæ–‡æœ¬ä¸­ï¼Œå¾—åˆ°<code>main.i</code>å’Œ<code>sum.i</code>æ–‡ä»¶ã€‚</li>
</ol>
</li>
<li>ç¼–è¯‘é˜¶æ®µ:<ol>
<li>å°†æ–‡æœ¬æ–‡ä»¶<code>main.i</code>å’Œ<code>sum.i</code>ç¼–è¯‘æˆæ–‡æœ¬æ–‡ä»¶<code>main.s</code>å’Œ<code>sum.c</code>çš„æ±‡ç¼–è¯­è¨€ç¨‹åºã€‚<br>ä½çº§çš„æ±‡ç¼–è¯­è¨€ä¸ºä¸åŒçš„é«˜çº§è¯­è¨€æä¾›äº†é€šç”¨è¾“å‡ºè¯­è¨€ã€‚</li>
</ol>
</li>
<li>æ±‡ç¼–é˜¶æ®µ:<ol>
<li>å°†<code>main.s</code>å’Œ<code>sum.s</code>ç¿»è¯‘æˆæœºå™¨è¯­è¨€çš„äºŒè¿›åˆ¶æŒ‡ä»¤ï¼Œå¹¶æ‰“åŒ…æˆä¸€ç§å«åšå¯é‡å®šä½ç›®æ ‡ç¨‹åºçš„æ ¼å¼ï¼Œå¹¶å°†ç»“æœä¿å­˜åœ¨main.oå’Œsum.oä¸¤ä¸ªæ–‡ä»¶ä¸­ã€‚è¿™ç§æ–‡ä»¶æ ¼å¼å°±æ¯”è¾ƒæ¥è¿‘elfæ ¼å¼äº†ã€‚</li>
</ol>
</li>
<li>é“¾æ¥é˜¶æ®µ:<ol>
<li>åˆå¹¶<code>main.o</code>å’Œ<code>sum.o</code>ï¼Œå¾—åˆ°å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ï¼Œå°±æ˜¯elfæ ¼å¼æ–‡ä»¶ã€‚</li>
</ol>
</li>
</ol>
<p><img src="https://pic.shaojiemike.top/img/20230602165640.png"><br><img src="https://pic.shaojiemike.top/img/20220820153439.png"></p>
<!-- ![](https://pic.shaojiemike.top/img/InkedQQ%E6%88%AA%E5%9B%BE20210802192937_LI.jpg) -->

<!-- ![](https://pic.shaojiemike.top/img/Inked112521_UvDL_2430084_LI.jpg) -->

<h3 id="ç›®æ ‡æ–‡ä»¶"><a href="#ç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç›®æ ‡æ–‡ä»¶"></a>ç›®æ ‡æ–‡ä»¶</h3><p>ç›®æ ‡æ–‡ä»¶æœ‰ä¸‰ç§å½¢å¼ï¼š</p>
<ul>
<li>å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ã€‚åŒ…å«äºŒè¿›åˆ¶ä»£ç å’Œæ•°æ®ï¼Œå…¶å½¢å¼å¯ä»¥åœ¨ç¼–è¯‘æ—¶ä¸å…¶ä»–å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶åˆå¹¶èµ·æ¥ï¼Œåˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ã€‚</li>
<li>å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ã€‚åŒ…å«äºŒè¿›åˆ¶ä»£ç å’Œæ•°æ®ï¼Œå…¶å½¢å¼å¯ä»¥è¢«ç›´æ¥å¤åˆ¶åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚</li>
<li>å…±äº«ç›®æ ‡æ–‡ä»¶ã€‚ä¸€ç§ç‰¹æ®Šç±»å‹çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŠ è½½æˆ–è€…è¿è¡Œæ—¶è¢«åŠ¨æ€åœ°åŠ è½½è¿›å†…å­˜å¹¶é“¾æ¥ã€‚</li>
</ul>
<h2 id="1-é¢„å¤„ç†"><a href="#1-é¢„å¤„ç†" class="headerlink" title="1 é¢„å¤„ç†"></a>1 é¢„å¤„ç†</h2><ul>
<li>é¢„å¤„ç†å™¨ï¼š å°†<code>.c</code> æ–‡ä»¶è½¬åŒ–æˆ <code>.i</code>æ–‡ä»¶.</li>
</ul>
<h3 id="ç”Ÿæˆé¢„å¤„ç†æ–‡ä»¶"><a href="#ç”Ÿæˆé¢„å¤„ç†æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆé¢„å¤„ç†æ–‡ä»¶"></a>ç”Ÿæˆé¢„å¤„ç†æ–‡ä»¶</h3><ul>
<li>ä½¿ç”¨çš„gccå‘½ä»¤æ˜¯ï¼š<code>gcc â€“E filename.cpp -o filename.i</code><ul>
<li><code>-E  Preprocess only; do not compile, assemble or link.</code></li>
<li>é€šè¿‡<code>-C</code>èƒ½ä¿ç•™å¤´æ–‡ä»¶é‡Œçš„æ³¨é‡Šï¼Œå¦‚<code>gcc -E -C circle.c -o circle.c</code></li>
</ul>
</li>
<li>å¦ä¸€ç§æ–¹å¼ <code>gcc -save-temps -c -o main.o main.c</code></li>
<li>ä¹Ÿå¯ä»¥è°ƒç”¨<code>cpp filename.cpp -o filename.i</code>å‘½ä»¤</li>
</ul>
<h3 id="ç†è§£é¢„å¤„ç†æ–‡ä»¶"><a href="#ç†è§£é¢„å¤„ç†æ–‡ä»¶" class="headerlink" title="ç†è§£é¢„å¤„ç†æ–‡ä»¶"></a>ç†è§£é¢„å¤„ç†æ–‡ä»¶</h3><ul>
<li>è¾“å‡ºæ–‡ä»¶ä¼šå‡ºç°è®¸å¤šåå« <code>linemarkers</code>ç±»ä¼¼<code># linenum filename flags</code>çš„æ³¨é‡Šï¼Œè¿™äº›æ³¨é‡Šæ˜¯ä¸ºäº†è®©ç¼–è¯‘å™¨èƒ½å¤Ÿå®šä½åˆ°æºæ–‡ä»¶çš„è¡Œå·ï¼Œä»¥ä¾¿äºç¼–è¯‘å™¨èƒ½å¤Ÿåœ¨ç¼–è¯‘é”™è¯¯æ—¶ç»™å‡ºæ­£ç¡®çš„è¡Œå·ã€‚<ul>
<li>They mean that the following line originated in file filename at line linenum.</li>
<li><code>flags</code> meaning<ul>
<li>â€˜1â€™ This indicates the start of a new file.</li>
<li>â€˜2â€™ This indicates returning to a file (after having included another file)</li>
<li>â€˜3â€™ This indicates that the following text comes from a <strong>system header file</strong>, so certain warnings should be suppressed</li>
<li>â€˜4â€™ This indicates that the following text should be treated as being wrapped in an implicit extern â€œCâ€ block.<ul>
<li>â€˜4â€™è¡¨ç¤ºæ¥ä¸‹æ¥çš„æ–‡æœ¬åº”è¢«è§†ä¸ºè¢«åŒ…å«åœ¨éšå¼çš„â€œextern â€œCâ€â€å—ä¸­ã€‚åœ¨C++ä¸­ï¼Œå‡½æ•°åå’Œå˜é‡åå¯ä»¥æœ‰ä¸åŒçš„å‘½åç©ºé—´ï¼Œä½†æ˜¯ä½¿ç”¨â€œextern â€œCâ€â€ä¿®é¥°æ—¶å¯ä»¥å–æ¶ˆè¿™ç§åŒºåˆ«ï¼Œä½¿å¾—å‡½æ•°åå’Œå˜é‡åå¯ä»¥åœ¨C++å’ŒCä»£ç ä¹‹é—´å…±äº«ã€‚å› æ­¤ï¼Œåœ¨C++ä¸­ä½¿ç”¨â€œextern â€œCâ€â€æ¥å£°æ˜Cå‡½æ•°æˆ–å˜é‡æ—¶ï¼Œéœ€è¦ä½¿ç”¨â€˜4â€™æ¥æŒ‡ç¤ºç¼–è¯‘å™¨æ­¤å¤„çš„æ–‡æœ¬åº”è¯¥è¢«è§†ä¸ºCä»£ç ï¼Œè€Œä¸æ˜¯C++ä»£ç ã€‚[æ¥è‡ªchatGPTçš„è§£é‡Š]</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="é¢„å¤„ç†å†…å®¹-è¿‡ç¨‹"><a href="#é¢„å¤„ç†å†…å®¹-è¿‡ç¨‹" class="headerlink" title="é¢„å¤„ç†å†…å®¹(è¿‡ç¨‹)"></a>é¢„å¤„ç†å†…å®¹(è¿‡ç¨‹)</h3><p>é™¤å¼€æ³¨é‡Šè¢«æ›¿æ¢æˆç©ºæ ¼ï¼ŒåŒ…æ‹¬ä»£ç é‡Œçš„é¢„å¤„ç†å‘½ä»¤ï¼š</p>
<ol start="0">
<li><code>#error &quot;text&quot;</code> çš„ä½œç”¨æ˜¯åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œå®ƒä¼šå¯¼è‡´ç¼–è¯‘è¿‡ç¨‹ä¸­æ–­ã€‚ åŒç†æœ‰<code>#warning</code></li>
<li>å®å®šä¹‰æŒ‡ä»¤ï¼Œå¦‚ <code>#define a b</code> å¯¹äºè¿™ç§ä¼ªæŒ‡ä»¤ï¼Œé¢„ç¼–è¯‘æ‰€è¦åšçš„æ˜¯å°†ç¨‹åºä¸­çš„æ‰€æœ‰aç”¨bæ›¿æ¢ï¼Œä½†ä½œä¸ºå­—ç¬¦ä¸²å¸¸é‡çš„ aåˆ™ä¸è¢«æ›¿æ¢ã€‚è¿˜æœ‰ #undefï¼Œåˆ™å°†å–æ¶ˆå¯¹æŸä¸ªå®çš„å®šä¹‰ï¼Œä½¿ä»¥åè¯¥ä¸²çš„å‡ºç°ä¸å†è¢«æ›¿æ¢ã€‚</li>
<li>æ¡ä»¶ç¼–è¯‘æŒ‡ä»¤ï¼Œå¦‚<code>#ifdef SNIPER</code>ï¼Œ<code>#if defined SNIPER &amp;&amp; SNIPER == 0</code>,#ifndefï¼Œ#elseï¼Œ#elifï¼Œ#endifç­‰ã€‚ è¿™äº›ä¼ªæŒ‡ä»¤çš„å¼•å…¥ä½¿å¾—ç¨‹åºå‘˜å¯ä»¥é€šè¿‡å®šä¹‰ä¸åŒçš„å®æ¥å†³å®šç¼–è¯‘ç¨‹åºå¯¹å“ªäº›ä»£ç è¿›è¡Œå¤„ç†ã€‚é¢„ç¼–è¯‘ç¨‹åºå°†æ ¹æ®æœ‰å…³çš„æ–‡ä»¶ï¼Œå°†é‚£äº›ä¸å¿…è¦çš„ä»£ç è¿‡æ»¤æ‰<ol>
<li>gccç¼–è¯‘<a target="_blank" rel="noopener" href="https://www.linuxtopia.org/online_books/an_introduction_to_gcc/gccintro_34.html">ä½¿ç”¨<code>-DSNIPER=5</code></a></li>
</ol>
</li>
<li>å¤´æ–‡ä»¶åŒ…å«æŒ‡ä»¤ï¼Œå¦‚<code>#include &quot;FileName&quot;</code>æˆ–è€…#include ç­‰ã€‚<br>è¯¥æŒ‡ä»¤å°†å¤´æ–‡ä»¶ä¸­çš„å®šä¹‰ç»Ÿç»Ÿéƒ½åŠ å…¥åˆ°å®ƒæ‰€äº§ç”Ÿçš„è¾“å‡ºæ–‡ä»¶ä¸­ï¼Œä»¥ä¾›ç¼–è¯‘ç¨‹åºå¯¹ä¹‹è¿›è¡Œå¤„ç†ã€‚</li>
<li>ç‰¹æ®Šç¬¦å·ï¼Œé¢„ç¼–è¯‘ç¨‹åºå¯ä»¥è¯†åˆ«ä¸€äº›ç‰¹æ®Šçš„ç¬¦å·ã€‚<br>ä¾‹å¦‚åœ¨æºç¨‹åºä¸­å‡ºç°çš„<code>LINE</code>æ ‡è¯†å°†è¢«è§£é‡Šä¸ºå½“å‰è¡Œå·ï¼ˆåè¿›åˆ¶æ•°ï¼‰ï¼Œ<code>FILE</code>åˆ™è¢«è§£é‡Šä¸ºå½“å‰è¢«ç¼–è¯‘çš„Cæºç¨‹åºçš„åç§°ã€‚<br>é¢„ç¼–è¯‘ç¨‹åºå¯¹äºåœ¨æºç¨‹åºä¸­å‡ºç°çš„è¿™äº›ä¸²å°†ç”¨åˆé€‚çš„å€¼è¿›è¡Œæ›¿æ¢ã€‚</li>
</ol>
<h3 id="å¤´æ–‡ä»¶æœç´¢ä¼˜å…ˆçº§"><a href="#å¤´æ–‡ä»¶æœç´¢ä¼˜å…ˆçº§" class="headerlink" title="å¤´æ–‡ä»¶æœç´¢ä¼˜å…ˆçº§"></a>å¤´æ–‡ä»¶æœç´¢ä¼˜å…ˆçº§</h3><p><code>#include &quot;&quot;</code> vs <code>#include &lt;&gt;</code> <a target="_blank" rel="noopener" href="https://gcc.gnu.org/onlinedocs/cpp/Search-Path.html">åŒºåˆ«åœ¨äº</a>å‰è€…ä¼šåœ¨æ–‡ä»¶çš„å½“å‰ç›®å½•å¯»æ‰¾ï¼Œä½†æ˜¯åè€…åªä¼šåœ¨ç¼–è¯‘å™¨ç¼–è¯‘çš„officialè·¯å¾„å¯»æ‰¾</p>
<p><a target="_blank" rel="noopener" href="https://gcc.gnu.org/onlinedocs/gcc/Directory-Options.html">é€šå¸¸çš„æœç´¢é¡ºåº</a>æ˜¯ï¼š</p>
<ul>
<li><p>åŒ…å«æŒ‡å®šæºæ–‡ä»¶çš„ç›®å½•ï¼ˆå¯¹äºåœ¨ <code>#include</code> å‘½ä»¤ä¸­ä»¥<strong>å¼•å·</strong>åŒ…æ‹¬çš„æ–‡ä»¶åï¼‰ã€‚</p>
</li>
<li><p>é‡‡ç”¨<code>-iquote</code>é€‰é¡¹æŒ‡å®šçš„ç›®å½•ï¼Œä¾ç…§å‡ºç°åœ¨å‘½ä»¤è¡Œä¸­çš„é¡ºåºè¿›è¡Œæœç´¢ã€‚åªå¯¹ <code>#include</code> å‘½ä»¤ä¸­é‡‡ç”¨å¼•å·çš„å¤´æ–‡ä»¶åè¿›è¡Œæœç´¢ã€‚</p>
</li>
<li><p>æ‰€æœ‰header fileçš„æœå¯»ä¼šä»<code>-I</code>å¼€å§‹, ä¾ç…§å‡ºç°åœ¨å‘½ä»¤è¡Œä¸­çš„é¡ºåºè¿›è¡Œæœç´¢ã€‚ï¼ˆå¯ä»¥ä½¿ç”¨<code>-I/path/file</code>åªæ·»åŠ ä¸€ä¸ªå¤´æ–‡ä»¶ï¼Œå°¤å…¶æ˜¯åœ¨ç¼–è¯‘çš„å…¼å®¹æ€§ä¿®æ”¹æ—¶ï¼‰</p>
</li>
<li><p>é‡‡ç”¨ç¯å¢ƒå˜é‡ CPATH æŒ‡å®šçš„ç›®å½•ã€‚</p>
</li>
<li><p>é‡‡ç”¨<code>-isystem</code>é€‰é¡¹æŒ‡å®šçš„ç›®å½•ï¼Œä¾ç…§å‡ºç°åœ¨å‘½ä»¤è¡Œä¸­çš„é¡ºåºè¿›è¡Œæœç´¢ã€‚</p>
</li>
<li><p>ç„¶åæ‰¾ç¯å¢ƒå˜é‡ <code>C_INCLUDE_PATH,CPLUS_INCLUDE_PATH,OBJC_INCLUDE_PATH</code>æŒ‡å®šçš„è·¯å¾„</p>
</li>
<li><p>å†æ‰¾ç³»ç»Ÿé»˜è®¤ç›®å½•<code>(/usr/includeã€/usr/local/includeã€/usr/lib/gcc-lib/i386-linux/2.95.2/include......)</code></p>
</li>
<li><p>é€šè¿‡å¦‚ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹å¤´æ–‡ä»¶æœç´¢ç›®å½• <code>gcc -xc -E -v - &lt; /dev/null</code> æˆ–è€… <code>g++ -xc++ -E -v - &lt; /dev/null</code>*. <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/66338913/how-to-change-default-clang-include-directory-search-paths">å¦‚æœæƒ³æ”¹ï¼Œéœ€è¦é‡æ–°ç¼–è¯‘gcc</a></p>
</li>
<li><p>æˆ–è€…åœ¨ç¼–è¯‘å‡ºé”™æ—¶ï¼Œ<code>g++ -H -v</code>æŸ¥çœ‹æ˜¯ä¸æ˜¯é¡¹ç›®ä¸‹çš„åŒåå¤´æ–‡ä»¶ä¼˜å…ˆçº§é«˜äºsys-head-file</p>
</li>
</ul>
<h2 id="2-ç¼–è¯‘ä¼˜åŒ–Compile"><a href="#2-ç¼–è¯‘ä¼˜åŒ–Compile" class="headerlink" title="2 ç¼–è¯‘ä¼˜åŒ–Compile"></a>2 ç¼–è¯‘ä¼˜åŒ–Compile</h2><ul>
<li>å°†ç»è¿‡é¢„å¤„ç†ä¹‹åçš„ç¨‹åºè½¬æ¢æˆç‰¹å®šæ±‡ç¼–ä»£ç (assembly code)çš„è¿‡ç¨‹</li>
<li>ä¸€èˆ¬å°†<code>.c/.h</code>æˆ–è€…<code>.i</code>æ–‡ä»¶è½¬æ¢æˆ<code>.s</code>æ–‡ä»¶ï¼Œ</li>
</ul>
<h3 id="ç”Ÿæˆæ±‡ç¼–ä»£ç "><a href="#ç”Ÿæˆæ±‡ç¼–ä»£ç " class="headerlink" title="ç”Ÿæˆæ±‡ç¼–ä»£ç "></a>ç”Ÿæˆæ±‡ç¼–ä»£ç </h3><ul>
<li>ä½¿ç”¨çš„gccå‘½ä»¤æ˜¯ï¼š<code>gcc â€“S filename.cpp -o filename.s</code>ï¼Œå¯¹åº”äº<ul>
<li><code>-S   Compile only; do not assemble or link.</code></li>
<li>ç†è®ºä¸Š<code>gcc â€“S filename.i -o filename.s</code> ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚ä½†æ˜¯æˆ‘é‡åˆ°å¤´æ–‡ä»¶å†²çªçš„é—®é¢˜<code>error: declaration for parameter â€˜__u_charâ€™ but no such parameter</code></li>
</ul>
</li>
<li>ç¼–è¯‘å‘½ä»¤ <code>cc â€“S filename.cpp -o filename.s</code>  </li>
<li>æˆ–è€…<code>cc1</code>å‘½ä»¤</li>
</ul>
<h3 id="ç¼–è¯‘å†…å®¹ï¼ˆè¿‡ç¨‹ï¼‰"><a href="#ç¼–è¯‘å†…å®¹ï¼ˆè¿‡ç¨‹ï¼‰" class="headerlink" title="ç¼–è¯‘å†…å®¹ï¼ˆè¿‡ç¨‹ï¼‰"></a>ç¼–è¯‘å†…å®¹ï¼ˆè¿‡ç¨‹ï¼‰</h3><ul>
<li>è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­æ„åˆ†æã€ä¸­é—´ä»£ç ç”Ÿæˆï¼Œåœ¨è¯­æ³•æ£€æŸ¥ã€ç±»å‹æ£€æŸ¥ä¹‹åï¼Œå°†å…¶ç¿»è¯‘æˆç­‰ä»·çš„<strong>ä¸­é—´ä»£ç è¡¨ç¤º</strong>æˆ–æ±‡ç¼–ä»£ç </li>
<li>ä¼˜åŒ–ï¼ˆ<code>-O3</code>ï¼‰<ul>
<li>å¸¸è§„ä¼˜åŒ–ï¼šåˆ é™¤æ­»ä»£ç ã€å‡å°‘å¯„å­˜å™¨ä¼ è¾“ã€å¸¸é‡æŠ˜å ã€æå–ä¸­é—´é‡</li>
<li>é«˜é˜¶ä¼˜åŒ–ï¼šå¾ªç¯å±•å¼€ã€æŒ‡é’ˆä¼˜åŒ–ã€å‡½æ•°å†…è”ï¼Œè‡ªåŠ¨SIMDå‘é‡åŒ–</li>
</ul>
</li>
<li>å…³äºå†…è”å‡½æ•°<ul>
<li>å†…è”å‡½æ•°æ˜¯åœ¨å‡½æ•°å®šä¹‰å‰åŠ ä¸Šå…³é”®å­—inlineçš„å‡½æ•°ã€‚å®ƒç”¨äºè¯·æ±‚ç¼–è¯‘å™¨å°†å‡½æ•°çš„ä»£ç æ’å…¥åˆ°æ¯ä¸ªè°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹ï¼Œè€Œä¸æ˜¯é€šè¿‡å‡½æ•°è°ƒç”¨æ¥æ‰§è¡Œã€‚è¿™æ ·å¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚</li>
<li>å†…è”å‡½æ•°ä¸€èˆ¬é€‚ç”¨äºå‡½æ•°ä½“è¾ƒå°ã€é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ï¼Œä½†æœ€ç»ˆæ˜¯<strong>ç¼–è¯‘å™¨å†³å®š</strong>æ˜¯å¦å°†å‡½æ•°å†…è”ï¼Œç¼–è¯‘å™¨å¯ä»¥å¿½ç•¥å¯¹å†…è”å‡½æ•°çš„è¯·æ±‚ã€‚</li>
</ul>
</li>
</ul>
<p>å¦‚æœæƒ³æŠŠ C è¯­è¨€å˜é‡çš„åç§°ä½œä¸ºæ±‡ç¼–è¯­è¨€è¯­å¥ä¸­çš„æ³¨é‡Šï¼Œå¯ä»¥åŠ ä¸Š <code>-fverbose-asm</code> é€‰é¡¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -S -O3 -fverbose-asm ../src/pivot.c -o pivot_O1.s</span><br><span class="line">objdump -Sd ../build/bin/pivot &gt; pivot1.s</span><br></pre></td></tr></table></figure>

<h3 id="ç†è§£æ±‡ç¼–æ–‡ä»¶"><a href="#ç†è§£æ±‡ç¼–æ–‡ä»¶" class="headerlink" title="ç†è§£æ±‡ç¼–æ–‡ä»¶"></a>ç†è§£æ±‡ç¼–æ–‡ä»¶</h3><p>è¯·é˜…è¯» GNU assembly fileä¸€æ–‡</p>
<h2 id="3-æ±‡ç¼–assemble"><a href="#3-æ±‡ç¼–assemble" class="headerlink" title="3 æ±‡ç¼–assemble"></a>3 æ±‡ç¼–assemble</h2><p>æ±‡ç¼–å™¨ï¼šå°†.s æ–‡ä»¶è½¬åŒ–æˆ .oæ–‡ä»¶ï¼Œ</p>
<h3 id="ç”Ÿæˆå¯é‡å®šä½ç›®æ ‡ç¨‹åº"><a href="#ç”Ÿæˆå¯é‡å®šä½ç›®æ ‡ç¨‹åº" class="headerlink" title="ç”Ÿæˆå¯é‡å®šä½ç›®æ ‡ç¨‹åº"></a>ç”Ÿæˆå¯é‡å®šä½ç›®æ ‡ç¨‹åº</h3><ul>
<li>ä½¿ç”¨çš„gcc å‘½ä»¤æ˜¯ï¼š<code>gcc â€“c</code>ï¼Œ<ul>
<li><code>-c   Compile and assemble, but do not link.</code></li>
</ul>
</li>
<li>æ±‡ç¼–å‘½ä»¤æ˜¯ <code>as</code>ï¼›</li>
</ul>
<h3 id="æ±‡ç¼–è¿‡ç¨‹"><a href="#æ±‡ç¼–è¿‡ç¨‹" class="headerlink" title="æ±‡ç¼–è¿‡ç¨‹"></a>æ±‡ç¼–è¿‡ç¨‹</h3><ul>
<li>æ±‡ç¼–å®é™…ä¸ŠæŒ‡æ±‡ç¼–å™¨(as)æŠŠæ±‡ç¼–è¯­è¨€ä»£ç ç¿»è¯‘æˆ**ç›®æ ‡æœºå™¨æŒ‡ä»¤(äºŒè¿›åˆ¶)**çš„è¿‡ç¨‹ã€‚</li>
<li>ç›®æ ‡æ–‡ä»¶ä¸­æ‰€å­˜æ”¾çš„ä¹Ÿå°±æ˜¯ä¸æºç¨‹åºç­‰æ•ˆçš„ç›®æ ‡çš„æœºå™¨è¯­è¨€ä»£ç ã€‚</li>
<li>ç›®æ ‡æ–‡ä»¶ç”±æ®µç»„æˆã€‚é€šå¸¸ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªæ®µï¼š</li>
</ul>
<ol>
<li>ä»£ç æ®µï¼šè¯¥æ®µä¸­æ‰€åŒ…å«çš„ä¸»è¦æ˜¯ç¨‹åºçš„æŒ‡ä»¤ã€‚è¯¥æ®µä¸€èˆ¬æ˜¯å¯è¯»å’Œå¯æ‰§è¡Œçš„ï¼Œä½†ä¸€èˆ¬å´ä¸å¯å†™ã€‚</li>
<li>æ•°æ®æ®µï¼šä¸»è¦å­˜æ”¾ç¨‹åºä¸­è¦ç”¨åˆ°çš„å„ç§å…¨å±€å˜é‡æˆ–é™æ€çš„æ•°æ®ã€‚ä¸€èˆ¬æ•°æ®æ®µéƒ½æ˜¯å¯è¯»ï¼Œå¯å†™ï¼Œå¯æ‰§è¡Œçš„ã€‚<br><img src="https://pic.shaojiemike.top/img/20230521202224.png"></li>
</ol>
<h3 id="æŸ¥çœ‹ç†è§£"><a href="#æŸ¥çœ‹ç†è§£" class="headerlink" title="æŸ¥çœ‹ç†è§£"></a>æŸ¥çœ‹ç†è§£</h3><ul>
<li>æŸ¥çœ‹æ±‡ç¼–ä»£ç  <code>objdump -Sd ../build/bin/pivot &gt; pivot1.s</code><ul>
<li><code>-S</code> ä»¥æ±‡ç¼–ä»£ç çš„å½¢å¼æ˜¾ç¤ºC++åŸç¨‹åºä»£ç ï¼Œå¦‚æœæœ‰debugä¿¡æ¯ï¼Œä¼šæ˜¾ç¤ºæºä»£ç ã€‚</li>
</ul>
</li>
<li><code>nm file.o</code> æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨</li>
</ul>
<p>æ³¨æ„ï¼Œè¿™æ—¶å€™çš„ç›®æ ‡æ–‡ä»¶é‡Œçš„ä½¿ç”¨çš„å‡½æ•°å¯èƒ½æ²¡å®šä¹‰ï¼Œéœ€è¦é“¾æ¥å…¶ä»–ç›®æ ‡æ–‡ä»¶<code>.a .so .o .dll</code>(Dynamic Link Libraryçš„ç¼©å†™ï¼ŒWindowsåŠ¨æ€é“¾æ¥åº“)</p>
<h2 id="nm-å‘½ä»¤"><a href="#nm-å‘½ä»¤" class="headerlink" title="nm å‘½ä»¤"></a>nm å‘½ä»¤</h2><p>List symbol names in object files.</p>
<ol>
<li>ç¬¦å·å€¼ã€‚é»˜è®¤æ˜¾ç¤ºåå…­è¿›åˆ¶ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šï¼›</li>
<li>ç¬¦å·ç±»å‹ã€‚å°å†™è¡¨ç¤ºæ˜¯æœ¬åœ°ç¬¦å·ï¼Œå¤§å†™è¡¨ç¤ºå…¨å±€ç¬¦å·(external);</li>
<li>ç¬¦å·åç§°ã€‚</li>
</ol>
<table>
<thead>
<tr>
<th>ç¬¦å·ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>ç¬¦å·å€¼æ˜¯ç»å¯¹çš„ã€‚åœ¨è¿›ä¸€æ­¥çš„è¿æ¥ä¸­ï¼Œä¸ä¼šè¢«æ”¹å˜ã€‚</td>
</tr>
<tr>
<td>B</td>
<td>ç¬¦å·ä½äºæœªåˆå§‹åŒ–æ•°æ®æ®µ(known as BSS).</td>
</tr>
<tr>
<td>C</td>
<td>å…±ç”¨(common)ç¬¦å·. å…±ç”¨ç¬¦å·æ˜¯æœªåˆå§‹åŒ–çš„æ•°æ®ã€‚åœ¨è¿æ¥æ—¶ï¼Œå¤šä¸ªå…±ç”¨ç¬¦å·å¯èƒ½é‡‡ç”¨ä¸€ä¸ªåŒæ ·çš„åå­—ï¼Œå¦‚æœè¿™ä¸ªç¬¦å·åœ¨æŸä¸ªåœ°æ–¹è¢«å®šä¹‰ï¼Œå…±ç”¨ç¬¦å·è¢«è®¤ä¸ºæ˜¯æœªå®šä¹‰çš„å¼•ç”¨.</td>
</tr>
<tr>
<td>D</td>
<td>å·²åˆå§‹åŒ–æ•°æ®æ®µçš„ç¬¦å·</td>
</tr>
<tr>
<td>G</td>
<td>å·²åˆå§‹åŒ–æ•°æ®æ®µä¸­çš„å°ç›®æ ‡(small objective)ç¬¦å·. ä¸€äº›ç›®æ ‡æ–‡ä»¶æ ¼å¼å…è®¸æ›´æœ‰æ•ˆçš„è®¿é—®å°ç›®æ ‡æ•°æ®ï¼Œæ¯”å¦‚ä¸€ä¸ªå…¨å±€çš„intå˜é‡ç›¸å¯¹äºä¸€ä¸ªå¤§çš„å…¨å±€æ•°ç»„ã€‚</td>
</tr>
<tr>
<td>I</td>
<td>å…¶ä»–ç¬¦å·çš„ç›´æ¥åº”ç”¨ï¼Œè¿™æ˜¯GNUæ‰©å±•çš„ï¼Œå¾ˆå°‘ç”¨äº†. N è°ƒè¯•ç¬¦å·.</td>
</tr>
<tr>
<td>R</td>
<td>åªè¯»æ•°æ®æ®µç¬¦å·. S æœªåˆå§‹åŒ–æ•°æ®æ®µä¸­çš„å°ç›®æ ‡(small object)ç¬¦å·.</td>
</tr>
<tr>
<td>T</td>
<td>ä»£ç æ®µçš„ç¬¦å·.</td>
</tr>
<tr>
<td>U</td>
<td>æœªå®šä¹‰ç¬¦å·.</td>
</tr>
<tr>
<td>V</td>
<td>å¼±å¯¹è±¡(weak object)ç¬¦å·. å½“ä¸€ä¸ªå·²å®šä¹‰çš„å¼±ç¬¦å·è¢«è¿æ¥åˆ°ä¸€ä¸ªæ™®é€šå®šä¹‰ç¬¦å·ï¼Œæ™®é€šå®šä¹‰ç¬¦å·å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œå½“ä¸€ä¸ªæœªå®šä¹‰çš„å¼±å¯¹è±¡è¢«è¿æ¥åˆ°ä¸€ä¸ªæœªå®šä¹‰çš„ç¬¦å·ï¼Œå¼±ç¬¦å·çš„å€¼ä¸º0.</td>
</tr>
<tr>
<td>W</td>
<td>ä¸€ä¸ªæ²¡æœ‰è¢«æŒ‡å®šä¸€ä¸ªå¼±å¯¹è±¡ç¬¦å·çš„å¼±ç¬¦å·(weak symbol)ã€‚ - a.outç›®æ ‡æ–‡ä»¶ä¸­çš„åˆºç¬¦å·(stabs symbol). è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰“å°çš„ä¸‹ä¸€ä¸ªå€¼æ˜¯å…¶ä»–å­—æ®µï¼Œæè¿°å­—æ®µï¼Œå’Œç±»å‹ã€‚åˆºç¬¦å·ç”¨äºä¿ç•™è°ƒè¯•ä¿¡æ¯.</td>
</tr>
<tr>
<td>?</td>
<td>æœªçŸ¥ç¬¦å·ç±»å‹ï¼Œæˆ–è€…ç›®æ ‡æ–‡ä»¶ç‰¹æœ‰çš„ç¬¦å·ç±»å‹.</td>
</tr>
</tbody></table>
<h2 id="4-é“¾æ¥è¿‡ç¨‹"><a href="#4-é“¾æ¥è¿‡ç¨‹" class="headerlink" title="4 é“¾æ¥è¿‡ç¨‹"></a>4 é“¾æ¥è¿‡ç¨‹</h2><p>é€šè¿‡ä½¿ç”¨<code>ld</code>å‘½ä»¤ï¼Œå°†ç¼–è¯‘å¥½çš„ç›®æ ‡æ–‡ä»¶è¿æ¥æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æˆ–åŠ¨æ€åº“ã€‚</p>
<ul>
<li>é“¾æ¥å™¨çš„æ ¸å¿ƒå·¥ä½œå°±æ˜¯ç¬¦å·è¡¨è§£æã€é‡å®šä½å’Œåº“æ–‡ä»¶é“¾æ¥ä¸‰ä¸ªéƒ¨åˆ†ã€‚(å…·ä½“ç»†èŠ‚çœ‹<a target="_blank" rel="noopener" href="https://hansimov.gitbook.io/csapp/part2/ch07-linking/7.7-relocation">CSAPP7.5-7.7</a>)<ul>
<li><strong>ç¬¦å·è§£æ</strong><ul>
<li>æ¯ä¸ªå¯é‡å®šä½ç›®æ ‡ç¨‹åºä¸­éƒ½å­˜åœ¨ç¬¦å·è¡¨çš„æ•°æ®ç»“æ„ï¼ŒåŒ…å«äº†ä¸€äº›è¢«å£°æ˜çš„å‡½æ•°å’Œå˜é‡çš„ç¬¦å·ã€‚ä¾ä¸Šä¾‹ï¼Œmain.oå’Œsum.oéƒ½æœ‰ä¸€ä¸ªè¿™æ ·çš„ç»“æ„ã€‚ç¬¦å·è¡¨ä¸­çš„æ¯ä¸€é¡¹éƒ½åŒ…å«ä¸€ä¸ªç¬¦å·åå­—å’Œä¸€ä¸ªç¬¦å·å®šä¹‰çš„åœ°å€ã€‚</li>
<li>ç¬¦å·è§£æçš„ä»»åŠ¡å°±æ˜¯å°†è¿™äº›ç¬¦å·å’Œå®ƒä»¬æ‰€åœ¨çš„æºæ–‡ä»¶ã€åº“æ–‡ä»¶ä¸­çš„å®šä¹‰è¿›è¡ŒåŒ¹é…ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šç”Ÿæˆç¬¦å·è¡¨ï¼Œç”¨äºç»™é“¾æ¥å™¨åœ¨åç»­çš„é‡å®šä½ä¸­æ‰¾åˆ°å‡½æ•°æ‰€åœ¨çš„åœ°å€ã€‚</li>
<li>å¯¹äºç¬¦å·è§£ææœ‰<strong>é‡è½½</strong>ï¼ˆä¸åŒçš„ç±»ï¼Œå‡½æ•°åç›¸åŒï¼‰çš„ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚<code>Foo::bar(int,long)</code>ä¼šå˜æˆ<code>bar__3Fooil</code>ã€‚å…¶ä¸­3æ˜¯åå­—å­—ç¬¦æ•°</li>
</ul>
</li>
<li><strong>é‡å®šä½</strong>ï¼šåœ¨ç¬¦å·è§£æå®Œæˆåï¼Œé“¾æ¥å™¨ä¼šæŠŠä¸åŒçš„ç›®æ ‡æ–‡ä»¶åˆå¹¶åœ¨ä¸€èµ·ï¼Œæ­¤æ—¶å°±éœ€è¦å¯¹ç›®æ ‡ä»£ç è¿›è¡Œåœ°å€çš„ä¿®æ­£ï¼Œä½¿å¾—å„ä¸ªç›®æ ‡æ–‡ä»¶ä¹‹é—´çš„å‡½æ•°è°ƒç”¨æˆ–è€…å˜é‡è®¿é—®éƒ½å¯ä»¥æ­£ç¡®ã€‚è¿™ä¸ªè¿‡ç¨‹å«åšé‡å®šä½ã€‚é“¾æ¥å™¨ä¼šæ ¹æ®ç¬¦å·è¡¨ä¿¡æ¯ï¼Œå°†æ¯ä¸ªå‡½æ•°è°ƒç”¨ä½ç½®ä¸­çš„ç¬¦å·æ›¿æ¢æˆå®é™…çš„åœ°å€ã€‚</li>
<li><strong>åº“æ–‡ä»¶é“¾æ¥</strong>ï¼šé“¾æ¥å™¨è¿˜éœ€è¦ä¸ºç¨‹åºé“¾æ¥ä¸åŒçš„åº“æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç³»ç»Ÿåº“å’Œç”¨æˆ·åº“ã€‚è¿™äº›åº“æ–‡ä»¶å¯èƒ½æ˜¯é™æ€åº“æˆ–è€…åŠ¨æ€åº“ã€‚<ul>
<li>å¦‚æœæ˜¯é™æ€åº“ï¼Œé“¾æ¥å™¨ä¼šä»åº“æ–‡ä»¶ä¸­æå–ç›®æ ‡ä»£ç å¹¶å°†å…¶ä¸ç›®æ ‡æ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>å¦‚æœæ˜¯åŠ¨æ€åº“ï¼Œåˆ™éœ€è¦åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½åº“æ–‡ä»¶ï¼Œå¹¶å°†å…¶é“¾æ¥åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ç¬¦å·å’Œç¬¦å·è¡¨"><a href="#ç¬¦å·å’Œç¬¦å·è¡¨" class="headerlink" title="ç¬¦å·å’Œç¬¦å·è¡¨"></a>ç¬¦å·å’Œç¬¦å·è¡¨</h3><p>è§ Linux Executable file: Structure &amp; Running</p>
<h3 id="ç¬¦å·è§£æ"><a href="#ç¬¦å·è§£æ" class="headerlink" title="ç¬¦å·è§£æ"></a>ç¬¦å·è§£æ</h3><ul>
<li>å±€éƒ¨å˜é‡<ul>
<li>ç¼–è¯‘å™¨åªå…è®¸æ¯ä¸ªæ¨¡å—ä¸­æ¯ä¸ªå±€éƒ¨ç¬¦å·æœ‰ä¸€ä¸ªå®šä¹‰ã€‚åŒæ—¶ç¡®ä¿å®ƒä»¬æ‹¥æœ‰å”¯ä¸€çš„åå­—ã€‚</li>
</ul>
</li>
<li>å…¨å±€å˜é‡<ul>
<li>ç¼ºå¤±æƒ…å†µï¼šå½“ç¼–è¯‘å™¨é‡åˆ°ä¸€ä¸ªä¸æ˜¯åœ¨å½“å‰æ¨¡å—ä¸­å®šä¹‰çš„ç¬¦å·ï¼ˆå˜é‡æˆ–å‡½æ•°åï¼‰æ—¶ï¼Œä¼šå‡è®¾è¯¥ç¬¦å·æ˜¯åœ¨å…¶ä»–æŸä¸ªæ¨¡å—ä¸­å®šä¹‰çš„ï¼Œç”Ÿæˆä¸€ä¸ªé“¾æ¥å™¨ç¬¦å·è¡¨æ¡ç›®ï¼Œå¹¶æŠŠå®ƒäº¤ç»™é“¾æ¥å™¨å¤„ç†ã€‚å¦‚æœé“¾æ¥å™¨åœ¨å®ƒçš„ä»»ä½•è¾“å…¥æ¨¡å—ä¸­éƒ½æ‰¾ä¸åˆ°è¿™ä¸ªè¢«å¼•ç”¨ç¬¦å·çš„å®šä¹‰ï¼Œå°±è¾“å‡º<code>undefined reference to</code></li>
<li>åŒåæƒ…å†µï¼šç¼–è¯‘å™¨æŠ¥é”™æˆ–è€…é€‰æ‹©ä¸€ä¸ªï¼Œ<ul>
<li>å‡½æ•°å’Œå·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡æ˜¯å¼ºç¬¦å·ï¼Œ</li>
<li>æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡æ˜¯å¼±ç¬¦å·ã€‚</li>
</ul>
</li>
<li>é€‰æ‹©è§„åˆ™ï¼š<ul>
<li>è§„åˆ™ 1ï¼šä¸å…è®¸æœ‰å¤šä¸ªåŒåçš„å¼ºç¬¦å·ã€‚</li>
<li>è§„åˆ™ 2ï¼šå¦‚æœæœ‰ä¸€ä¸ªå¼ºç¬¦å·å’Œå¤šä¸ªå¼±ç¬¦å·åŒåï¼Œé‚£ä¹ˆé€‰æ‹©å¼ºç¬¦å·ã€‚</li>
<li>è§„åˆ™ 3ï¼šå¦‚æœæœ‰å¤šä¸ªå¼±ç¬¦å·åŒåï¼Œé‚£ä¹ˆä»è¿™äº›å¼±ç¬¦å·ä¸­ä»»æ„é€‰æ‹©ä¸€ä¸ªã€‚</li>
<li>è§„åˆ™ 2 å’Œè§„åˆ™ 3 çš„åº”ç”¨ä¼šé€ æˆä¸€äº›ä¸æ˜“å¯Ÿè§‰çš„è¿è¡Œæ—¶é”™è¯¯ï¼Œå¯¹äºä¸è­¦è§‰çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œæ˜¯å¾ˆéš¾ç†è§£çš„ï¼Œå°¤å…¶æ˜¯å¦‚æœé‡å¤çš„ç¬¦å·å®šä¹‰è¿˜æœ‰ä¸åŒçš„ç±»å‹æ—¶ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="é‡å®šä½"><a href="#é‡å®šä½" class="headerlink" title="é‡å®šä½"></a>é‡å®šä½</h3><p>ä¸€æ—¦é“¾æ¥å™¨å®Œæˆäº†ç¬¦å·è§£æè¿™ä¸€æ­¥ï¼Œå°±æŠŠä»£ç ä¸­çš„æ¯ä¸ªç¬¦å·å¼•ç”¨å’Œæ­£å¥½ä¸€ä¸ªç¬¦å·å®šä¹‰ï¼ˆå³å®ƒçš„ä¸€ä¸ªè¾“å…¥ç›®æ ‡æ¨¡å—ä¸­çš„ä¸€ä¸ªç¬¦å·è¡¨æ¡ç›®ï¼‰å…³è”èµ·æ¥ã€‚æ­¤æ—¶ï¼Œé“¾æ¥å™¨å°±çŸ¥é“å®ƒçš„è¾“å…¥ç›®æ ‡æ¨¡å—ä¸­çš„<strong>ä»£ç èŠ‚å’Œæ•°æ®èŠ‚</strong>çš„ç¡®åˆ‡å¤§å°ã€‚ç°åœ¨å°±å¯ä»¥å¼€å§‹é‡å®šä½æ­¥éª¤äº†ï¼Œåœ¨è¿™ä¸ªæ­¥éª¤ä¸­ï¼Œå°†åˆå¹¶è¾“å…¥æ¨¡å—ï¼Œå¹¶ä¸ºæ¯ä¸ªç¬¦å·åˆ†é…è¿è¡Œæ—¶åœ°å€ã€‚é‡å®šä½ç”±ä¸¤æ­¥ç»„æˆï¼š</p>
<ul>
<li><strong>é‡å®šä½èŠ‚å’Œç¬¦å·å®šä¹‰</strong>ã€‚<ul>
<li>åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œé“¾æ¥å™¨å°†æ‰€æœ‰ç›¸åŒç±»å‹çš„èŠ‚åˆå¹¶ä¸ºåŒä¸€ç±»å‹çš„æ–°çš„èšåˆèŠ‚ã€‚<ul>
<li>ä¾‹å¦‚ï¼Œæ¥è‡ªæ‰€æœ‰è¾“å…¥æ¨¡å—çš„<code>.data</code> èŠ‚è¢«å…¨éƒ¨åˆå¹¶æˆä¸€ä¸ªèŠ‚ï¼Œè¿™ä¸ªèŠ‚æˆä¸ºè¾“å‡ºçš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶çš„<code>.data</code> èŠ‚ã€‚</li>
<li>ç„¶åï¼Œé“¾æ¥å™¨å°†<strong>è¿è¡Œæ—¶å†…å­˜åœ°å€</strong>èµ‹ç»™æ–°çš„èšåˆèŠ‚ï¼Œèµ‹ç»™è¾“å…¥æ¨¡å—å®šä¹‰çš„æ¯ä¸ªèŠ‚ï¼Œä»¥åŠèµ‹ç»™è¾“å…¥æ¨¡å—å®šä¹‰çš„æ¯ä¸ªç¬¦å·ã€‚</li>
<li>å½“è¿™ä¸€æ­¥å®Œæˆæ—¶ï¼Œç¨‹åºä¸­çš„æ¯æ¡æŒ‡ä»¤å’Œå…¨å±€å˜é‡éƒ½æœ‰å”¯ä¸€çš„è¿è¡Œæ—¶å†…å­˜åœ°å€äº†ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨</strong>ã€‚<ul>
<li>åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œé“¾æ¥å™¨ä¿®æ”¹ä»£ç èŠ‚å’Œæ•°æ®èŠ‚ä¸­å¯¹æ¯ä¸ªç¬¦å·çš„å¼•ç”¨ï¼Œä½¿å¾—å®ƒä»¬æŒ‡å‘æ­£ç¡®çš„è¿è¡Œæ—¶åœ°å€ã€‚</li>
<li>è¦æ‰§è¡Œè¿™ä¸€æ­¥ï¼Œé“¾æ¥å™¨ä¾èµ–äºå¯é‡å®šä½ç›®æ ‡æ¨¡å—ä¸­ç§°ä¸ºé‡å®šä½æ¡ç›®ï¼ˆrelocation entryï¼‰çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°†ä¼šæè¿°è¿™ç§æ•°æ®ç»“æ„ã€‚</li>
</ul>
</li>
</ul>
<h4 id="é‡å®šä½æ¡ç›®"><a href="#é‡å®šä½æ¡ç›®" class="headerlink" title="é‡å®šä½æ¡ç›®"></a>é‡å®šä½æ¡ç›®</h4><p>å½“æ±‡ç¼–å™¨ç”Ÿæˆä¸€ä¸ªç›®æ ‡æ¨¡å—æ—¶ï¼Œå®ƒå¹¶ä¸çŸ¥é“æ•°æ®å’Œä»£ç æœ€ç»ˆå°†æ”¾åœ¨å†…å­˜ä¸­çš„ä»€ä¹ˆä½ç½®ã€‚å®ƒä¹Ÿä¸çŸ¥é“è¿™ä¸ªæ¨¡å—å¼•ç”¨çš„ä»»ä½•å¤–éƒ¨å®šä¹‰çš„å‡½æ•°æˆ–è€…å…¨å±€å˜é‡çš„ä½ç½®ã€‚æ‰€ä»¥ï¼Œæ— è®ºä½•æ—¶æ±‡ç¼–å™¨é‡åˆ°å¯¹æœ€ç»ˆä½ç½®æœªçŸ¥çš„ç›®æ ‡å¼•ç”¨ï¼Œå®ƒå°±ä¼šç”Ÿæˆä¸€ä¸ªé‡å®šä½æ¡ç›®ï¼Œå‘Šè¯‰é“¾æ¥å™¨åœ¨å°†ç›®æ ‡æ–‡ä»¶åˆå¹¶æˆå¯æ‰§è¡Œæ–‡ä»¶æ—¶å¦‚ä½•ä¿®æ”¹è¿™ä¸ªå¼•ç”¨ã€‚</p>
<p>ä»£ç çš„é‡å®šä½æ¡ç›®æ”¾åœ¨ <code>.rel.text</code> ä¸­ã€‚å·²åˆå§‹åŒ–æ•°æ®çš„é‡å®šä½æ¡ç›®æ”¾åœ¨ <code>.rel.data</code> ä¸­ã€‚</p>
<p>ä¸‹é¢ å±•ç¤ºäº† ELF é‡å®šä½æ¡ç›®çš„æ ¼å¼ã€‚</p>
<ol>
<li>offset æ˜¯éœ€è¦è¢«ä¿®æ”¹çš„å¼•ç”¨çš„èŠ‚åç§»ã€‚</li>
<li>symbol æ ‡è¯†è¢«ä¿®æ”¹å¼•ç”¨åº”è¯¥æŒ‡å‘çš„ç¬¦å·ã€‚</li>
<li>type å‘ŠçŸ¥é“¾æ¥å™¨å¦‚ä½•ä¿®æ”¹æ–°çš„å¼•ç”¨ã€‚<ol>
<li>ELF å®šä¹‰äº† 32 ç§ä¸åŒçš„é‡å®šä½ç±»å‹ï¼Œæœ‰äº›ç›¸å½“éšç§˜ã€‚æˆ‘ä»¬åªå…³å¿ƒå…¶ä¸­ä¸¤ç§æœ€åŸºæœ¬çš„é‡å®šä½ç±»å‹ï¼š<ol>
<li><code>R_X86_64_PC32</code>ã€‚é‡å®šä½ä¸€ä¸ªä½¿ç”¨ 32 ä½ PC ç›¸å¯¹åœ°å€çš„å¼•ç”¨ã€‚å›æƒ³ä¸€ä¸‹ 3.6.3 èŠ‚ï¼Œä¸€ä¸ª PC ç›¸å¯¹åœ°å€å°±æ˜¯è·ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰çš„å½“å‰è¿è¡Œæ—¶å€¼çš„åç§»é‡ã€‚å½“ CPU æ‰§è¡Œä¸€æ¡ä½¿ç”¨ PC ç›¸å¯¹å¯»å€çš„æŒ‡ä»¤æ—¶ï¼Œå®ƒå°±å°†åœ¨æŒ‡ä»¤ä¸­ç¼–ç çš„ 32 ä½å€¼åŠ ä¸Š PC çš„å½“å‰è¿è¡Œæ—¶å€¼ï¼Œå¾—åˆ°æœ‰æ•ˆåœ°å€ï¼ˆå¦‚ call æŒ‡ä»¤çš„ç›®æ ‡ï¼‰ï¼ŒPC å€¼é€šå¸¸æ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚(å°† PC å‹å…¥æ ˆä¸­æ¥ä½¿ç”¨)</li>
<li><code>R_X86_64_32</code>ã€‚é‡å®šä½ä¸€ä¸ªä½¿ç”¨ 32 ä½ç»å¯¹åœ°å€çš„å¼•ç”¨ã€‚é€šè¿‡ç»å¯¹å¯»å€ï¼ŒCPU ç›´æ¥ä½¿ç”¨åœ¨æŒ‡ä»¤ä¸­ç¼–ç çš„ 32 ä½å€¼ä½œä¸ºæœ‰æ•ˆåœ°å€ï¼Œä¸éœ€è¦è¿›ä¸€æ­¥ä¿®æ”¹ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>addend æ˜¯ä¸€ä¸ªæœ‰ç¬¦å·å¸¸æ•°ï¼Œä¸€äº›ç±»å‹çš„é‡å®šä½è¦ä½¿ç”¨å®ƒå¯¹è¢«ä¿®æ”¹å¼•ç”¨çš„å€¼åšåç§»è°ƒæ•´ã€‚</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="type">long</span> offset;    <span class="comment">/* Offset of the reference to relocate */</span></span><br><span class="line">    <span class="type">long</span> type:<span class="number">32</span>,   <span class="comment">/* Relocation type */</span></span><br><span class="line">         symbol:<span class="number">32</span>; <span class="comment">/* Symbol table index */</span></span><br><span class="line">    <span class="type">long</span> addend;    <span class="comment">/* Constant part of relocation expression */</span></span><br><span class="line">&#125; Elf64_Rela;</span><br></pre></td></tr></table></figure>


<h3 id="ç›®æ ‡æ–‡ä»¶ä¸åº“çš„ä½ç½®"><a href="#ç›®æ ‡æ–‡ä»¶ä¸åº“çš„ä½ç½®" class="headerlink" title="ç›®æ ‡æ–‡ä»¶ä¸åº“çš„ä½ç½®"></a>ç›®æ ‡æ–‡ä»¶ä¸åº“çš„ä½ç½®</h3><p><img src="https://pic.shaojiemike.top/img/20211214150609.png"><br><img src="https://pic.shaojiemike.top/img/20211214150641.png"><br><img src="https://pic.shaojiemike.top/img/20211213234151.png"></p>
<h2 id="4-1-é™æ€é“¾æ¥"><a href="#4-1-é™æ€é“¾æ¥" class="headerlink" title="4.1 é™æ€é“¾æ¥"></a>4.1 é™æ€é“¾æ¥</h2><p><strong>é™æ€åº“static library</strong>å°±æ˜¯å°†ç›¸å…³çš„ç›®æ ‡æ¨¡å—æ‰“åŒ…å½¢æˆçš„å•ç‹¬çš„æ–‡ä»¶ã€‚ä½¿ç”¨arå‘½ä»¤ã€‚</p>
<ul>
<li>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œé™æ€åº“ä»¥ä¸€ç§ç§°ä¸ºå­˜æ¡£(archive)çš„ç‰¹æ®Šæ–‡ä»¶æ ¼å¼å­˜æ”¾åœ¨ç£ç›˜ä¸­ã€‚</li>
<li>å­˜æ¡£æ–‡ä»¶æ˜¯ä¸€ç»„è¿æ¥èµ·æ¥çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶çš„é›†åˆï¼Œæœ‰ä¸€ä¸ªå¤´éƒ¨ç”¨æ¥æè¿°æ¯ä¸ªæˆå‘˜ç›®æ ‡æ–‡ä»¶çš„å¤§å°å’Œä½ç½®ã€‚</li>
<li>å­˜æ¡£æ–‡ä»¶åç”±åç¼€.aæ ‡è¯†ã€‚</li>
</ul>
<h3 id="ä¼˜ç‚¹ä¸é—®é¢˜"><a href="#ä¼˜ç‚¹ä¸é—®é¢˜" class="headerlink" title="ä¼˜ç‚¹ä¸é—®é¢˜"></a>ä¼˜ç‚¹ä¸é—®é¢˜</h3><p>é™æ€åº“çš„ä¼˜ç‚¹åœ¨äºï¼š</p>
<ul>
<li>ç¨‹åºå‘˜ä¸éœ€è¦æ˜¾å¼çš„æŒ‡å®šæ‰€æœ‰éœ€è¦é“¾æ¥çš„ç›®æ ‡æ¨¡å—ï¼Œå› ä¸ºæŒ‡å®šæ˜¯ä¸€ä¸ªè€—æ—¶ä¸”å®¹æ˜“å‡ºé”™çš„è¿‡ç¨‹ï¼›</li>
<li>é“¾æ¥æ—¶ï¼Œè¿æ¥ç¨‹åºåªä»é™æ€åº“ä¸­æ‹·è´è¢«ç¨‹åºå¼•ç”¨çš„ç›®æ ‡æ¨¡å—ï¼Œè¿™æ ·å°±å‡å°äº†å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç£ç›˜å’Œå†…å­˜ä¸­çš„å¤§å°ã€‚</li>
</ul>
<p>é—®é¢˜ï¼š</p>
<ul>
<li>å‡ ä¹æ‰€æœ‰ç¨‹åºéƒ½éœ€è¦printfè¿™æ ·çš„åº“å‡½æ•°ï¼Œæ¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶éƒ½åŒ…å«è¯¥æ¨¡å—çš„ä»£ç æ®µå’Œæ•°æ®æ®µï¼Œæµªè´¹ç£ç›˜ç©ºé—´ã€‚</li>
<li>linuxé‡‡ç”¨è™šæ‹Ÿå†…å­˜ç®¡ç†å†…å­˜åˆ†é…ï¼Œæ¯ä¸ªè¿›ç¨‹çš„å†…å­˜ç©ºé—´æ˜¯ç‹¬ç«‹çš„ï¼Œè¿è¡Œæ—¶æ‰€æœ‰ç¨‹åºéƒ½è¦æŠŠè¿™äº›åº“å‡½æ•°ä»£ç æ®µå’Œæ•°æ®æ®µåŠ è½½åˆ°è‡ªå·±çš„å†…å­˜é‡Œï¼Œæµªè´¹å†…å­˜ã€‚</li>
<li>é™æ€åº“å’Œæ‰€æœ‰çš„è½¯ä»¶ä¸€æ ·ï¼Œéœ€è¦å®šæœŸç»´æŠ¤å’Œæ›´æ–°ã€‚å¦‚æœåº”ç”¨ç¨‹åºå‘˜æƒ³è¦ä½¿ç”¨ä¸€ä¸ªåº“çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä»–ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼äº†è§£åˆ°è¯¥åº“çš„æ›´æ–°æƒ…å†µï¼Œç„¶åæ˜¾å¼åœ°å°†ä»–ä»¬çš„ç¨‹åºä¸æ›´æ–°äº†çš„åº“é‡æ–°é“¾æ¥ã€‚</li>
</ul>
<h3 id="é™æ€é“¾æ¥è¿‡ç¨‹"><a href="#é™æ€é“¾æ¥è¿‡ç¨‹" class="headerlink" title="é™æ€é“¾æ¥è¿‡ç¨‹"></a>é™æ€é“¾æ¥è¿‡ç¨‹</h3><p>æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»ŸP477,é™æ€åº“ä¾‹å­</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -static -o prog2c main2.o -L. -lvector</span><br></pre></td></tr></table></figure>

<p>å›¾ 7-8 æ¦‚æ‹¬äº†é“¾æ¥å™¨çš„è¡Œä¸ºã€‚<code>-static</code> å‚æ•°å‘Šè¯‰ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åºï¼Œé“¾æ¥å™¨åº”è¯¥æ„å»ºä¸€ä¸ªå®Œå…¨é“¾æ¥çš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ï¼Œå®ƒå¯ä»¥åŠ è½½åˆ°å†…å­˜å¹¶è¿è¡Œï¼Œåœ¨åŠ è½½æ—¶æ— é¡»æ›´è¿›ä¸€æ­¥çš„é“¾æ¥ã€‚<code>-lvector</code> å‚æ•°æ˜¯ <code>libvector.a</code> çš„ç¼©å†™ï¼Œ-L. å‚æ•°å‘Šè¯‰é“¾æ¥å™¨åœ¨å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾ libvector.aã€‚</p>
<p><img src="https://1087580735-files.gitbook.io/~/files/v0/b/gitbook-legacy-files/o/assets%2F-MHt_spaxGgCbp2POnfq%2F-MI8p7rbEV-s_nV5Ru6X%2F-MI8pkPoBiVWj0eMXoIA%2F07-08%20%E4%B8%8E%E9%9D%99%E6%80%81%E5%BA%93%E9%93%BE%E6%8E%A5.png?alt=media&token=fcb51f44-d9fc-4e95-8889-4888b9f920ae"></p>
<!-- ![](https://pic.shaojiemike.top/img/20211213233758.png) -->

<ul>
<li>å½“é“¾æ¥å™¨è¿è¡Œæ—¶ï¼Œå®ƒåˆ¤å®š main2.o å¼•ç”¨äº† addvec.o å®šä¹‰çš„ addvec ç¬¦å·ï¼Œæ‰€ä»¥å¤åˆ¶ addvec.o åˆ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>å› ä¸ºç¨‹åºä¸å¼•ç”¨ä»»ä½•ç”± multvec.o å®šä¹‰çš„ç¬¦å·ï¼Œæ‰€ä»¥é“¾æ¥å™¨å°±ä¸ä¼šå¤åˆ¶è¿™ä¸ªæ¨¡å—åˆ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>é“¾æ¥å™¨è¿˜ä¼šå¤åˆ¶ libc.a ä¸­çš„ printf.o æ¨¡å—ï¼Œä»¥åŠè®¸å¤š C è¿è¡Œæ—¶ç³»ç»Ÿä¸­çš„å…¶ä»–æ¨¡å—ã€‚</li>
</ul>
<h2 id="4-2-åŠ¨æ€é“¾æ¥"><a href="#4-2-åŠ¨æ€é“¾æ¥" class="headerlink" title="4.2 åŠ¨æ€é“¾æ¥"></a>4.2 åŠ¨æ€é“¾æ¥</h2><ul>
<li>å…±äº«åº“ï¼ˆshared libraryï¼‰æ˜¯è‡´åŠ›äºè§£å†³é™æ€åº“ç¼ºé™·çš„ä¸€ä¸ªç°ä»£åˆ›æ–°äº§ç‰©ã€‚å…±äº«åº“æ˜¯ä¸€ä¸ªç›®æ ‡æ¨¡å—ï¼Œåœ¨è¿è¡Œæˆ–åŠ è½½æ—¶ï¼Œå¯ä»¥åŠ è½½åˆ°ä»»æ„çš„å†…å­˜åœ°å€ï¼Œå¹¶å’Œä¸€ä¸ªåœ¨å†…å­˜ä¸­çš„ç¨‹åºé“¾æ¥èµ·æ¥ã€‚<ul>
<li>å…±äº«åº“ä¹Ÿç§°ä¸ºå…±äº«ç›®æ ‡ï¼ˆshared objectï¼‰ï¼Œåœ¨ Linux ç³»ç»Ÿä¸­é€šå¸¸ç”¨ .so åç¼€æ¥è¡¨ç¤ºã€‚å¾®è½¯çš„æ“ä½œç³»ç»Ÿå¤§é‡åœ°ä½¿ç”¨äº†å…±äº«åº“ï¼Œå®ƒä»¬ç§°ä¸º DLLï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰ã€‚</li>
</ul>
</li>
<li>è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºåŠ¨æ€é“¾æ¥ï¼ˆdynamic linkingï¼‰ï¼Œæ˜¯ç”±ä¸€ä¸ªå«åšåŠ¨æ€é“¾æ¥å™¨ï¼ˆdynamic linkerï¼‰çš„ç¨‹åºæ¥æ‰§è¡Œçš„ã€‚</li>
</ul>
<p>å…±äº«åº“æ˜¯ä»¥ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥â€œå…±äº«â€çš„ï¼š</p>
<ul>
<li>é¦–å…ˆï¼Œåœ¨ä»»ä½•ç»™å®šçš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¯¹äºä¸€ä¸ªåº“åªæœ‰ä¸€ä¸ª. so æ–‡ä»¶ã€‚æ‰€æœ‰å¼•ç”¨è¯¥åº“çš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶å…±äº«è¿™ä¸ª .so æ–‡ä»¶ä¸­çš„ä»£ç å’Œæ•°æ®ï¼Œè€Œä¸æ˜¯åƒé™æ€åº“çš„å†…å®¹é‚£æ ·è¢«å¤åˆ¶å’ŒåµŒå…¥åˆ°å¼•ç”¨å®ƒä»¬çš„å¯æ‰§è¡Œçš„æ–‡ä»¶ä¸­ã€‚</li>
<li>å…¶æ¬¡ï¼Œåœ¨å†…å­˜ä¸­ï¼Œä¸€ä¸ªå…±äº«åº“çš„ .text èŠ‚çš„ä¸€ä¸ªå‰¯æœ¬å¯ä»¥è¢«ä¸åŒçš„æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å…±äº«</li>
</ul>
<p><img src="https://1087580735-files.gitbook.io/~/files/v0/b/gitbook-legacy-files/o/assets%2F-MHt_spaxGgCbp2POnfq%2F-MI8qpMNa8rVv2h1gw56%2F-MI8r4myxZNQCTrFzKsH%2F07-16%20%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%85%B1%E4%BA%AB%E5%BA%93.png?alt=media&token=0901e781-87bf-4e4f-b1f9-31ca05c51f7c" alt="ld-link"></p>
<!-- ![](https://pic.shaojiemike.top/img/20220106154610.png)
![](https://pic.shaojiemike.top/img/20220106154641.png)
![](https://pic.shaojiemike.top/img/20220106154652.png) -->
<!-- ![](https://pic.shaojiemike.top/img/20220106161412.png) -->

<p>å¦‚ä¸Šåˆ›å»ºäº†ä¸€ä¸ªå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ prog2lï¼Œè€Œæ­¤æ–‡ä»¶çš„å½¢å¼ä½¿å¾—å®ƒåœ¨è¿è¡Œæ—¶å¯ä»¥å’Œ libvector.so é“¾æ¥ã€‚åŸºæœ¬çš„æ€è·¯æ˜¯ï¼š</p>
<ul>
<li>å½“åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œé™æ€æ‰§è¡Œä¸€äº›é“¾æ¥<ul>
<li>æ­¤æ—¶ï¼Œæ²¡æœ‰ä»»ä½• libvector.so çš„ä»£ç å’Œæ•°æ®èŠ‚çœŸçš„è¢«å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶ prog2l ä¸­ã€‚åä¹‹ï¼Œé“¾æ¥å™¨å¤åˆ¶äº†ä¸€äº›é‡å®šä½å’Œç¬¦å·è¡¨ä¿¡æ¯ï¼Œå®ƒä»¬ä½¿å¾—è¿è¡Œæ—¶å¯ä»¥è§£æå¯¹ libvector.so ä¸­ä»£ç å’Œæ•°æ®çš„å¼•ç”¨ã€‚</li>
</ul>
</li>
<li>ç„¶ååœ¨ç¨‹åºåŠ è½½æ—¶ï¼ŒåŠ¨æ€å®Œæˆé“¾æ¥è¿‡ç¨‹ã€‚<ul>
<li>åŠ¨æ€é“¾æ¥å¯ä»¥åœ¨å¯æ‰§è¡Œæ–‡ä»¶ç¬¬ä¸€æ¬¡åŠ è½½å’Œè¿è¡Œæ—¶å‘ç”Ÿï¼ˆåŠ è½½æ—¶é“¾æ¥ï¼‰<ul>
<li>Common case for Linux,handled automatically by the dynamic linker (ld-linux.so).</li>
<li>Standard C library (libc.so)usually dynamically linked.</li>
</ul>
</li>
<li>åŠ¨æ€é“¾æ¥ä¹Ÿå¯ä»¥åœ¨ç¨‹åºå¼€å§‹è¿è¡Œåå‘ç”Ÿï¼ˆè¿è¡Œæ—¶é“¾æ¥ï¼‰.<ul>
<li>In Linux,this is done by calls to the <code>dlopen()</code> <a target="_blank" rel="noopener" href="https://hansimov.gitbook.io/csapp/part2/ch07-linking/7.11-loading-and-linking-shared-libraries-from-applications">interface.</a><ul>
<li>Distributing software.</li>
<li>High-performance web servers.</li>
<li>Runtime library interpositioning.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="åŠ è½½æƒ…å†µä¸€"><a href="#åŠ è½½æƒ…å†µä¸€" class="headerlink" title="åŠ è½½æƒ…å†µä¸€"></a>åŠ è½½æƒ…å†µä¸€</h3><p>æƒ…å†µï¼šåœ¨åº”ç”¨ç¨‹åºè¢«åŠ è½½åæ‰§è¡Œå‰æ—¶ï¼ŒåŠ¨æ€é“¾æ¥å™¨åŠ è½½å’Œé“¾æ¥å…±äº«åº“çš„æƒ…æ™¯ã€‚</p>
<p>æ ¸å¿ƒæ€æƒ³ï¼šç”±åŠ¨æ€é“¾æ¥å™¨æ¥ç®¡ï¼ŒåŠ è½½ç®¡ç†å’Œå…³é—­å…±äº«åº“ï¼ˆæ¯”å¦‚ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å…±äº«åº“è¿˜åœ¨ä½¿ç”¨è¿™ä¸ªå…±äº«åº“ï¼Œdlcloseå‡½æ•°å°±å¸è½½è¯¥å…±äº«åº“ã€‚ï¼‰ã€‚</p>
<ol>
<li>é¦–å…ˆï¼ŒåŠ è½½éƒ¨åˆ†é“¾æ¥çš„å¯æ‰§è¡Œæ–‡ä»¶ prog2lã€‚</li>
<li>prog2l åŒ…å«ä¸€ä¸ª <code>.interp</code> èŠ‚ï¼Œè¿™ä¸€èŠ‚åŒ…å«åŠ¨æ€é“¾æ¥å™¨çš„è·¯å¾„åï¼ŒåŠ¨æ€é“¾æ¥å™¨æœ¬èº«å°±æ˜¯ä¸€ä¸ªå…±äº«ç›®æ ‡ï¼ˆå¦‚åœ¨ Linux ç³»ç»Ÿä¸Šçš„ ld-linux.soï¼‰. åŠ è½½å™¨ä¸ä¼šåƒå®ƒé€šå¸¸æ‰€åšåœ°é‚£æ ·å°†æ§åˆ¶ä¼ é€’ç»™åº”ç”¨ï¼Œè€Œæ˜¯åŠ è½½å’Œè¿è¡Œè¿™ä¸ªåŠ¨æ€é“¾æ¥å™¨ã€‚ç„¶åï¼ŒåŠ¨æ€é“¾æ¥å™¨é€šè¿‡æ‰§è¡Œä¸‹é¢çš„é‡å®šä½å®Œæˆé“¾æ¥ä»»åŠ¡ï¼š<ol>
<li>é‡å®šä½ libc.so çš„æ–‡æœ¬å’Œæ•°æ®åˆ°æŸä¸ªå†…å­˜æ®µã€‚</li>
<li>é‡å®šä½ libvector.so çš„æ–‡æœ¬å’Œæ•°æ®åˆ°å¦ä¸€ä¸ªå†…å­˜æ®µã€‚</li>
<li>é‡å®šä½ prog2l ä¸­æ‰€æœ‰å¯¹ç”± libc.so å’Œ libvector.so å®šä¹‰çš„ç¬¦å·çš„å¼•ç”¨ã€‚</li>
</ol>
</li>
</ol>
<p>æœ€åï¼ŒåŠ¨æ€é“¾æ¥å™¨å°†æ§åˆ¶ä¼ é€’ç»™åº”ç”¨ç¨‹åºã€‚ä»è¿™ä¸ªæ—¶åˆ»å¼€å§‹ï¼Œå…±äº«åº“çš„ä½ç½®å°±å›ºå®šäº†ï¼Œå¹¶ä¸”åœ¨ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­éƒ½ä¸ä¼šæ”¹å˜ã€‚</p>
<h3 id="åŠ è½½æƒ…å†µäºŒ"><a href="#åŠ è½½æƒ…å†µäºŒ" class="headerlink" title="åŠ è½½æƒ…å†µäºŒ"></a>åŠ è½½æƒ…å†µäºŒ</h3><p>æƒ…å†µï¼šåº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶è¦æ±‚åŠ¨æ€é“¾æ¥å™¨åŠ è½½å’Œé“¾æ¥æŸä¸ªå…±äº«åº“ï¼Œè€Œæ— éœ€åœ¨ç¼–è¯‘æ—¶å°†é‚£äº›åº“é“¾æ¥åˆ°åº”ç”¨ã€‚</p>
<p>å®é™…åº”ç”¨æƒ…å†µï¼š</p>
<ul>
<li>åˆ†å‘è½¯ä»¶ã€‚å¾®è½¯ Wmdows åº”ç”¨çš„å¼€å‘è€…å¸¸å¸¸åˆ©ç”¨å…±äº«åº“æ¥åˆ†å‘è½¯ä»¶æ›´æ–°ã€‚ä»–ä»¬ç”Ÿæˆä¸€ä¸ªå…±åº“çš„æ–°ç‰ˆæœ¬ï¼Œç„¶åç”¨æˆ·å¯ä»¥ä¸‹è½½ï¼Œå¹¶ç”¨å®ƒæ›¿ä»£å½“å‰çš„ç‰ˆæœ¬ã€‚ä¸‹ä¸€æ¬¡ä»–ä»¬è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ï¼Œåº”ç”¨å°†è‡ªåŠ¨é“¾æ¥å’ŒåŠ è½½æ–°çš„å…±äº«åº“ã€‚</li>
<li>æ„å»ºé«˜æ€§èƒ½ Web æœåŠ¡å™¨ã€‚<ul>
<li>è®¸å¤š Web æœåŠ¡å™¨ç”ŸæˆåŠ¨æ€å†…å®¹ï¼Œæ¯”å¦‚ä¸ªæ€§åŒ–çš„ Web é¡µé¢ã€è´¦æˆ·ä½™é¢å’Œå¹¿å‘Šæ ‡è¯­</li>
<li>æ—©æœŸçš„ Web æœåŠ¡å™¨é€šè¿‡ä½¿ç”¨ fork å’Œ execve åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¹¶åœ¨è¯¥å­è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œ CGI ç¨‹åºæ¥ç”ŸæˆåŠ¨æ€å†…å®¹ã€‚</li>
<li>ç„¶è€Œï¼Œç°ä»£é«˜æ€§èƒ½çš„ Web æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨åŸºäºåŠ¨æ€é“¾æ¥çš„æ›´æœ‰æ•ˆå’Œå®Œå–„çš„æ–¹æ³•æ¥ç”ŸæˆåŠ¨æ€å†…å®¹ã€‚</li>
</ul>
</li>
</ul>
<p>æ€è·¯æ˜¯å°†æ¯ä¸ªç”ŸæˆåŠ¨æ€å†…å®¹çš„å‡½æ•°æ‰“åŒ…åœ¨å…±äº«åº“ä¸­ã€‚</p>
<ol>
<li>å½“ä¸€ä¸ªæ¥è‡ª Web æµè§ˆå™¨çš„è¯·æ±‚åˆ°è¾¾æ—¶ï¼ŒæœåŠ¡å™¨åŠ¨æ€åœ°åŠ è½½å’Œé“¾æ¥é€‚å½“çš„å‡½æ•°ï¼Œç„¶åç›´æ¥è°ƒç”¨å®ƒï¼Œè€Œä¸æ˜¯ä½¿ç”¨ fork å’Œ execve åœ¨å­è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œå‡½æ•°ã€‚</li>
<li>å‡½æ•°ä¼šä¸€ç›´ç¼“å­˜åœ¨æœåŠ¡å™¨çš„åœ°å€ç©ºé—´ä¸­ï¼Œæ‰€ä»¥åªè¦ä¸€ä¸ªç®€å•çš„å‡½æ•°è°ƒç”¨çš„å¼€é”€å°±å¯ä»¥å¤„ç†éšåçš„è¯·æ±‚äº†ã€‚è¿™å¯¹ä¸€ä¸ªç¹å¿™çš„ç½‘ç«™æ¥è¯´æ˜¯æœ‰å¾ˆå¤§å½±å“çš„ã€‚æ›´è¿›ä¸€æ­¥åœ°è¯´ï¼Œåœ¨è¿è¡Œæ—¶æ— éœ€åœæ­¢æœåŠ¡å™¨ï¼Œå°±å¯ä»¥æ›´æ–°å·²å­˜åœ¨çš„å‡½æ•°ï¼Œä»¥åŠæ·»åŠ æ–°çš„å‡½æ•°ã€‚</li>
</ol>
<h3 id="åŠ¨æ€åº“çš„ä¼˜ç‚¹"><a href="#åŠ¨æ€åº“çš„ä¼˜ç‚¹" class="headerlink" title="åŠ¨æ€åº“çš„ä¼˜ç‚¹"></a>åŠ¨æ€åº“çš„ä¼˜ç‚¹</h3><ul>
<li>æ›´æ–°åŠ¨æ€åº“ï¼Œæ— éœ€é‡æ–°é“¾æ¥ï¼›å¯¹äºå¤§ç³»ç»Ÿï¼Œé‡æ–°é“¾æ¥æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„è¿‡ç¨‹ï¼›</li>
<li>è¿è¡Œä¸­å¯ä¾›å¤šä¸ªç¨‹åºä½¿ç”¨ï¼Œå†…å­˜ä¸­åªéœ€è¦æœ‰ä¸€ä»½ï¼ŒèŠ‚çœå†…å­˜ã€‚è¿è¡Œæ—¶ä¸€ä¸ªå…±äº«åº“çš„ä»£ç æ®µå’Œæ•°æ®æ®µåœ¨ç‰©ç†å†…å­˜ä¸­åªæœ‰ä¸€ä»½ï¼Œä½†æ˜ å°„åˆ°å¤šä¸ªè™šæ‹Ÿå†…å­˜ç‰‡æ®µä¸Šï¼Œä¾›ä¸åŒç¨‹åºä½¿ç”¨ã€‚å…¶ä¸­ä»£ç æ®µæ˜¯åªè¯»çš„ï¼Œæ•´ä¸ªæ“ä½œç³»ç»Ÿç»å¯¹åªæœ‰ä¸€ä»½ã€‚ä½†æ•°æ®æ®µæœ‰å¯èƒ½è¢«ä¿®æ”¹ï¼Œåœ¨ä¿®æ”¹çš„æ—¶å€™åˆ™ä¼šå¤åˆ¶ä¸€ä¸ªå‰¯æœ¬ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„ä¸€ä¸ªå†…å­˜å‰¯æœ¬ã€‚</li>
<li>å…±äº«åº“æ˜¯.soæ–‡ä»¶ï¼Œä¸ä¼šå’Œæˆ‘ä»¬è‡ªå·±çš„ä»£ç ä¸€èµ·åˆå¹¶æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸å ç£ç›˜ç©ºé—´ã€‚</li>
</ul>
<h2 id="åŠ¨æ€é“¾æ¥"><a href="#åŠ¨æ€é“¾æ¥" class="headerlink" title="åŠ¨æ€é“¾æ¥"></a>åŠ¨æ€é“¾æ¥</h2><h2 id="fPICï¼ŒfPIE"><a href="#fPICï¼ŒfPIE" class="headerlink" title="fPICï¼ŒfPIE"></a>fPICï¼ŒfPIE</h2><p>ç¼–è¯‘å™¨<code>yasm</code>çš„å‚æ•°<code>-DPIE</code></p>
<p>å¦‚æœåŒä¸€ä»½ä»£ç å¯èƒ½è¢«åŠ è½½åˆ°è¿›ç¨‹ç©ºé—´çš„ä»»æ„è™šæ‹Ÿåœ°å€ä¸Šæ‰§è¡Œ(å¦‚å…±äº«åº“å’ŒåŠ¨æ€åŠ è½½ä»£ç ),é‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨-fPICç”Ÿæˆä½ç½®æ— å…³ä»£ç ã€‚</p>
<h3 id="å¦‚ä½•å®ç°åŠ¨æ€é“¾æ¥"><a href="#å¦‚ä½•å®ç°åŠ¨æ€é“¾æ¥" class="headerlink" title="å¦‚ä½•å®ç°åŠ¨æ€é“¾æ¥"></a>å¦‚ä½•å®ç°åŠ¨æ€é“¾æ¥</h3><ol>
<li>å…±äº«åº“æ˜¯.soæ–‡ä»¶ï¼Œä¸ä¼šå’Œæˆ‘ä»¬è‡ªå·±çš„ä»£ç ä¸€èµ·åˆå¹¶æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸å ç£ç›˜ç©ºé—´ã€‚</li>
<li>è¿è¡Œæ—¶ä¸€ä¸ªå…±äº«åº“çš„ä»£ç æ®µå’Œæ•°æ®æ®µåœ¨ç‰©ç†å†…å­˜ä¸­åªæœ‰ä¸€ä»½ï¼Œä½†æ˜ å°„åˆ°å¤šä¸ªè™šæ‹Ÿå†…å­˜ç‰‡æ®µä¸Šï¼Œä¾›ä¸åŒç¨‹åºä½¿ç”¨ã€‚<ol>
<li>å…¶ä¸­ä»£ç æ®µæ˜¯åªè¯»çš„ï¼Œæ•´ä¸ªæ“ä½œç³»ç»Ÿç»å¯¹åªæœ‰ä¸€ä»½ã€‚</li>
<li>ä½†æ•°æ®æ®µæœ‰å¯èƒ½è¢«ä¿®æ”¹ï¼Œåœ¨ä¿®æ”¹çš„æ—¶å€™åˆ™ä¼šå¤åˆ¶ä¸€ä¸ªå‰¯æœ¬ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„ä¸€ä¸ªå†…å­˜å‰¯æœ¬ã€‚</li>
</ol>
</li>
<li>å…±äº«åº“çš„ä»£ç æ®µå’Œæ•°æ®æ®µåŠ è½½åˆ°ä»»æ„çš„å†…å­˜æ®µä¸­ï¼Œä½ç½®ä¸å›ºå®šã€‚</li>
<li>åŠ è½½å®Œæˆåï¼Œè¿›è¡Œç¬¦å·é‡å®šä½ã€‚å›æƒ³ä¸€ä¸‹ä¹‹å‰è¯´è¿‡çš„é‡å®šä½è¿‡ç¨‹ï¼Œéœ€è¦ä¿®æ”¹æ‰€æœ‰ç¬¦å·å¼•ç”¨çš„åœ°å€ã€‚<ol>
<li>ç”±äºåŠ¨æ€é“¾æ¥åœ¨è¿è¡Œæ—¶æ‰ç¡®å®šå…±äº«åº“ä»£ç æ®µå’Œæ•°æ®æ®µçš„å†…å­˜åœ°å€ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶æ‰èƒ½è¿›è¡Œé‡å®šä½ã€‚</li>
<li>è¿è¡Œæ—¶ä¿®æ”¹ä»£ç ï¼Œæƒ³æƒ³å°±è§‰å¾—ä¸ä¼˜é›…ã€‚è€Œä¸”Linuxä¸å…è®¸åœ¨è¿è¡Œæ—¶ä¿®æ”¹ä»£ç æ®µã€‚</li>
</ol>
</li>
<li>ç”±æ­¤ï¼Œè¦å®ŒæˆåŠ¨æ€é“¾æ¥ï¼Œè¿˜éœ€è¦å¼•å…¥äº†æœ€åä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œä½ç½®æ— å…³ä»£ç ï¼Œå³åœ¨åŠ è½½æ—¶æ— éœ€é‡å®šä½çš„ä»£ç ã€‚</li>
</ol>
<h2 id="ä½ç½®æ— å…³ä»£ç ï¼ˆPosition-Independent-Code-PICï¼‰"><a href="#ä½ç½®æ— å…³ä»£ç ï¼ˆPosition-Independent-Code-PICï¼‰" class="headerlink" title="ä½ç½®æ— å…³ä»£ç ï¼ˆPosition-Independent Code, PICï¼‰"></a>ä½ç½®æ— å…³ä»£ç ï¼ˆPosition-Independent Code, PICï¼‰</h2><ul>
<li><p>é—®é¢˜ï¼šå¤šä¸ªè¿›ç¨‹æ˜¯å¦‚ä½•å…±äº«ç¨‹åºçš„ä¸€ä¸ªå‰¯æœ¬çš„å‘¢ï¼Ÿ</p>
<ul>
<li>ä¸€ç§æ–¹æ³•æ˜¯ç»™æ¯ä¸ªå…±äº«åº“åˆ†é…ä¸€ä¸ªäº‹å…ˆé¢„å¤‡çš„ä¸“ç”¨çš„(è™šæ‹Ÿ)åœ°å€ç©ºé—´ç‰‡ï¼Œç„¶åè¦æ±‚åŠ è½½å™¨æ€»æ˜¯åœ¨è¿™ä¸ªåœ°å€åŠ è½½å…±äº«åº“ã€‚</li>
<li>é—®é¢˜ã€‚<ul>
<li>åœ°å€ç©ºé—´çš„ä½¿ç”¨æ•ˆç‡ä¸é«˜ï¼Œå› ä¸ºå³ä½¿ä¸€ä¸ªè¿›ç¨‹ä¸ä½¿ç”¨è¿™ä¸ªåº“ï¼Œé‚£éƒ¨åˆ†ç©ºé—´è¿˜æ˜¯ä¼šè¢«åˆ†é…å‡ºæ¥ã€‚</li>
<li>éš¾ä»¥ç®¡ç†ã€‚æˆ‘ä»¬å¿…é¡»ä¿è¯æ²¡æœ‰ç‰‡ä¼šé‡å ã€‚<ul>
<li>åº“ä¿®æ”¹äº†ä¹‹åï¼Œæˆ‘ä»¬å¿…é¡»ç¡®è®¤å·²åˆ†é…ç»™å®ƒçš„ç‰‡è¿˜é€‚åˆå®ƒçš„å¤§å°ã€‚å¦‚æœä¸é€‚åˆäº†ï¼Œå¿…é¡»æ‰¾ä¸€ä¸ªæ–°çš„ç‰‡ã€‚</li>
<li>åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åº“ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»ä¸ºå®ƒå¯»æ‰¾ç©ºé—´ã€‚éšç€æ—¶é—´çš„è¿›å±•ï¼Œå‡è®¾åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­æœ‰äº†æˆç™¾ä¸ªåº“å’Œåº“çš„å„ä¸ªç‰ˆæœ¬åº“ï¼Œå°±å¾ˆéš¾é¿å…åœ°å€ç©ºé—´åˆ†è£‚æˆå¤§é‡å°çš„ã€æœªä½¿ç”¨è€Œåˆä¸å†èƒ½ä½¿ç”¨çš„å°æ´ã€‚</li>
<li>æ›´ç³Ÿçš„æ˜¯ï¼Œå¯¹æ¯ä¸ªç³»ç»Ÿè€Œè¨€ï¼Œåº“åœ¨å†…å­˜ä¸­çš„åˆ†é…éƒ½æ˜¯ä¸åŒçš„ï¼Œè¿™å°±å¼•èµ·äº†æ›´å¤šä»¤äººå¤´ç—›çš„ç®¡ç†é—®é¢˜ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>å¯ä»¥åŠ è½½è€Œæ— éœ€é‡å®šä½çš„ä»£ç ç§°ä¸ºä½ç½®æ— å…³ä»£ç ï¼ˆPosition-Independent Codeï¼ŒPICï¼‰</p>
<ul>
<li>æ— é™å¤šä¸ªè¿›ç¨‹å¯ä»¥å…±äº«ä¸€ä¸ªå…±äº«æ¨¡å—çš„ä»£ç æ®µçš„å•ä¸€å‰¯æœ¬ã€‚ï¼ˆå½“ç„¶ï¼Œæ¯ä¸ªè¿›ç¨‹ä»ç„¶ä¼šæœ‰å®ƒè‡ªå·±çš„è¯»&#x2F;å†™æ•°æ®å—ã€‚ï¼‰</li>
</ul>
</li>
<li><p>åœ¨ä¸€ä¸ª x86-64 ç³»ç»Ÿä¸­ï¼Œå¯¹åŒä¸€ä¸ªç›®æ ‡æ¨¡å—ä¸­<strong>ç¬¦å·çš„å¼•ç”¨</strong>æ˜¯ä¸éœ€è¦ç‰¹æ®Šå¤„ç†ä½¿ä¹‹æˆä¸º PICã€‚å¯ä»¥ç”¨ PC ç›¸å¯¹å¯»å€æ¥ç¼–è¯‘è¿™äº›å¼•ç”¨ï¼Œæ„é€ ç›®æ ‡æ–‡ä»¶æ—¶ç”±é™æ€é“¾æ¥å™¨é‡å®šä½ã€‚</p>
</li>
<li><p>ç„¶è€Œï¼Œå¯¹å…±äº«æ¨¡å—å®šä¹‰çš„<strong>å¤–éƒ¨è¿‡ç¨‹</strong>å’Œå¯¹<strong>å…¨å±€å˜é‡çš„å¼•ç”¨</strong>éœ€è¦ä¸€äº›ç‰¹æ®Šçš„æŠ€å·§ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šè°ˆåˆ°ã€‚</p>
</li>
</ul>
<h3 id="PIC-æ•°æ®å¼•ç”¨"><a href="#PIC-æ•°æ®å¼•ç”¨" class="headerlink" title="PIC æ•°æ®å¼•ç”¨"></a>PIC æ•°æ®å¼•ç”¨</h3><ul>
<li>ç›®æ ‡ï¼šç”Ÿæˆå¯¹å…¨å±€å˜é‡çš„ PIC å¼•ç”¨</li>
<li>æ€æƒ³ï¼šæ— è®ºæˆ‘ä»¬åœ¨å†…å­˜ä¸­çš„ä½•å¤„åŠ è½½ä¸€ä¸ªç›®æ ‡æ¨¡å—ï¼ˆåŒ…æ‹¬å…±äº«ç›®æ ‡æ¨¡å—ï¼‰ï¼Œæ•°æ®æ®µä¸ä»£ç æ®µçš„è·ç¦»æ€»æ˜¯ä¿æŒä¸å˜ã€‚å› æ­¤ï¼Œä»£ç æ®µä¸­ä»»ä½•æŒ‡ä»¤å’Œæ•°æ®æ®µä¸­ä»»ä½•å˜é‡ä¹‹é—´çš„è·ç¦»éƒ½æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶å¸¸é‡ï¼Œä¸ä»£ç æ®µå’Œæ•°æ®æ®µçš„ç»å¯¹å†…å­˜ä½ç½®æ˜¯æ— å…³çš„ã€‚ç”±äºæ•°æ®æ®µæ˜¯å¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹çš„ï¼Œæ‰€ä»¥å¯ä»¥æŠŠå¯¹ä»£ç æ®µçš„ä¿®æ”¹è½¬åŒ–ä¸ºå¯¹æ•°æ®æ®µçš„ä¿®æ”¹ã€‚</li>
<li>å®ç°ï¼šåœ¨æ•°æ®æ®µå‰é¢åŠ å…¥ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œå…¨å±€åç§»é‡è¡¨ï¼ˆGlobal Offset Tableï¼ŒGOTï¼‰ã€‚æ¯ä¸€ä¸ªè¢«è¯¥æ¨¡å—å¼•ç”¨çš„å…¨å±€æ•°æ®ç›®æ ‡ï¼ˆè¿‡ç¨‹æˆ–å…¨å±€å˜é‡ï¼‰ï¼Œéƒ½åœ¨GOTé‡Œæœ‰ä¸€ä¸ª8å­—èŠ‚æ¡ç›®ï¼Œå¹¶ä¸ºæ¯ä¸ªæ¡ç›®ç”Ÿæˆä¸€ä¸ªé‡å®šä½æ¡ç›®ã€‚</li>
<li>å®é™…ä½¿ç”¨ï¼šåœ¨åŠ è½½æ—¶ï¼ŒåŠ¨æ€é“¾æ¥å™¨ä¼šé‡å®šä½ GOT ä¸­çš„æ¯ä¸ªæ¡ç›®ï¼Œä½¿å¾—å®ƒåŒ…å«ç›®æ ‡çš„æ­£ç¡®çš„ç»å¯¹åœ°å€ã€‚ç„¶åç¨‹åºæ‰§è¡Œæ—¶å°±èƒ½æ­£ç¡®è®¿é—®æ­£ç¡®çš„ç»å¯¹åœ°å€äº†ã€‚</li>
</ul>
<h3 id="PIC-å‡½æ•°è°ƒç”¨"><a href="#PIC-å‡½æ•°è°ƒç”¨" class="headerlink" title="PIC å‡½æ•°è°ƒç”¨"></a>PIC å‡½æ•°è°ƒç”¨</h3><ul>
<li>æƒ…å†µï¼šå‡è®¾ç¨‹åºè°ƒç”¨ä¸€ä¸ªç”±å…±äº«åº“å®šä¹‰çš„å‡½æ•°ã€‚ç¼–è¯‘å™¨æ²¡æœ‰åŠæ³•é¢„æµ‹è¿™ä¸ªå‡½æ•°çš„è¿è¡Œæ—¶åœ°å€ï¼Œå› ä¸ºå®šä¹‰å®ƒçš„å…±äº«æ¨¡å—åœ¨è¿è¡Œæ—¶å¯ä»¥åŠ è½½åˆ°ä»»æ„ä½ç½®ã€‚</li>
<li>ç®€å•æ–¹æ³•ï¼šä¸ºè¯¥å¼•ç”¨ç”Ÿæˆä¸€æ¡é‡å®šä½è®°å½•ï¼Œç„¶ååŠ¨æ€é“¾æ¥å™¨åœ¨ç¨‹åºåŠ è½½çš„æ—¶å€™å†è§£æå®ƒã€‚ä¸è¿‡ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸æ˜¯ PICï¼Œå› ä¸ºå®ƒéœ€è¦é“¾æ¥å™¨ä¿®æ”¹è°ƒç”¨æ¨¡å—çš„ä»£ç æ®µã€‚</li>
</ul>
<p>è§£å†³æ–¹æ³•ï¼šå»¶è¿Ÿç»‘å®šï¼ˆlazy bindingï¼‰ï¼Œå°†è¿‡ç¨‹åœ°å€çš„ç»‘å®šæ¨è¿Ÿåˆ°ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥è¿‡ç¨‹æ—¶ã€‚</p>
<p>åŠ¨æœºï¼šä½¿ç”¨å»¶è¿Ÿç»‘å®šçš„åŠ¨æœºæ˜¯å¯¹äºä¸€ä¸ªåƒ libc.so è¿™æ ·çš„å…±äº«åº“è¾“å‡ºçš„æˆç™¾ä¸Šåƒä¸ªå‡½æ•°ä¸­ï¼Œä¸€ä¸ªå…¸å‹çš„åº”ç”¨ç¨‹åºåªä¼šä½¿ç”¨å…¶ä¸­å¾ˆå°‘çš„ä¸€éƒ¨åˆ†ã€‚æŠŠå‡½æ•°åœ°å€çš„è§£ææ¨è¿Ÿåˆ°å®ƒå®é™…è¢«è°ƒç”¨çš„åœ°æ–¹ï¼Œèƒ½é¿å…åŠ¨æ€é“¾æ¥å™¨åœ¨åŠ è½½æ—¶è¿›è¡Œæˆç™¾ä¸Šåƒä¸ªå…¶å®å¹¶ä¸éœ€è¦çš„é‡å®šä½ã€‚</p>
<p>ç»“æœï¼šç¬¬ä¸€æ¬¡è°ƒç”¨è¿‡ç¨‹çš„è¿è¡Œæ—¶å¼€é”€å¾ˆå¤§ï¼Œä½†æ˜¯å…¶åçš„æ¯æ¬¡è°ƒç”¨éƒ½åªä¼šèŠ±è´¹ä¸€æ¡æŒ‡ä»¤å’Œä¸€ä¸ªé—´æ¥çš„å†…å­˜å¼•ç”¨ã€‚</p>
<p>å®ç°ï¼šå»¶è¿Ÿç»‘å®šæ˜¯é€šè¿‡ä¸¤ä¸ªæ•°æ®ç»“æ„ä¹‹é—´ç®€æ´ä½†åˆæœ‰äº›å¤æ‚çš„äº¤äº’æ¥å®ç°çš„ï¼Œè¿™ä¸¤ä¸ªæ•°æ®ç»“æ„æ˜¯ï¼šGOT å’Œè¿‡ç¨‹é“¾æ¥è¡¨ï¼ˆProcedure Linkage Tableï¼ŒPLTï¼‰ã€‚å¦‚æœä¸€ä¸ªç›®æ ‡æ¨¡å—è°ƒç”¨å®šä¹‰åœ¨å…±äº«åº“ä¸­çš„ä»»ä½•å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒå°±æœ‰è‡ªå·±çš„ GOT å’Œ PLTã€‚GOT æ˜¯æ•°æ®æ®µçš„ä¸€éƒ¨åˆ†ï¼Œè€Œ PLT æ˜¯ä»£ç æ®µçš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»‹ç»è¿™ä¸¤ä¸ªè¡¨çš„å†…å®¹ã€‚</p>
<ul>
<li>è¿‡ç¨‹é“¾æ¥è¡¨ï¼ˆPLTï¼‰ã€‚PLT æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªæ¡ç›®æ˜¯ 16 å­—èŠ‚ä»£ç ã€‚<ul>
<li><code>PLT[0]</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šæ¡ç›®ï¼Œå®ƒè·³è½¬åˆ°åŠ¨æ€é“¾æ¥å™¨ä¸­ã€‚</li>
<li>æ¯ä¸ªè¢«å¯æ‰§è¡Œç¨‹åºè°ƒç”¨çš„åº“å‡½æ•°éƒ½æœ‰å®ƒè‡ªå·±çš„ PLT æ¡ç›®ã€‚æ¯ä¸ªæ¡ç›®éƒ½è´Ÿè´£è°ƒç”¨ä¸€ä¸ªå…·ä½“çš„å‡½æ•°ã€‚</li>
<li><code>PLT[1]</code>ï¼ˆå›¾ä¸­æœªæ˜¾ç¤ºï¼‰è°ƒç”¨ç³»ç»Ÿå¯åŠ¨å‡½æ•°ï¼ˆ<code>__libc_start_main</code>ï¼‰ï¼Œå®ƒåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒï¼Œè°ƒç”¨ main å‡½æ•°å¹¶å¤„ç†å…¶è¿”å›å€¼ä» PLT[2] å¼€å§‹çš„æ¡ç›®è°ƒç”¨ç”¨æˆ·ä»£ç è°ƒç”¨çš„å‡½æ•°ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ŒPLT[2] è°ƒç”¨ addvecï¼ŒPLT[3]ï¼ˆå›¾ä¸­æœªæ˜¾ç¤ºï¼‰è°ƒç”¨ printfã€‚</li>
</ul>
</li>
<li>å…¨å±€åç§»é‡è¡¨ï¼ˆGOTï¼‰ã€‚æ­£å¦‚æˆ‘ä»¬çœ‹åˆ°çš„ï¼ŒGOT æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªæ¡ç›®æ˜¯ 8 å­—èŠ‚åœ°å€ã€‚<ul>
<li>å’Œ PLT è”åˆä½¿ç”¨æ—¶ï¼ŒGOT[O] å’Œ GOT[1] åŒ…å«åŠ¨æ€é“¾æ¥å™¨åœ¨è§£æå‡½æ•°åœ°å€æ—¶ä¼šä½¿ç”¨çš„ä¿¡æ¯ã€‚GOT[2] æ˜¯åŠ¨æ€é“¾æ¥å™¨åœ¨ ld-linux.so æ¨¡å—ä¸­çš„å…¥å£ç‚¹ã€‚</li>
<li>å…¶ä½™çš„æ¯ä¸ªæ¡ç›®å¯¹åº”äºä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œå…¶åœ°å€éœ€è¦åœ¨è¿è¡Œæ—¶è¢«è§£æã€‚æ¯ä¸ªæ¡ç›®éƒ½æœ‰ä¸€ä¸ªç›¸åŒ¹é…çš„ PLT æ¡ç›®ã€‚ä¾‹å¦‚ï¼ŒGOT[4] å’Œ PLT[2] å¯¹åº”äº addvecã€‚åˆå§‹æ—¶ï¼Œæ¯ä¸ª GOT æ¡ç›®éƒ½æŒ‡å‘å¯¹åº” PLT æ¡ç›®çš„ç¬¬äºŒæ¡æŒ‡ä»¤ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://1087580735-files.gitbook.io/~/files/v0/b/gitbook-legacy-files/o/assets%2F-MHt_spaxGgCbp2POnfq%2F-MI8rhjF1mF76R_jsq8k%2F-MI8rvz0lzamUy-llAv6%2F07-19%20%E7%94%A8PLT%E5%92%8CGOT%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0.png?alt=media&token=df2fe32e-88f9-4bfd-b4ed-9de49f30fe2a" alt="PLT"></p>
<p>ä¸Šå›¾a å±•ç¤ºäº† GOT å’Œ PLT å¦‚ä½•ååŒå·¥ä½œï¼Œåœ¨ addvec è¢«ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œå»¶è¿Ÿè§£æå®ƒçš„è¿è¡Œæ—¶åœ°å€ï¼š</p>
<ol>
<li>ç¬¬ 1 æ­¥ã€‚ä¸ç›´æ¥è°ƒç”¨ addvecï¼Œç¨‹åºè°ƒç”¨è¿›å…¥ PLT[2]ï¼Œè¿™æ˜¯ addvec çš„ PLT æ¡ç›®ã€‚</li>
<li>ç¬¬ 2 æ­¥ã€‚ç¬¬ä¸€æ¡ PLT æŒ‡ä»¤é€šè¿‡ GOT[4] è¿›è¡Œé—´æ¥è·³è½¬ã€‚å› ä¸ºæ¯ä¸ª GOT æ¡ç›®åˆå§‹æ—¶éƒ½æŒ‡å‘å®ƒå¯¹åº”çš„ PLT æ¡ç›®çš„ç¬¬äºŒæ¡æŒ‡ä»¤ï¼Œè¿™ä¸ªé—´æ¥è·³è½¬åªæ˜¯ç®€å•åœ°æŠŠæ§åˆ¶ä¼ é€å› PLT[2] ä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</li>
<li>ç¬¬ 3 æ­¥ã€‚åœ¨æŠŠ addvec çš„ IDï¼ˆ0x1ï¼‰å‹å…¥æ ˆä¸­ä¹‹åï¼ŒPLT[2] è·³è½¬åˆ° PLT[0]ã€‚</li>
<li>ç¬¬ 4 æ­¥ã€‚PLT[0] é€šè¿‡ GOT[1] é—´æ¥åœ°æŠŠåŠ¨æ€é“¾æ¥å™¨çš„ä¸€ä¸ªå‚æ•°å‹å…¥æ ˆä¸­ï¼Œç„¶åé€šè¿‡ GOT[2] é—´æ¥è·³è½¬è¿›åŠ¨æ€é“¾æ¥å™¨ä¸­ã€‚åŠ¨æ€é“¾æ¥å™¨ä½¿ç”¨ä¸¤ä¸ªæ ˆæ¡ç›®æ¥ç¡®å®š addvec çš„è¿è¡Œæ—¶ä½ç½®ï¼Œç”¨è¿™ä¸ªåœ°å€é‡å†™ GOT[4]ï¼Œå†æŠŠæ§åˆ¶ä¼ é€’ç»™ addvecã€‚</li>
</ol>
<p>ä¸Šå›¾b ç»™å‡ºçš„æ˜¯åç»­å†è°ƒç”¨ addvec æ—¶çš„æ§åˆ¶æµï¼š</p>
<ol>
<li>ç¬¬ 1 æ­¥ã€‚å’Œå‰é¢ä¸€æ ·ï¼Œæ§åˆ¶ä¼ é€’åˆ° PLT[2]ã€‚</li>
<li>ç¬¬ 2 æ­¥ã€‚ä¸è¿‡è¿™æ¬¡é€šè¿‡ GOT[4] çš„é—´æ¥è·³è½¬ä¼šå°†æ§åˆ¶ç›´æ¥è½¬ç§»åˆ° addvecã€‚</li>
</ol>
<h4 id="åº“æœç´¢ä¼˜å…ˆçº§"><a href="#åº“æœç´¢ä¼˜å…ˆçº§" class="headerlink" title="åº“æœç´¢ä¼˜å…ˆçº§"></a>åº“æœç´¢ä¼˜å…ˆçº§</h4><p>é™æ€åº“</p>
<ol>
<li>gccå…ˆä»-Lå¯»æ‰¾ï¼›</li>
<li>å†æ‰¾ç¯å¢ƒå˜é‡LIBRARY_PATHæŒ‡å®šçš„æœç´¢è·¯å¾„ï¼›</li>
<li>å†æ‰¾å†…å®šç›®å½• &#x2F;lib &#x2F;usr&#x2F;lib &#x2F;usr&#x2F;local&#x2F;lib è¿™æ˜¯å½“åˆcompile gccæ—¶å†™åœ¨ç¨‹åºå†…çš„ã€‚</li>
</ol>
<p>åŠ¨æ€åº“</p>
<ol>
<li>ç¼–è¯‘ç›®æ ‡ä»£ç æ—¶æŒ‡å®šçš„åŠ¨æ€åº“æœç´¢è·¯å¾„-Lï¼›</li>
<li>ç¯å¢ƒå˜é‡LD_LIBRARY_PATHæŒ‡å®šçš„åŠ¨æ€åº“æœç´¢è·¯å¾„ï¼›</li>
<li>é…ç½®æ–‡ä»¶&#x2F;etc&#x2F;ld.so.confä¸­æŒ‡å®šçš„åŠ¨æ€åº“æœç´¢è·¯å¾„ï¼›</li>
<li>é»˜è®¤çš„åŠ¨æ€åº“æœç´¢è·¯å¾„&#x2F;lib &#x2F;usr&#x2F;lib&#x2F; &#x2F;usr&#x2F;local&#x2F;lib</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">shaojiemike@snode6 /lib/modules/5.4.0-107-generic/build  [06:32:26]</span><br><span class="line">&gt; gcc -print-search-dirs</span><br><span class="line">install: /usr/lib/gcc/x86_64-linux-gnu/9/</span><br><span class="line">programs: =/usr/lib/gcc/x86_64-linux-gnu/9/:/usr/lib/gcc/x86_64-linux-gnu/9/:/usr/lib/gcc/x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/9/:/usr/lib/gcc/x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../../x86_64-linux-gnu/bin/x86_64-linux-gnu/9/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../../x86_64-linux-gnu/bin/x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../../x86_64-linux-gnu/bin/</span><br><span class="line">libraries: =/usr/lib/gcc/x86_64-linux-gnu/9/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../../x86_64-linux-gnu/lib/x86_64-linux-gnu/9/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../../x86_64-linux-gnu/lib/x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../../x86_64-linux-gnu/lib/../lib/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../x86_64-linux-gnu/9/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../../lib/:/lib/x86_64-linux-gnu/9/:/lib/x86_64-linux-gnu/:/lib/../lib/:/usr/lib/x86_64-linux-gnu/9/:/usr/lib/x86_64-linux-gnu/:/usr/lib/../lib/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../../x86_64-linux-gnu/lib/:/usr/lib/gcc/x86_64-linux-gnu/9/../../../:/lib/:/usr/lib/</span><br></pre></td></tr></table></figure>

<h2 id="5-åŠ è½½å™¨"><a href="#5-åŠ è½½å™¨" class="headerlink" title="5. åŠ è½½å™¨"></a>5. åŠ è½½å™¨</h2><p>åŠ è½½å™¨ï¼šå°†å¯æ‰§è¡Œç¨‹åºåŠ è½½åˆ°å†…å­˜å¹¶è¿›è¡Œæ‰§è¡Œï¼Œloaderå’Œld-linux.soã€‚</p>
<p>å°†å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½è¿è¡Œ</p>
<h2 id="å…¶ä»–æŠ€å·§ï¼šGNUç”¨äºç†è§£å’Œå¤„ç†ç›®æ ‡æ–‡ä»¶çš„ç›¸å…³å‘½ä»¤"><a href="#å…¶ä»–æŠ€å·§ï¼šGNUç”¨äºç†è§£å’Œå¤„ç†ç›®æ ‡æ–‡ä»¶çš„ç›¸å…³å‘½ä»¤" class="headerlink" title="å…¶ä»–æŠ€å·§ï¼šGNUç”¨äºç†è§£å’Œå¤„ç†ç›®æ ‡æ–‡ä»¶çš„ç›¸å…³å‘½ä»¤"></a>å…¶ä»–æŠ€å·§ï¼šGNUç”¨äºç†è§£å’Œå¤„ç†ç›®æ ‡æ–‡ä»¶çš„ç›¸å…³å‘½ä»¤</h2><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>ar</td>
<td>åˆ›å»ºé™æ€åº“ï¼Œæ’å…¥ã€åˆ é™¤ã€åˆ—å‡ºå’Œæå–æˆå‘˜ï¼›</td>
</tr>
<tr>
<td>stringd</td>
<td>åˆ—å‡ºç›®æ ‡æ–‡ä»¶ä¸­æ‰€æœ‰å¯ä»¥æ‰“å°çš„å­—ç¬¦ä¸²ï¼›</td>
</tr>
<tr>
<td>strip</td>
<td>ä»ç›®æ ‡æ–‡ä»¶ä¸­åˆ é™¤ç¬¦å·è¡¨ä¿¡æ¯ï¼›</td>
</tr>
<tr>
<td><strong>nm</strong></td>
<td>åˆ—å‡ºç›®æ ‡æ–‡ä»¶ç¬¦å·è¡¨ä¸­å®šä¹‰çš„ç¬¦å·ï¼›</td>
</tr>
<tr>
<td>size</td>
<td>åˆ—å‡ºç›®æ ‡æ–‡ä»¶ä¸­èŠ‚çš„åå­—å’Œå¤§å°ï¼›</td>
</tr>
<tr>
<td><strong>readelf</strong></td>
<td>æ˜¾ç¤ºä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„å®Œæ•´ç»“æ„ï¼ŒåŒ…æ‹¬ELF å¤´ä¸­ç¼–ç çš„æ‰€æœ‰ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td>objdump</td>
<td>æ˜¾ç¤ºç›®æ ‡æ–‡ä»¶çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæœ€æœ‰ç”¨çš„åŠŸèƒ½æ˜¯åæ±‡ç¼–.textèŠ‚ä¸­çš„äºŒè¿›åˆ¶æŒ‡ä»¤ã€‚</td>
</tr>
<tr>
<td><strong>ldd</strong></td>
<td>åˆ—å‡ºå¯æ‰§è¡Œæ–‡ä»¶åœ¨è¿è¡Œæ—¶éœ€è¦çš„å…±äº«åº“ã€‚</td>
</tr>
</tbody></table>
<h2 id="åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹è°ƒç”¨å‘½ä»¤"><a href="#åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹è°ƒç”¨å‘½ä»¤" class="headerlink" title="åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹è°ƒç”¨å‘½ä»¤"></a>åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹è°ƒç”¨å‘½ä»¤</h2><p>ltrace è·Ÿè¸ªè¿›ç¨‹è°ƒç”¨åº“å‡½æ•°è¿‡ç¨‹<br>strace ç³»ç»Ÿè°ƒç”¨çš„è¿½è¸ªæˆ–ä¿¡å·äº§ç”Ÿçš„æƒ…å†µ<br>Relyze å›¾å½¢åŒ–æ”¶è´¹è¯•ç”¨</p>
<h2 id="debugging-symbols"><a href="#debugging-symbols" class="headerlink" title="debugging symbols"></a>debugging symbols</h2><ul>
<li>ç¼–è¯‘æ—¶åŠ å…¥<code>-g</code>é€‰é¡¹ï¼Œå¯ä»¥ç”Ÿæˆè°ƒè¯•ä¿¡æ¯ï¼Œè¿™æ ·åœ¨gdbä¸­å¯ä»¥æŸ¥çœ‹æºä»£ç ã€‚</li>
<li>ä½†æ˜¯åœ¨å¤æ‚çš„ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œæœ€åå¯æ‰§è¡Œæ–‡ä»¶ä¸¢å¤±äº†debugging symbolsï¼Œæ‰€ä»¥ç ”ç©¶ä¸€ä¸‹æ€ä¹ˆç”Ÿæˆdebugging symbolsï¼Œ ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¼ é€’ï¼Œä»¥åŠå¦‚ä½•æŸ¥çœ‹ã€‚</li>
</ul>
<h3 id="debugging-symbolsçš„å†…å®¹"><a href="#debugging-symbolsçš„å†…å®¹" class="headerlink" title="debugging symbolsçš„å†…å®¹"></a>debugging symbolsçš„å†…å®¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">objdump -g &lt;archive_file&gt;.a</span><br><span class="line"><span class="comment"># å¦‚æœ.oæ–‡ä»¶æœ‰debugging symbolsï¼Œä¼šè¾“å‡ºå„sectionè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">Contents of the .debug_aranges section (loaded from predict-c.o):</span><br><span class="line"><span class="comment"># æ²¡æœ‰åˆ™å¦‚ä¸‹</span></span><br><span class="line">cabac-a.o:     file format elf64-x86-64</span><br><span class="line"></span><br><span class="line">dct-a.o:     file format elf64-x86-64</span><br><span class="line"></span><br><span class="line">deblock-a.o:     file format elf64-x86-64</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ç”Ÿæˆdebugging-symbols"><a href="#ç”Ÿæˆdebugging-symbols" class="headerlink" title="ç”Ÿæˆdebugging symbols"></a>ç”Ÿæˆdebugging symbols</h3><ul>
<li>é¢„å¤„ç†è¿‡ç¨‹<ul>
<li>åº”è¯¥ä¼šä¿ç•™debugging symbolsæ‰€éœ€çš„ä¿¡æ¯ï¼Œåœ¨å®éªŒåå‘ç°ï¼Œæ‰§è¡Œ<code>gcc -E -g testBigExe.cpp -o testDebug.i</code>ç›¸å¯¹äºæ— <code>-g</code>çš„å‘½ä»¤ï¼Œåªä¼šå¤šä¸€è¡Œä¿¡æ¯<code># 1 &quot;/staff/shaojiemike/test/OS//&quot;</code></li>
</ul>
</li>
<li>ç¼–è¯‘è¿‡ç¨‹<ul>
<li>æ‰§è¡Œ<code>gcc -S -g testBigExe.cpp -o testDebug.s</code>ï¼Œå¯¹æ¯”ä¹‹å‰çš„æ±‡ç¼–æ–‡ä»¶ï¼Œç”±72è¡Œå˜æˆ9760è¡Œã€‚å…·ä½“è§£æå‚è€ƒ GNU assembly fileä¸€æ–‡</li>
<li><img src="https://pic.shaojiemike.top/img/20230521195333.png" alt="-gå‰å"></li>
</ul>
</li>
<li>æ±‡ç¼–è¿‡ç¨‹ï¼šä¿ç•™äº†debugä¿¡æ¯çš„æ±‡ç¼–ä»£ç ç”Ÿæˆå¸¦debugä¿¡æ¯çš„ç›®æ ‡æ–‡ä»¶<br><img src="https://pic.shaojiemike.top/img/20230521201900.png"></li>
<li>é“¾æ¥(Linker)</li>
</ul>
<h2 id="ç¼–è¯‘ä»£ç ä¸­OpenMPå®ç°"><a href="#ç¼–è¯‘ä»£ç ä¸­OpenMPå®ç°" class="headerlink" title="ç¼–è¯‘ä»£ç ä¸­OpenMPå®ç°"></a>ç¼–è¯‘ä»£ç ä¸­OpenMPå®ç°</h2><p>ç®€å•çš„<code>#pragma omp for</code>ï¼Œç¼–è¯‘åå¤šå‡ºæ±‡ç¼–ä»£ç å¦‚ä¸‹ã€‚å½“å‰å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹é»˜è®¤æ±‡ç¼–å¹¶æ²¡æœ‰æ˜¾ç¤ºçš„æ±‡ç¼–æŒ‡ä»¤ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">call omp_get_num_threads@PLT</span><br><span class="line">movl %eax, %ebx</span><br><span class="line">call omp_get_thread_num@PLT</span><br><span class="line">movl %eax, %ecx</span><br><span class="line"></span><br><span class="line">call	GOMP_barrier@PLT</span><br></pre></td></tr></table></figure>

<p>æŸäº›atomicçš„å¯¼è¯­ä¼šå˜æˆ<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12366806/assembly-instruction-to-replace-openmp-critical-region">å¯¹åº”æ±‡ç¼–</a></p>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><ul>
<li>chatGPTè¯´ï¼šåç«¯é˜¶æ®µï¼ˆä¾‹å¦‚æ±‡ç¼–å™¨å’Œè¿æ¥å™¨ï¼‰ï¼Œåˆ™ä¸»è¦æ˜¯å¯¹æ±‡ç¼–ä»£ç å’Œç›®æ ‡ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œä¾‹å¦‚æŒ‡ä»¤è°ƒåº¦ã€åœ°å€è®¡ç®—ã€ä»£ç ç¼©å‡ç­‰ã€‚ä½†æ˜¯æˆ‘æŒä¸¥é‡æ€€ç–‘æ€åº¦, é“¾æ¥è¿‡ç¨‹æœ‰è¿™ä¹ˆå¤šä¼˜åŒ–å—ï¼Ÿ</li>
</ul>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><p>åŸºç¡€ä¸ç‰¢ï¼Œåœ°åŠ¨å±±æ‘‡ã€‚ya äº†ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LiuYanYGZ/p/5574601.html">https://www.cnblogs.com/LiuYanYGZ/p/5574601.html</a></p>
<p><a target="_blank" rel="noopener" href="https://hansimov.gitbook.io/csapp/part2/ch07-linking/7.5-symbols-and-symbol-tables">https://hansimov.gitbook.io/csapp/part2/ch07-linking/7.5-symbols-and-symbol-tables</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-10T16:00:00.000Z" title="10/10/2023, 4:00:00 PM">2023-10-10</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-08-23T07:40:35.261Z" title="8/23/2024, 7:40:35 AM">2024-08-23</time></span><span class="level-item"><a class="link-muted" href="/categories/Tutorials/">Tutorials</a></span><span class="level-item">3 minutes read (About 408 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/10/Work/Programming/3-options/gccCompilerPreprocessorOption/">GCC Compiler Option 2 : Preprocessor Options</a></p><div class="content"><h2 id="Mxxx"><a href="#Mxxx" class="headerlink" title="-Mxxx"></a>-Mxxx</h2><ul>
<li><code>-M</code> option is designed for auto-generate <strong>Makefile rules</strong> from g++ command.</li>
<li>é»˜è®¤åŒ…å«<code>-E</code> option to STOP after preprocessor during the compilation</li>
<li>é»˜è®¤åŒ…å«<code>-w</code> option to DISABLE&#x2F;suppress all warnings.</li>
</ul>
<p>Using a complex g++ command as an example:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ -Wall -Werror -Wno-unknown-pragmas -DPIN_CRT=1 -fno-stack-protector -fno-exceptions -funwind-tables -fasynchronous-unwind-tables -fno-rtti -DTARGET_IA32E -DHOST_IA32E -fPIC -DTARGET_LINUX -fabi-version=2 -faligned-new -I../../../source/include/pin -I../../../source/include/pin/gen -isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/cxx/include -isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/crt/include -isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/crt/include/arch-x86_64 -isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/crt/include/kernel/uapi -isystem /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/crt/include/kernel/uapi/asm-x86 -I../../../extras/components/include -I../../../extras/xed-intel64/include/xed -I../../../source/tools/Utils -I../../../source/tools/InstLib -O3 -fomit-frame-pointer -fno-strict-aliasing -Wno-dangling-pointer </span><br><span class="line">-M inscount0.cpp -o Makefile_bk</span><br></pre></td></tr></table></figure>

<p>In <code>Makefile_bk</code></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">inscount0.o: inscount0.cpp \</span></span><br><span class="line"> <span class="comment"># sys header</span></span><br><span class="line"> /usr/<span class="keyword">include</span>/stdc-predef.h \</span><br><span class="line"> /staff/shaojiemike/Download/pin-3.28-98749-g6643ecee5-gcc-linux/extras/cxx/<span class="keyword">include</span>/iostream \</span><br><span class="line"> /usr/lib/gcc/x86_64-linux-gnu/11/<span class="keyword">include</span>/float.h</span><br><span class="line"> <span class="comment"># usr header</span></span><br><span class="line"> ../../../source/<span class="keyword">include</span>/pin/pin.H \</span><br><span class="line"> ../../../extras/xed-intel64/<span class="keyword">include</span>/xed/xed-interface.h \</span><br><span class="line"> ... more header files</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-MM</code> not include sys header file<ul>
<li>e.g., the first 3 header will be disapear.</li>
</ul>
</li>
<li><code>-MF filename</code> config the Makefile rules write to which file instead of to stdout.</li>
<li><code>-M -MG</code> is designed to generate Makefile rules when there is header file <strong>missing</strong>, treated it as generated in normal.</li>
<li><code>-M -MP</code> will generated M-rules for dependency between header files<ul>
<li>e.g., <code>header1.h</code> includes <code>header2.h</code>. So <code>header1.h: header2.h</code> in Makefile</li>
</ul>
</li>
<li><code>-MD</code> &#x3D;&#x3D; <code>-M -MF file</code> without default option <code>-E</code><ul>
<li>the default <code>file</code> has a suffix of <code>.d</code>, e.g., <code>inscount0.d</code> for <code>-c inscount0.cpp</code></li>
</ul>
</li>
<li><code>-MMD</code> &#x3D;&#x3D; <code>-MD</code> not include sys header file</li>
</ul>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p>ä¸Šé¢å›ç­”éƒ¨åˆ†<strong>æ¥è‡ªChatGPT-3.5</strong>ï¼Œæ²¡æœ‰è¿›è¡Œæ­£ç¡®æ€§çš„äº¤å‰æ ¡éªŒã€‚</p>
<div id='refer-anchor'></div>

<p>æ— </p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-08-15T12:35:22.000Z" title="8/15/2022, 12:35:22 PM">2022-08-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-08-23T07:40:35.249Z" title="8/23/2024, 7:40:35 AM">2024-08-23</time></span><span class="level-item"><a class="link-muted" href="/categories/Architecture/">Architecture</a></span><span class="level-item">17 minutes read (About 2592 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/08/15/Work/Programming/2.1-Assembly/assemblyInline/">Inline Assembly</a></p><div class="content"><h2 id="GCCå†…è”æ±‡ç¼–"><a href="#GCCå†…è”æ±‡ç¼–" class="headerlink" title="GCCå†…è”æ±‡ç¼–"></a>GCCå†…è”æ±‡ç¼–</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__asm__ã€€__volatile__(&quot;Instruction List&quot; : Output : Input : Clobber/Modify);</span><br></pre></td></tr></table></figure>

<ol>
<li><code>__asm__</code>æˆ–asm ç”¨æ¥å£°æ˜ä¸€ä¸ªå†…è”æ±‡ç¼–è¡¨è¾¾å¼ï¼Œæ‰€ä»¥ä»»ä½•ä¸€ä¸ªå†…è”æ±‡ç¼–è¡¨è¾¾å¼éƒ½æ˜¯ä»¥å®ƒå¼€å¤´çš„ï¼Œæ˜¯å¿…ä¸å¯å°‘çš„ã€‚</li>
<li><code>__volatile__</code>æˆ–volatile æ˜¯å¯é€‰çš„ã€‚å¦‚æœç”¨äº†å®ƒï¼Œåˆ™æ˜¯å‘GCC å£°æ˜ä¸å…è®¸å¯¹è¯¥å†…è”æ±‡ç¼–ä¼˜åŒ–ï¼Œå¦åˆ™å½“ ä½¿ç”¨äº†ä¼˜åŒ–é€‰é¡¹(-O)è¿›è¡Œç¼–è¯‘æ—¶ï¼ŒGCC å°†ä¼šæ ¹æ®è‡ªå·±çš„åˆ¤æ–­å†³å®šæ˜¯å¦å°†è¿™ä¸ªå†…è”æ±‡ç¼–è¡¨è¾¾å¼ä¸­çš„æŒ‡ä»¤ä¼˜åŒ–æ‰ã€‚</li>
<li>Instruction List æ˜¯æ±‡ç¼–æŒ‡ä»¤åºåˆ—ã€‚å®ƒå¯ä»¥æ˜¯ç©ºçš„ï¼Œæ¯”å¦‚ï¼š<code>__asm__ __volatile__(&quot;&quot;)</code>; æˆ– <code>__asm__ (&quot;&quot;)</code>;éƒ½æ˜¯å®Œå…¨åˆæ³•çš„å†…è”æ±‡ç¼–è¡¨è¾¾å¼ï¼Œåªä¸è¿‡è¿™ä¸¤æ¡è¯­å¥æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚<ol>
<li>ä½†å¹¶éæ‰€æœ‰Instruction List ä¸ºç©ºçš„å†…è”æ±‡ç¼–è¡¨è¾¾å¼éƒ½æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæ¯”å¦‚ï¼š<code>__asm__ (&quot;&quot;:::&quot;memory&quot;)</code>;å°±éå¸¸æœ‰æ„ä¹‰ï¼Œå®ƒå‘GCC å£°æ˜ï¼šâ€œå†…å­˜ä½œäº†æ”¹åŠ¨â€ï¼ŒGCC åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šå°†æ­¤å› ç´ è€ƒè™‘è¿›å»ã€‚</li>
<li>å½“åœ¨â€Instruction Listâ€ä¸­æœ‰å¤šæ¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œéœ€è¦ç”¨åˆ†å·ï¼ˆï¼›ï¼‰æˆ–æ¢è¡Œç¬¦ï¼ˆ\nï¼‰å°†å®ƒä»¬åˆ†å¼€ã€‚</li>
<li>æŒ‡ä»¤ä¸­çš„æ“ä½œæ•°å¯ä»¥ä½¿ç”¨å ä½ç¬¦å¼•ç”¨Cè¯­è¨€å˜é‡,<strong>æ“ä½œæ•°å ä½ç¬¦</strong>æœ€å¤š10ä¸ª,åç§°å¦‚ä¸‹:<code>%0,%1,â€¦,%9</code>ã€‚æŒ‡ä»¤ä¸­ä½¿ç”¨å ä½ç¬¦è¡¨ç¤ºçš„æ“ä½œæ•°,æ€»è¢«è§†ä¸ºlongå‹(4ä¸ªå­—èŠ‚),<ol>
<li>ä½†å¯¹å…¶æ–½åŠ çš„æ“ä½œæ ¹æ®æŒ‡ä»¤å¯ä»¥æ˜¯å­—æˆ–è€…å­—èŠ‚,å½“æŠŠæ“ä½œæ•°å½“ä½œå­—æˆ–è€…å­—èŠ‚ä½¿ç”¨æ—¶,<strong>é»˜è®¤ä¸ºä½å­—æˆ–è€…ä½å­—èŠ‚</strong>ã€‚</li>
<li>å¯¹å­—èŠ‚æ“ä½œå¯ä»¥æ˜¾å¼çš„<strong>æŒ‡æ˜æ˜¯ä½å­—èŠ‚è¿˜æ˜¯æ¬¡å­—èŠ‚</strong>ã€‚æ–¹æ³•æ˜¯åœ¨%å’Œåºå·ä¹‹é—´æ’å…¥ä¸€ä¸ªå­—æ¯,â€bâ€ä»£è¡¨ä½å­—èŠ‚,â€hâ€ä»£è¡¨é«˜å­—èŠ‚,ä¾‹å¦‚:<code>%h1</code>ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>Output&#x2F;Input <ol>
<li>æ ¼å¼ä¸ºå½¢å¦‚<code>&quot;constraint&quot;(variable)</code>çš„åˆ—è¡¨ï¼ˆé€—å·åˆ†éš”)ã€‚æŒ‰ç…§å‡ºç°çš„é¡ºåºåˆ†åˆ«ä¸æŒ‡ä»¤æ“ä½œæ•°â€%0â€ï¼Œâ€%1â€å¯¹åº”</li>
<li>æ¯ä¸ªè¾“å‡ºæ“ä½œæ•°çš„é™å®šå­—ç¬¦ä¸²å¿…é¡»åŒ…å«â€&#x3D;â€è¡¨ç¤ºä»–æ˜¯ä¸€ä¸ªè¾“å‡ºæ“ä½œæ•°ã€‚ä¾‹å­<code>&quot;=r&quot; (value)</code></li>
</ol>
</li>
<li>Clobber&#x2F;Modify(ç”±é€—å·æ ¼å¼€çš„å­—ç¬¦ä¸²ç»„æˆ)<ol>
<li>åœ¨Input&#x2F;Outputæ“ä½œè¡¨è¾¾å¼æ‰€æŒ‡å®šçš„å¯„å­˜å™¨ï¼Œæˆ–å½“ä½ ä¸ºä¸€äº›Input&#x2F;Outputæ“ä½œè¡¨è¾¾å¼ä½¿ç”¨â€râ€çº¦æŸï¼Œè®©GCCä¸ºä½ é€‰æ‹©ä¸€ä¸ªå¯„å­˜å™¨æ—¶ï¼ŒGCCçŸ¥é“è¿™äº›å¯„å­˜å™¨æ˜¯è¢«ä¿®æ”¹çš„ï¼Œä½ æ ¹æœ¬ä¸éœ€è¦åœ¨Clobber&#x2F;ModifyåŸŸå†å£°æ˜å®ƒä»¬ã€‚</li>
<li>ä½†æ˜¯å¯¹äºâ€Instruction Listâ€ä¸­çš„ä¸´æ—¶å¯„å­˜å™¨ï¼Œéœ€è¦åœ¨Clobber&#x2F;ModifyåŸŸå£°æ˜è¿™äº›å¯„å­˜å™¨æˆ–å†…å­˜ï¼Œè®©GCCçŸ¥é“ä¿®æ”¹äº†ä»–ä»¬<ol>
<li>ä¾‹å­:<code>__asm__ (&quot;mov R0, #0x34&quot; : : : &quot;R0&quot;);</code>å¯„å­˜å™¨R0å‡ºç°åœ¨â€Instruction Listä¸­â€ï¼Œå¹¶ä¸”è¢«movæŒ‡ä»¤ä¿®æ”¹ï¼Œä½†å´æœªè¢«ä»»ä½•Input&#x2F;Outputæ“ä½œè¡¨è¾¾å¼æŒ‡å®šï¼Œæ‰€ä»¥ä½ éœ€è¦åœ¨Clobber&#x2F;ModifyåŸŸæŒ‡å®šâ€R0â€ï¼Œä»¥è®©GCCçŸ¥é“è¿™ä¸€ç‚¹ã€‚</li>
</ol>
</li>
<li>Clobber&#x2F;ModifyåŸŸå­˜åœ¨â€memoryâ€ï¼Œé‚£ä¹ˆGCCä¼šä¿è¯åœ¨æ­¤å†…è”æ±‡ç¼–ä¹‹å‰ï¼Œå¦‚æœæŸä¸ªå†…å­˜çš„å†…å®¹è¢«è£…å…¥äº†å¯„å­˜å™¨ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªå†…è”æ±‡ç¼–ä¹‹åï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¿™ä¸ªå†…å­˜å¤„çš„å†…å®¹ï¼Œå°±ä¼š<strong>ç›´æ¥åˆ°è¿™ä¸ªå†…å­˜å¤„é‡æ–°è¯»å–ï¼Œè€Œä¸æ˜¯ä½¿ç”¨è¢«å­˜æ”¾åœ¨å¯„å­˜å™¨ä¸­çš„æ‹·è´</strong>ã€‚å› ä¸ºè¿™ä¸ª æ—¶å€™å¯„å­˜å™¨ä¸­çš„æ‹·è´å·²ç»å¾ˆå¯èƒ½å’Œå†…å­˜å¤„çš„å†…å®¹ä¸ä¸€è‡´äº†ã€‚</li>
</ol>
</li>
</ol>
<h2 id="è¾“å…¥è¾“å‡ºä¸æŒ‡ä»¤çš„å¯¹åº”å…³ç³»"><a href="#è¾“å…¥è¾“å‡ºä¸æŒ‡ä»¤çš„å¯¹åº”å…³ç³»" class="headerlink" title="è¾“å…¥è¾“å‡ºä¸æŒ‡ä»¤çš„å¯¹åº”å…³ç³»"></a>è¾“å…¥è¾“å‡ºä¸æŒ‡ä»¤çš„å¯¹åº”å…³ç³»</h2><h3 id="å¯„å­˜å™¨çº¦æŸç¬¦Operation-Constraint"><a href="#å¯„å­˜å™¨çº¦æŸç¬¦Operation-Constraint" class="headerlink" title="å¯„å­˜å™¨çº¦æŸç¬¦Operation Constraint"></a>å¯„å­˜å™¨çº¦æŸç¬¦Operation Constraint</h3><p>æ¯ä¸€ä¸ªInputå’ŒOutputè¡¨è¾¾å¼éƒ½å¿…é¡»æŒ‡å®šè‡ªå·±çš„æ“ä½œçº¦æŸOperation Constraintï¼Œè¿™é‡Œå°†è®¨è®ºåœ¨80386å¹³å°ä¸Šæ‰€å¯èƒ½ä½¿ç”¨çš„æ“ä½œçº¦æŸã€‚</p>
<p>å½“å‰çš„è¾“å…¥æˆ–è¾“å‡ºéœ€è¦å€ŸåŠ©ä¸€ä¸ªå¯„å­˜å™¨æ—¶ï¼Œéœ€è¦ä¸ºå…¶æŒ‡å®šä¸€ä¸ªå¯„å­˜å™¨çº¦æŸï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šä¸€ä¸ªå¯„å­˜å™¨çš„åå­—ã€‚</p>
<p>å¸¸ç”¨çš„å¯„å­˜å™¨çº¦æŸçš„ç¼©å†™ </p>
<table>
<thead>
<tr>
<th>çº¦æŸ</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>r</td>
<td>è¡¨ç¤ºä½¿ç”¨ä¸€ä¸ªé€šç”¨å¯„å­˜å™¨ï¼Œç”± GCC  åœ¨%eax&#x2F;%ax&#x2F;%al,%ebx&#x2F;%bx&#x2F;%bl,%ecx&#x2F;%cx&#x2F;%cl,%edx&#x2F;%dx&#x2F;%dlä¸­é€‰å–ä¸€ä¸ªGCCè®¤ä¸ºåˆé€‚çš„ã€‚</td>
</tr>
<tr>
<td>g</td>
<td>è¡¨ç¤ºä½¿ç”¨ä»»æ„ä¸€ä¸ªå¯„å­˜å™¨ï¼Œç”±GCCåœ¨æ‰€æœ‰çš„å¯ä»¥ä½¿ç”¨çš„å¯„å­˜å™¨ä¸­é€‰å–ä¸€ä¸ªGCCè®¤ä¸ºåˆé€‚çš„ã€‚</td>
</tr>
<tr>
<td>q</td>
<td>è¡¨ç¤ºä½¿ç”¨ä¸€ä¸ªé€šç”¨å¯„å­˜å™¨ï¼Œå’Œçº¦æŸrçš„æ„ä¹‰ç›¸åŒã€‚</td>
</tr>
<tr>
<td>a</td>
<td>è¡¨ç¤ºä½¿ç”¨%eax&#x2F;%ax&#x2F;%al</td>
</tr>
<tr>
<td>b</td>
<td>è¡¨ç¤ºä½¿ç”¨%ebx&#x2F;%bx&#x2F;%bl</td>
</tr>
<tr>
<td>c</td>
<td>è¡¨ç¤ºä½¿ç”¨%ecx&#x2F;%cx&#x2F;%cl</td>
</tr>
<tr>
<td>d</td>
<td>è¡¨ç¤ºä½¿ç”¨%edx&#x2F;%dx&#x2F;%dl</td>
</tr>
<tr>
<td>D</td>
<td>è¡¨ç¤ºä½¿ç”¨%edi&#x2F;%di</td>
</tr>
<tr>
<td>S</td>
<td>è¡¨ç¤ºä½¿ç”¨%esi&#x2F;%si</td>
</tr>
<tr>
<td>f</td>
<td>è¡¨ç¤ºä½¿ç”¨æµ®ç‚¹å¯„å­˜å™¨</td>
</tr>
<tr>
<td>t</td>
<td>è¡¨ç¤ºä½¿ç”¨ç¬¬ä¸€ä¸ªæµ®ç‚¹å¯„å­˜å™¨</td>
</tr>
<tr>
<td>u</td>
<td>è¡¨ç¤ºä½¿ç”¨ç¬¬äºŒä¸ªæµ®ç‚¹å¯„å­˜å™¨</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>åˆ†ç±»</th>
<th>é™å®šç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>é€šç”¨å¯„å­˜å™¨</td>
<td>â€œaâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥eax è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜:å‡è®¾eaxå·²ç»è¢«ä½¿ç”¨,é‚£æ€ä¹ˆåŠ?å…¶å®å¾ˆç®€å•:å› ä¸ºGCC çŸ¥é“eax å·²ç»è¢«ä½¿ç”¨,å®ƒåœ¨è¿™æ®µæ±‡ç¼–ä»£ç çš„èµ·å§‹å¤„æ’å…¥ä¸€æ¡è¯­å¥pushl %eax,å°†eax å†…å®¹ä¿å­˜åˆ°å †æ ˆ,ç„¶ ååœ¨è¿™æ®µä»£ç ç»“æŸå¤„å†å¢åŠ ä¸€æ¡è¯­å¥popl %eax,æ¢å¤eaxçš„å†…å®¹</td>
</tr>
<tr>
<td></td>
<td>â€œbâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥ebx</td>
</tr>
<tr>
<td></td>
<td>â€œcâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥ecx</td>
</tr>
<tr>
<td></td>
<td>â€œdâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥edx</td>
</tr>
<tr>
<td></td>
<td>â€œsâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥esi</td>
</tr>
<tr>
<td></td>
<td>â€œdâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥edi</td>
</tr>
<tr>
<td></td>
<td>â€œqâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥eax,ebx,ecx,edxä¸­çš„ä¸€ä¸ª</td>
</tr>
<tr>
<td></td>
<td>â€œrâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥é€šç”¨å¯„å­˜å™¨,ä¹Ÿå°±æ˜¯eax,ebx,ecx,edx,esi,ediä¸­çš„ä¸€ä¸ª</td>
</tr>
<tr>
<td></td>
<td>â€œAâ€</td>
<td>æŠŠeaxå’Œedxåˆæˆä¸€ä¸ª64 ä½çš„å¯„å­˜å™¨(use long longs)</td>
</tr>
<tr>
<td>å†…å­˜</td>
<td>â€œmâ€</td>
<td>å†…å­˜å˜é‡</td>
</tr>
<tr>
<td></td>
<td>â€œoâ€</td>
<td>æ“ä½œæ•°ä¸ºå†…å­˜å˜é‡,ä½†æ˜¯å…¶å¯»å€æ–¹å¼æ˜¯åç§»é‡ç±»å‹, ä¹Ÿå³æ˜¯åŸºå€å¯»å€,æˆ–è€…æ˜¯åŸºå€åŠ å˜å€å¯»å€</td>
</tr>
<tr>
<td></td>
<td>â€œVâ€</td>
<td>æ“ä½œæ•°ä¸ºå†…å­˜å˜é‡,ä½†å¯»å€æ–¹å¼ä¸æ˜¯åç§»é‡ç±»å‹</td>
</tr>
<tr>
<td></td>
<td>â€œ â€œ</td>
<td>æ“ä½œæ•°ä¸ºå†…å­˜å˜é‡,ä½†å¯»å€æ–¹å¼ä¸ºè‡ªåŠ¨å¢é‡</td>
</tr>
<tr>
<td></td>
<td>â€œpâ€</td>
<td>æ“ä½œæ•°æ˜¯ä¸€ä¸ªåˆæ³•çš„å†…å­˜åœ°å€(æŒ‡é’ˆ)</td>
</tr>
<tr>
<td>å¯„å­˜å™¨æˆ–å†…å­˜</td>
<td>â€œgâ€</td>
<td>å°†è¾“å…¥å˜é‡æ”¾å…¥eax,ebx,ecx,edxä¸­çš„ä¸€ä¸ª æˆ–è€…ä½œä¸ºå†…å­˜å˜é‡</td>
</tr>
<tr>
<td></td>
<td>â€œXâ€</td>
<td>æ“ä½œæ•°å¯ä»¥æ˜¯ä»»ä½•ç±»å‹</td>
</tr>
<tr>
<td>ç«‹å³æ•°</td>
<td>â€œIâ€</td>
<td>0-31ä¹‹é—´çš„ç«‹å³æ•°(ç”¨äº32ä½ç§»ä½æŒ‡ä»¤)</td>
</tr>
<tr>
<td></td>
<td>â€œJâ€</td>
<td>0-63ä¹‹é—´çš„ç«‹å³æ•°(ç”¨äº64ä½ç§»ä½æŒ‡ä»¤)</td>
</tr>
<tr>
<td></td>
<td>â€œNâ€</td>
<td>0-255ä¹‹é—´çš„ç«‹å³æ•°(ç”¨äºoutæŒ‡ä»¤)</td>
</tr>
<tr>
<td></td>
<td>â€œiâ€</td>
<td>ç«‹å³æ•°</td>
</tr>
<tr>
<td></td>
<td>â€œnâ€</td>
<td>ç«‹å³æ•°,æœ‰äº›ç³»ç»Ÿä¸æ”¯æŒé™¤å­—ä»¥å¤–çš„ç«‹å³æ•°, è¿™äº›ç³»ç»Ÿåº”è¯¥ä½¿ç”¨â€nâ€è€Œä¸æ˜¯â€iâ€</td>
</tr>
<tr>
<td>åŒ¹é…</td>
<td>â€œ 0 â€œ,â€œ1â€ â€¦â€œ9â€</td>
<td>,	è¡¨ç¤ºç”¨å®ƒé™åˆ¶çš„æ“ä½œæ•°ä¸æŸä¸ªæŒ‡å®šçš„æ“ä½œæ•°åŒ¹é…,ä¹Ÿå³è¯¥æ“ä½œæ•°å°±æ˜¯æŒ‡å®šçš„é‚£ä¸ªæ“ä½œæ•°,ä¾‹å¦‚â€0â€å»æè¿°â€%1â€æ“ä½œæ•°,é‚£ä¹ˆâ€%1â€å¼•ç”¨çš„å…¶å®å°±æ˜¯â€%0â€æ“ä½œæ•°,æ³¨æ„ä½œä¸ºé™å®šç¬¦å­—æ¯çš„0-9 ä¸ æŒ‡ä»¤ä¸­çš„â€%0â€-â€œ%9â€çš„åŒºåˆ«,å‰è€…æè¿°æ“ä½œæ•°,åè€…ä»£è¡¨æ“ä½œæ•°ã€‚</td>
</tr>
<tr>
<td></td>
<td>&amp;;</td>
<td>è¯¥è¾“å‡ºæ“ä½œæ•°ä¸èƒ½ä½¿ç”¨è¿‡å’Œè¾“å…¥æ“ä½œæ•°ç›¸åŒçš„å¯„å­˜å™¨</td>
</tr>
<tr>
<td>æ“ä½œæ•°ç±»å‹</td>
<td>â€œ&#x3D;â€</td>
<td>æ“ä½œæ•°åœ¨æŒ‡ä»¤ä¸­æ˜¯åªå†™çš„(è¾“å‡ºæ“ä½œæ•°)</td>
</tr>
<tr>
<td></td>
<td>â€œ+â€</td>
<td>æ“ä½œæ•°åœ¨æŒ‡ä»¤ä¸­æ˜¯è¯»å†™ç±»å‹çš„(è¾“å…¥è¾“å‡ºæ“ä½œæ•°)</td>
</tr>
<tr>
<td>æµ®ç‚¹æ•°</td>
<td>â€œfâ€</td>
<td>æµ®ç‚¹å¯„å­˜å™¨</td>
</tr>
<tr>
<td></td>
<td>â€œtâ€</td>
<td>ç¬¬ä¸€ä¸ªæµ®ç‚¹å¯„å­˜å™¨</td>
</tr>
<tr>
<td></td>
<td>â€œuâ€</td>
<td>ç¬¬äºŒä¸ªæµ®ç‚¹å¯„å­˜å™¨</td>
</tr>
<tr>
<td></td>
<td>â€œGâ€</td>
<td>æ ‡å‡†çš„80387æµ®ç‚¹å¸¸æ•°</td>
</tr>
<tr>
<td></td>
<td>%</td>
<td>è¯¥æ“ä½œæ•°å¯ä»¥å’Œä¸‹ä¸€ä¸ªæ“ä½œæ•°äº¤æ¢ä½ç½®.ä¾‹å¦‚addlçš„ä¸¤ä¸ªæ“ä½œæ•°å¯ä»¥äº¤æ¢é¡ºåº (å½“ç„¶ä¸¤ä¸ªæ“ä½œæ•°éƒ½ä¸èƒ½æ˜¯ç«‹å³æ•°)</td>
</tr>
<tr>
<td></td>
<td>#</td>
<td>éƒ¨åˆ†æ³¨é‡Š,ä»è¯¥å­—ç¬¦åˆ°å…¶åçš„é€—å·ä¹‹é—´æ‰€æœ‰å­—æ¯è¢«å¿½ç•¥</td>
</tr>
<tr>
<td></td>
<td>*</td>
<td>è¡¨ç¤ºå¦‚æœé€‰ç”¨å¯„å­˜å™¨,åˆ™å…¶åçš„å­—æ¯è¢«å¿½ç•¥</td>
</tr>
</tbody></table>
<h3 id="å†…å­˜çº¦æŸ"><a href="#å†…å­˜çº¦æŸ" class="headerlink" title="å†…å­˜çº¦æŸ"></a>å†…å­˜çº¦æŸ</h3><p>å¦‚æœä¸€ä¸ªInput&#x2F;Output  æ“ä½œè¡¨è¾¾å¼çš„C&#x2F;C++è¡¨è¾¾å¼è¡¨ç°ä¸ºä¸€ä¸ªå†…å­˜åœ°å€ï¼Œä¸æƒ³å€ŸåŠ©äºä»»ä½•å¯„å­˜å™¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å†…å­˜çº¦æŸã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__asm__(&quot;lidt%0&quot;:&quot;=m&quot;(__idt_addr));</span><br><span class="line">__asm__(&quot;lidt%0&quot;::&quot;m&quot;(__idt_addr));</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>ä¿®é¥°ç¬¦</th>
<th>è¾“å…¥&#x2F;è¾“å‡º</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>&#x3D;</td>
<td>O</td>
<td>è¡¨ç¤ºæ­¤Outputæ“ä½œè¡¨è¾¾å¼æ˜¯Write-Onlyçš„ã€‚</td>
</tr>
</tbody></table>
<ul>
<li><pre><code>           | O               |è¡¨ç¤ºæ­¤Outputæ“ä½œè¡¨è¾¾å¼æ˜¯Read-Writeçš„ã€‚
</code></pre>
</li>
</ul>
<p>&amp;                | O               |è¡¨ç¤ºæ­¤Outputæ“ä½œè¡¨è¾¾å¼ç‹¬å ä¸ºå…¶æŒ‡å®šçš„å¯„å­˜å™¨ã€‚<br>%               | I                 |è¡¨ç¤ºæ­¤Input  æ“ä½œè¡¨è¾¾å¼ä¸­çš„C&#x2F;C++è¡¨è¾¾å¼å¯ä»¥å’Œä¸‹ä¸€ ä¸ªInputæ“ä½œè¡¨è¾¾å¼ä¸­çš„C&#x2F;C++è¡¨è¾¾å¼äº’æ¢</p>
<h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Static __inline__ void __set_bit(int nr, volatile void * addr)</span><br><span class="line">&#123;</span><br><span class="line">         __asm__(</span><br><span class="line">                         &quot;btsl %1,%0&quot;</span><br><span class="line">                         :&quot;=m&quot; (ADDR)</span><br><span class="line">                         :&quot;Ir&quot; (nr));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªå ä½ç¬¦%0ä¸C è¯­è¨€å˜é‡ADDRå¯¹åº”,ç¬¬äºŒä¸ªå ä½ç¬¦%1ä¸Cè¯­è¨€å˜é‡nrå¯¹åº”ã€‚å› æ­¤ä¸Šé¢çš„æ±‡ç¼–è¯­å¥ä»£ç ä¸ä¸‹é¢çš„ä¼ªä»£ç ç­‰ä»·:btsl nr, ADDR</p>
<h2 id="Clobber-ModifyåŸŸå­˜åœ¨â€memoryâ€çš„å…¶ä»–å½±å“"><a href="#Clobber-ModifyåŸŸå­˜åœ¨â€memoryâ€çš„å…¶ä»–å½±å“" class="headerlink" title="Clobber&#x2F;ModifyåŸŸå­˜åœ¨â€memoryâ€çš„å…¶ä»–å½±å“"></a>Clobber&#x2F;ModifyåŸŸå­˜åœ¨â€memoryâ€çš„å…¶ä»–å½±å“</h2><p>ä½¿ç”¨â€memoryâ€æ˜¯å‘GCCå£°æ˜å†…å­˜å‘ç”Ÿäº†å˜åŒ–ï¼Œè€Œå†…å­˜å‘ç”Ÿå˜åŒ–å¸¦æ¥çš„å½±å“å¹¶ä¸æ­¢è¿™ä¸€ç‚¹ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int main(int __argc, char* __argv[]) </span><br><span class="line">&#123; </span><br><span class="line">    int* __p = (int*)__argc; </span><br><span class="line">    (*__p) = 9999; </span><br><span class="line">    __asm__(&quot;&quot;:::&quot;memory&quot;); </span><br><span class="line">    if((*__p) == 9999) </span><br><span class="line">        return 5; </span><br><span class="line">    return (*__p); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ¬ä¾‹ä¸­ï¼Œå¦‚æœæ²¡æœ‰é‚£æ¡å†…è”æ±‡ç¼–è¯­å¥ï¼Œé‚£ä¸ªifè¯­å¥çš„åˆ¤æ–­æ¡ä»¶å°±å®Œå…¨æ˜¯ä¸€å¥åºŸè¯ã€‚GCCåœ¨ä¼˜åŒ–æ—¶ä¼šæ„è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œè€Œç›´æ¥åªç”Ÿæˆreturn 5çš„æ±‡ç¼–ä»£ç ï¼Œè€Œä¸ä¼šå†ç”Ÿæˆifè¯­å¥çš„ç›¸å…³ä»£ç ï¼Œè€Œä¸ä¼šç”Ÿæˆreturn (*__p)çš„ç›¸å…³ä»£ç ã€‚</p>
<p>ä½†ä½ åŠ ä¸Šäº†è¿™æ¡å†…è”æ±‡ç¼–è¯­å¥ï¼Œå®ƒé™¤äº†å£°æ˜å†…å­˜å˜åŒ–ä¹‹å¤–ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰åšã€‚</p>
<p>ä½†GCCæ­¤æ—¶å°±ä¸èƒ½ç®€å•çš„è®¤ä¸ºå®ƒä¸éœ€è¦åˆ¤æ–­éƒ½çŸ¥é“ (*__p)ä¸€å®šä¸9999ç›¸ç­‰ï¼Œå®ƒåªæœ‰è€è€å®å®ç”Ÿæˆè¿™æ¡ifè¯­å¥çš„æ±‡ç¼–ä»£ç ï¼Œä¸€èµ·ç›¸å…³çš„ä¸¤ä¸ªreturnè¯­å¥ç›¸å…³ä»£ç ã€‚</p>
<p>å¦å¤–åœ¨linuxå†…æ ¸ä¸­å†…å­˜å±éšœä¹Ÿæ˜¯åŸºäºå®ƒå®ç°çš„include&#x2F;asm&#x2F;system.hä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># define barrier() _asm__volatile_(&quot;&quot;: : :&quot;memory&quot;)</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦æ˜¯ä¿è¯ç¨‹åºçš„æ‰§è¡Œéµå¾ªé¡ºåºä¸€è‡´æ€§ã€‚å‘µå‘µï¼Œæœ‰çš„æ—¶å€™ä½ å†™ä»£ç çš„é¡ºåºï¼Œä¸ä¸€å®šæ˜¯ç»ˆæ‰§è¡Œçš„é¡ºåºï¼Œè¿™ä¸ªæ˜¯å¤„ç†å™¨æœ‰å…³çš„ã€‚</p>
<h2 id="Linux-æºç ä¾‹å­"><a href="#Linux-æºç ä¾‹å­" class="headerlink" title="Linux æºç ä¾‹å­"></a>Linux æºç ä¾‹å­</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">static inline char * strcpy(char * dest, const char *src)</span><br><span class="line">&#123;</span><br><span class="line">	char *xdest = dest;</span><br><span class="line">	__asm__ __volatile__</span><br><span class="line">	(&quot;1: \tmoeb %1@+, %0@+\n\t&quot;   &quot;jne 1b&quot;  //è¿™ä¸ªå†’å·ä¸æ˜¯åˆ†éš”ç¬¦</span><br><span class="line">	: &quot;=a&quot; (dest) , &quot;=a&quot; (stc)</span><br><span class="line">	: &quot;0&quot;(dest), &quot;1&quot; (src)</span><br><span class="line">	 : &quot;memory&quot;);</span><br><span class="line">	return xdest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "><a href="#éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ " class="headerlink" title="éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ "></a>éœ€è¦è¿›ä¸€æ­¥çš„ç ”ç©¶å­¦ä¹ </h2><p>æš‚æ— </p>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æš‚æ— </p>
<h2 id="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½"><a href="#å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½" class="headerlink" title="å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~"></a>å¼€é¢˜ç¼˜ç”±ã€æ€»ç»“ã€åæ€ã€åæ§½~~</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yi412/article/details/80846083">https://blog.csdn.net/yi412/article/details/80846083</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/elnino/p/4313340.html">https://www.cnblogs.com/elnino/p/4313340.html</a></p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="Shaojie Tan"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Shaojie Tan</p><p class="is-size-6 is-block">ğ˜Šğ˜°ğ˜®ğ˜±ğ˜¶ğ˜µğ˜¦ğ˜³ ğ˜ˆğ˜³ğ˜¤ğ˜©ğ˜ªğ˜µğ˜¦ğ˜¤ğ˜µğ˜¶ğ˜³ğ˜¦ &amp; ğ˜ğ˜—ğ˜Š</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Anhui, Hefei, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">412</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">34</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">504</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Kirrito-k423" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Kirrito-k423"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithms/"><span class="level-start"><span class="level-item">Algorithms</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/Architecture/"><span class="level-start"><span class="level-item">Architecture</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile" href="/categories/Artificial-Intelligence/"><span class="level-start"><span class="level-item">Artificial Intelligence</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Camp/"><span class="level-start"><span class="level-item">Camp</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Databases/"><span class="level-start"><span class="level-item">Databases</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/HPC/"><span class="level-start"><span class="level-item">HPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math/"><span class="level-start"><span class="level-item">Math</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile" href="/categories/Operating-system/"><span class="level-start"><span class="level-item">Operating system</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Overview/"><span class="level-start"><span class="level-item">Overview</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">25</span></span></a></li><li><a class="level is-mobile" href="/categories/Software/"><span class="level-start"><span class="level-item">Software</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Thinking/"><span class="level-start"><span class="level-item">Thinking</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Tips/"><span class="level-start"><span class="level-item">Tips</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Treasure/"><span class="level-start"><span class="level-item">Treasure</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tutorials/"><span class="level-start"><span class="level-item">Tutorials</span></span><span class="level-end"><span class="level-item tag">116</span></span></a></li><li><a class="level is-mobile" href="/categories/Values/"><span class="level-start"><span class="level-item">Values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/architecture/"><span class="level-start"><span class="level-item">architecture</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/diary/"><span class="level-start"><span class="level-item">diary</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/english/"><span class="level-start"><span class="level-item">english</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/hardware/"><span class="level-start"><span class="level-item">hardware</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/love/"><span class="level-start"><span class="level-item">love</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/math/"><span class="level-start"><span class="level-item">math</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/network/"><span class="level-start"><span class="level-item">network</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/operating-system/"><span class="level-start"><span class="level-item">operating system</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/programming/"><span class="level-start"><span class="level-item">programming</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/security/"><span class="level-start"><span class="level-item">security</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/software/"><span class="level-start"><span class="level-item">software</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/thinking/"><span class="level-start"><span class="level-item">thinking</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/thinking/OOW/"><span class="level-start"><span class="level-item">OOW</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/tips/"><span class="level-start"><span class="level-item">tips</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/toLearn/"><span class="level-start"><span class="level-item">toLearn</span></span><span class="level-end"><span class="level-item tag">52</span></span></a></li><li><a class="level is-mobile" href="/categories/values/"><span class="level-start"><span class="level-item">values</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://ibug.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ibugs</span></span><span class="level-right"><span class="level-item tag">ibug.io</span></span></a></li><li><a class="level is-mobile" href="https://jia.je/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">jiegec</span></span><span class="level-right"><span class="level-item tag">jia.je</span></span></a></li><li><a class="level is-mobile" href="https://leimao.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">leimao</span></span><span class="level-right"><span class="level-item tag">leimao.github.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-22T03:19:25.000Z">2024-08-22</time></p><p class="title"><a href="/2024/08/22/Work/Programming/4-compile/CompileError/">GCC Compile Error</a></p><p class="categories"><a href="/categories/programming/">programming</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-20T08:20:22.000Z">2024-08-20</time></p><p class="title"><a href="/2024/08/20/Work/software/linux/ascend_torch_npu/">Ascend Extension for PyTorch Installation</a></p><p class="categories"><a href="/categories/software/">software</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-20T01:52:24.000Z">2024-08-20</time></p><p class="title"><a href="/2024/08/20/Work/security/huaweiWorkTips/">Working Tips</a></p><p class="categories"><a href="/categories/security/">security</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-07-22T02:04:33.000Z">2024-07-22</time></p><p class="title"><a href="/2024/07/22/Work/software/windows/windowsBugs/">Windows Common Bugs and How to Fix Them</a></p><p class="categories"><a href="/categories/software/">software</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-07-16T08:28:15.000Z">2024-07-16</time></p><p class="title"><a href="/2024/07/16/Work/software/manager/PVE/">Proxmox VEï¼ˆPVEï¼‰on J4125</a></p><p class="categories"><a href="/categories/software/">software</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">July 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">June 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">May 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">April 2024</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">March 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">January 2024</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">December 2023</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">November 2023</span></span><span class="level-end"><span class="level-item tag">33</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">October 2023</span></span><span class="level-end"><span class="level-item tag">56</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">September 2023</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/08/"><span class="level-start"><span class="level-item">August 2023</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">July 2023</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">June 2023</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">April 2023</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">March 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">January 2023</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">December 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">September 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/5G/"><span class="tag">5G</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/64bits-vs-32bits/"><span class="tag">64bits vs 32bits</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMAT/"><span class="tag">AMAT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AMD/"><span class="tag">AMD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ASPLOS/"><span class="tag">ASPLOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ATI/"><span class="tag">ATI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AVX/"><span class="tag">AVX</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Alpha/"><span class="tag">Alpha</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Analysis/"><span class="tag">Analysis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apt/"><span class="tag">Apt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Assembly/"><span class="tag">Assembly</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BFS/"><span class="tag">BFS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BHive/"><span class="tag">BHive</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BT/"><span class="tag">BT</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BTL/"><span class="tag">BTL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Baka-Mitai/"><span class="tag">Baka Mitai</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bash/"><span class="tag">Bash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Big-Endian/"><span class="tag">Big-Endian</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="SHAOJIE&#039;S BOOK" height="28"></a><p class="is-size-7"><span>&copy; 2024 Shaojie Tan</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Kirrito-k423/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>